{"version":3,"file":"current-article.611ea08f.js","sources":["../../src/pages/article/current-article.ts"],"sourcesContent":["import { SingleContextUpKey, SingleContextUpRef } from '@proc7ts/context-values/updatable';\nimport { EventSupplier, mapOn_, OnEvent, onSupplied, trackValue, ValueTracker } from '@proc7ts/fun-events';\nimport { Supply } from '@proc7ts/primitives';\nimport { Article } from '../../core/articles';\n\nexport interface UpdatableArticle extends Article {\n  update(article: Article): void;\n}\n\nexport interface NoArticle {\n  readonly slug?: undefined;\n}\n\nexport type CurrentArticle =\n    | UpdatableArticle\n    | NoArticle;\n\nexport const noArticle: NoArticle = {};\nexport const CurrentArticle: SingleContextUpRef<CurrentArticle> = (\n    /*#__PURE__*/ new SingleContextUpKey<CurrentArticle>(\n        'current-article',\n        {\n          byDefault: () => noArticle,\n        },\n    )\n);\n\nexport class CurrentArticleTracker extends ValueTracker<CurrentArticle> {\n\n  private readonly _it = trackValue<CurrentArticle>(noArticle);\n\n  get supply(): Supply {\n    return this._it.supply;\n  }\n\n  get it(): CurrentArticle {\n    return this._it.it;\n  }\n\n  set it(value: CurrentArticle) {\n    this._it.it = value;\n  }\n\n  get on(): OnEvent<[CurrentArticle, CurrentArticle]> {\n    return this._it.on;\n  }\n\n  set(article: Article | NoArticle): void {\n    this.it = this.cast(article);\n  }\n\n  byArticles(source: EventSupplier<[Article | NoArticle]>): this {\n    return this.by(\n        onSupplied(source).do(\n            mapOn_(article => this.cast(article)),\n        ),\n    );\n  }\n\n  cast(article: Article | NoArticle): CurrentArticle {\n    return article.slug\n        ? {\n          ...article,\n          update: updated => this.set(updated),\n        }\n        : noArticle;\n  }\n\n}\n"],"names":["noArticle","CurrentArticle","SingleContextUpKey","byDefault","CurrentArticleTracker","ValueTracker","[object Object]","this","trackValue","supply","_it","it","value","on","article","cast","source","by","onSupplied","do","mapOn_","slug","update","updated","set"],"mappings":"yIAiBaA,EAAuB,GACvBC,MACSC,EACd,kBACA,CACEC,UAAW,IAAMH,UAKdI,UAA8BC,EAA3CC,kCAEmBC,SAAMC,EAA2BR,GAElDS,aACE,OAAOF,KAAKG,IAAID,OAGlBE,SACE,OAAOJ,KAAKG,IAAIC,GAGlBA,OAAOC,GACLL,KAAKG,IAAIC,GAAKC,EAGhBC,SACE,OAAON,KAAKG,IAAIG,GAGlBP,IAAIQ,GACFP,KAAKI,GAAKJ,KAAKQ,KAAKD,GAGtBR,WAAWU,GACT,OAAOT,KAAKU,GACRC,EAAWF,GAAQG,GACfC,GAAON,GAAWP,KAAKQ,KAAKD,OAKtCR,KAAKQ,GACH,OAAOA,EAAQO,KACT,IACGP,EACHQ,OAAQC,GAAWhB,KAAKiB,IAAID,IAE5BvB"}