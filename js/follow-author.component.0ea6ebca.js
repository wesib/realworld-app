import{d as e}from"./lib/context-values.956fc686.js";import{s,d as t}from"./lib/fun-events.a21352be.js";import{p as o,R as r,C as n}from"./wesib/wesib.b48306cb.js";import{_ as a}from"./helpers.920c7f83.js";import{b as i}from"./wesib/generic.e7ebea81.js";import{C as u}from"./core.f6946162.js";import{U as c,a as l}from"./core/users.45afb884.js";import{e as f}from"./core/util.4298e8ae.js";const h={},m=new e("current-user-profile",{byDefault:()=>h});function p(e){const o=s(t(e).keep.thru_(e=>{if(null==e.username)return e;const s=e=>{o.it=Object.assign(Object.assign({},e),{update:s})};return Object.assign(Object.assign({},e),{update:s})}));return o}let b=class{constructor(e){this._context=e,this.author=h;const s=e.get(i),t=e.get(c);e.whenOn(e=>{s.get(m).tillOff(e)(e=>{this.author=e})}),e.on("click")(()=>{const{author:e}=this;if(e.username){const s=!e.following;e.update(Object.assign(Object.assign({},e),{following:s})),t.followUser(e.username,s)(s=>{this.author.username&&(s.ok?this.author.update(s.body):(this.author.update(e),console.error(`Failed to follow user ${e.username}`,s.errors)))})}})}render(){const{contentRoot:e}=this._context;return()=>{this.author.username?(e.className=this.author.following?"btn-secondary":"btn-outline-secondary",e.innerHTML=`<i class="ion-plus-round"></i> Follow ${f(this.author.username)}`):e.innerHTML=""}}};a([o()],b.prototype,"author",void 0),a([r()],b.prototype,"render",null),b=a([n(["follow-author",u],{feature:{needs:l}})],b);export{m as C,b as F,p as c,h as n};//# sourceMappingURL=follow-author.component.0ea6ebca.js.map
