import{S as e}from"./proc7ts/context-values.fcd8ebea.js";import{c as t,f as o}from"./proc7ts/fun-events.8bfc632f.js";import{S as r,R as s,C as n}from"./wesib/wesib.4a501e1a.js";import{_ as a}from"./helpers.e1623395.js";import{a as u}from"./wesib/generic.d0f646b2.js";import{C as i}from"./core.714cbb7b.js";import{U as c,a as l}from"./core/users.c29610c7.js";import{e as f}from"./core/util.32ae6bb0.js";const m={},h=new e("current-user-profile",{byDefault:()=>m});function p(e){const r=t(o(e).keepThru_(e=>{if(null==e.username)return e;const t=e=>{r.it={...e,update:t}};return{...e,update:t}}));return r}let b=(()=>{let e=class{constructor(e){this._context=e,this.author=m;const t=e.get(u),o=e.get(c);t.get(h).to(e=>{this.author=e}),e.on("click").to(()=>{const{author:e}=this;if(e.username){const t=!e.following;e.update({...e,following:t}),o.followUser(e.username,t).to(t=>{this.author.username&&(t.ok?this.author.update(t.body):(this.author.update(e),console.error("Failed to follow user "+e.username,t.errors)))})}})}render(){const{contentRoot:e,element:t}=this._context;return()=>{this.author.username?(t.className=this.author.following?"btn-secondary":"btn-outline-secondary",e.innerHTML='<i class="ion-plus-round"></i> Follow '+f(this.author.username)):e.innerHTML=""}}};return a([r()],e.prototype,"author",void 0),a([s()],e.prototype,"render",null),e=a([n(["follow-author-btn",i],{feature:{needs:l}})],e),e})();export{h as C,b as F,p as c,m as n};//# sourceMappingURL=follow-author-btn.component.2784935f.js.map
