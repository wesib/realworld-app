import{S as t}from"./proc7ts/context-values.ec10addc.js";import{c as s,f as e}from"./proc7ts/fun-events.6f8cd792.js";import{S as o,R as r,C as a}from"./wesib/wesib.b26c9eb2.js";import{_ as n}from"./helpers.920c7f83.js";import{a as i}from"./wesib/generic.69ca2bbe.js";import{C as c}from"./core.c852ba8c.js";import{U as u,a as l}from"./core/users.8c504bb2.js";import{e as f}from"./core/util.8de4f331.js";const h={},m=new t("current-user-profile",{byDefault:()=>h});function p(t){const o=s(e(t).keepThru_(t=>{if(null==t.username)return t;const s=t=>{o.it=Object.assign(Object.assign({},t),{update:s})};return Object.assign(Object.assign({},t),{update:s})}));return o}let b=class{constructor(t){this._context=t,this.author=h;const s=t.get(i),e=t.get(u);s.get(m).to(t=>{this.author=t}),t.on("click").to(()=>{const{author:t}=this;if(t.username){const s=!t.following;t.update(Object.assign(Object.assign({},t),{following:s})),e.followUser(t.username,s).to(s=>{this.author.username&&(s.ok?this.author.update(s.body):(this.author.update(t),console.error(`Failed to follow user ${t.username}`,s.errors)))})}})}render(){const{contentRoot:t}=this._context;return()=>{this.author.username?(t.className=this.author.following?"btn-secondary":"btn-outline-secondary",t.innerHTML=`<i class="ion-plus-round"></i> Follow ${f(this.author.username)}`):t.innerHTML=""}}};n([o()],b.prototype,"author",void 0),n([r()],b.prototype,"render",null),b=n([a(["follow-author-btn",c],{feature:{needs:l}})],b);export{m as C,b as F,p as c,h as n};//# sourceMappingURL=follow-author-btn.component.d1ccc02d.js.map
