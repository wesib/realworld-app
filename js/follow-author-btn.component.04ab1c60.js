import{_ as o}from"./helpers.e1623395.js";import{e}from"./frontmeans/httongue.6b868a5b.js";import{h as t}from"./wesib/generic.e05bd5a6.js";import{S as r,R as s,C as n}from"./wesib/wesib.289eabae.js";import{C as a}from"./core.10059585.js";import{U as u,a as i}from"./core/users.220a355a.js";import{S as c}from"./proc7ts/context-values.cc32b8c5.js";import{e as l,m}from"./proc7ts/fun-events.8f536596.js";const h={},f=new c("current-user-profile",{byDefault:()=>h});function p(o){const e=l(o.do(m((o=>{if(null==o.username)return o;const t=o=>{e.it={...o,update:t}};return{...o,update:t}}))));return e}let d=class{constructor(o){this._context=o,this.author=h;const e=o.get(t),r=o.get(u);e.get(f)((o=>{this.author=o})),o.on("click")((()=>{const{author:o}=this;if(o.username){const e=!o.following;o.update({...o,following:e}),r.followUser(o.username,e)((e=>{this.author.username&&(e.ok?this.author.update(e.body):(this.author.update(o),console.error(`Failed to follow user ${o.username}`,e.errors)))}))}}))}render(){const{contentRoot:o,element:t}=this._context;return()=>{this.author.username?(t.className=this.author.following?"btn-secondary":"btn-outline-secondary",o.innerHTML=`<i class="ion-plus-round"></i> Follow ${e(this.author.username)}`):o.innerHTML=""}}};o([r()],d.prototype,"author",void 0),o([s()],d.prototype,"render",null),d=o([n(["follow-author-btn",a],{feature:{needs:i}})],d);export{f as C,d as F,p as c,h as n};//# sourceMappingURL=follow-author-btn.component.04ab1c60.js.map
