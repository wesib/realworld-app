import{S as t}from"./proc7ts/context-values.de0fa082.js";import{c as o,f as e}from"./proc7ts/fun-events.751f4123.js";import{S as r,R as s,C as n}from"./wesib/wesib.7b25387e.js";import{_ as a}from"./helpers.e1623395.js";import{a as u}from"./wesib/generic.69a57111.js";import{C as i}from"./core.21bb0d86.js";import{e as c}from"./hatsy/hten.dd7fdc57.js";import{U as l,a as h}from"./core/users.e5c9174d.js";const f={},m=new t("current-user-profile",{byDefault:()=>f});function p(t){const r=o(e(t).keepThru_((t=>{if(null==t.username)return t;const o=t=>{r.it={...t,update:o}};return{...t,update:o}})));return r}let d=class{constructor(t){this._context=t,this.author=f;const o=t.get(u),e=t.get(l);o.get(m).to((t=>{this.author=t})),t.on("click").to((()=>{const{author:t}=this;if(t.username){const o=!t.following;t.update({...t,following:o}),e.followUser(t.username,o).to((o=>{this.author.username&&(o.ok?this.author.update(o.body):(this.author.update(t),console.error(`Failed to follow user ${t.username}`,o.errors)))}))}}))}render(){const{contentRoot:t,element:o}=this._context;return()=>{this.author.username?(o.className=this.author.following?"btn-secondary":"btn-outline-secondary",t.innerHTML=`<i class="ion-plus-round"></i> Follow ${c(this.author.username)}`):t.innerHTML=""}}};a([r()],d.prototype,"author",void 0),a([s()],d.prototype,"render",null),d=a([n(["follow-author-btn",i],{feature:{needs:h}})],d);export{m as C,d as F,p as c,f as n};//# sourceMappingURL=follow-author-btn.component.8cdec1ab.js.map
