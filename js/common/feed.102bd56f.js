import{g as t,a as e,d as s,e as a}from"../lib/call-thru.00f7427a.js";import{e as r,t as o}from"../lib/a-iterable.5fab0d69.js";import{S as i}from"../lib/context-values.d686e0c8.js";import{o as n,s as c,d as f}from"../lib/fun-events.a21352be.js";import{F as p}from"../wesib/wesib.84ff8eb8.js";import{_ as h}from"../helpers.920c7f83.js";import{A as l}from"./api.c33a392f.js";const d=["feed","tag","author","favorited","limit","offset"];function u(t,e){return d.every(s=>t[s]===e[s])}function m(e){const s=new URLSearchParams;return r(o(d,e=>"feed"!==e?e:t,s=>{const a=e[s];return a?[s,String(a)]:t}),([t,e])=>s.set(t,e)),s}const b=new i("feed-service"),g={"/personal-feed":{path:"articles/feed",auth:!0},"/global-feed":{path:"articles"}};class j{constructor(t){this._apiFetch=t.get(l)}articles(t){const{path:s,auth:a}=g[t.feed||"/global-feed"],r={path:`${s}?${m(t)}`,init:{method:"GET",headers:{Accept:"application/json"}},auth:a,respondAs:e};return this._apiFetch(r)}tags(){if(this._tags)return this._tags;let e;return this._tags=n(r=>{if(!e){const r={path:"tags",init:{method:"GET",headers:{Accept:"application/json"}},respondAs:"tags",auth:!1},o=this._apiFetch(r).thru_(e=>e.ok?s(e.body):!1===e.ok?(console.log("Failed to load tags",e.errors),s([])):t),i=c(f(o,()=>[]));e=i.read.thru_(e=>e?a(...e):t)}e(r)})}}let _=class{};_=h([p({setup(t){t.provide({a:b,as:j})}})],_);export{b as F,u as a,_ as b,m as f};//# sourceMappingURL=feed.102bd56f.js.map
