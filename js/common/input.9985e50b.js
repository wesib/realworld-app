import{e}from"../lib/call-thru.00f7427a.js";import{A as t,j as s}from"../lib/a-iterable.5fab0d69.js";import{F as r}from"../lib/context-values.d686e0c8.js";import{e as a,n as o,d as n}from"../lib/fun-events.a21352be.js";import{b as c,B as i,o as p,R as l,C as m,q as u,t as d,F as f}from"../wesib/wesib.84ff8eb8.js";import{_ as h}from"../helpers.920c7f83.js";import{b,c as g,C as j,d as k,e as v,D as w,F as _,U as x}from"../wesib/generic.643f46dc.js";import{e as C,f as y,g as F,h as O,j as E,k as A,l as D,m as R,n as U,o as $,p as q,a as B}from"../lib/input-aspects.963c1cb4.js";import{C as L}from"../common.74dd5bad.js";const M=new r("api-error-generator",{byDefault:c(e=>{const r=e.get(i).document;return e=>{let a;return t.from(s(e)).forEach(([e,t])=>{a||(a=r.createElement("ul"),a.classList.add("error-messages"));const s=a;t.forEach(t=>{const a=r.createElement("li");a.innerText=`${e} ${t}`,s.appendChild(a)})}),a}})});function T({mark:t="is-invalid",when:s}={}){return r=>{const n=r.aspect(C);return a({status:r.aspect(y),validity:r.aspect(F)}).keep.thru(({status:[{touched:r,hasFocus:a}],validity:[c]})=>{const i=c.has("incomplete")||c.has("missing");return!r||a&&i?e():o(n.specs(O({mark:t,when:s})))})}}const z={};let G=class{constructor(t){this._context=t,this.errors=z,t.get(b).get(g).thru_(({control:t})=>t?o(t.aspect(F).read.keep.thru_(e=>e.messages("api").reduce((e,t)=>Object.assign(Object.assign({},e),t.api),z))):e(z))(e=>this.errors=e)}render(){const{contentRoot:e}=this._context;let t;return()=>{t&&(t.remove(),t=void 0),t=this._context.get(M)(this.errors),t&&e.append(t)}}};h([p()],G.prototype,"errors",void 0),h([l()],G.prototype,"render",null),G=h([m(["api-errors",L])],G);let H=class{};H=h([m(["in-error",L],u("code"),j(({control:{control:e},aspects:t,context:s})=>d(s,"code").read.keep.thru_(e=>e?e.trim().split(/\s+/):[]).keep.thru(r=>e.convert(E.to(s.element),t).setup(C,e=>{e.add(A()),e.add(T({when:r}))}))))],H);let I=class{};function J({emptyModel:e={},form:t={makeForm({node:t,aspects:s}){const r=R(e).setup(C,e=>e.add(A())).setup(U,e=>e.derive($())),a=q(t.element,{form:r,aspects:s}).setup(C,e=>e.add(r.aspect(C)));return[r,a]}},button:s}={}){return m(_(t),function({select:e="button",pick:t={deep:!0,all:!0}}={}){return m({feature:{needs:k},define(s){s.whenComponent(s=>{const r=s.get(v),o=s.get(b);s.whenOn(n=>{a({form:o.get(g),button:r.select(e,t).first,aspects:s.get(w)}).tillOff(n).consume(({form:[{control:e}],button:[t],aspects:[s]})=>e&&t&&D(t.element,{form:e,aspects:s}))})})}})}(s))}function K(t){return x(Object.assign(Object.assign({},t),{makeControl:s=>s.context.get(b).get(g).keep.thru_(({form:r})=>{const a=t.makeControl(s);return a?a instanceof B?c(a):o(n(a).keep.thru_((t,s)=>t?(c(t),s?e(t,s):e(t)):e())):e();function c(e){r&&e.aspect(U).derive(r.aspect(U));const t=e.aspect(C);return t.add(A()),t.add(T()),e}})}))}I=h([f({needs:[G,H]})],I);export{M as A,I as C,J as F,K as U};//# sourceMappingURL=input.9985e50b.js.map
