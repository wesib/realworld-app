{"version":3,"file":"current-article.10cd4166.js","sources":["../../src/pages/article/current-article.ts"],"sourcesContent":["import { SingleContextUpKey, SingleContextUpRef } from 'context-values/updatable';\nimport {\n  EventSupplier,\n  EventSupply,\n  EventSupply__symbol,\n  eventSupplyOf,\n  OnEvent, onSupplied,\n  trackValue,\n  ValueTracker,\n} from 'fun-events';\nimport { Article } from '../../core/articles';\n\nexport interface UpdatableArticle extends Article {\n  update(article: Article): void;\n}\n\nexport interface NoArticle {\n  readonly slug?: undefined;\n}\n\nexport type CurrentArticle =\n    | UpdatableArticle\n    | NoArticle;\n\nexport const noArticle: NoArticle = {};\nexport const CurrentArticle: SingleContextUpRef<CurrentArticle> = (\n    /*#__PURE__*/ new SingleContextUpKey<CurrentArticle>(\n        'current-article',\n        {\n          byDefault: () => noArticle,\n        },\n    )\n);\n\nexport class CurrentArticleTracker extends ValueTracker<CurrentArticle> {\n\n  private readonly _it = trackValue<CurrentArticle>(noArticle);\n\n  get on(): OnEvent<[CurrentArticle, CurrentArticle]> {\n    return this._it.on;\n  }\n\n  get [EventSupply__symbol](): EventSupply {\n    return eventSupplyOf(this._it);\n  }\n\n  get it(): CurrentArticle {\n    return this._it.it;\n  }\n\n  set it(value: CurrentArticle) {\n    this._it.it = value;\n  }\n\n  set(article: Article | NoArticle): void {\n    this.it = this.cast(article);\n  }\n\n  byArticles(source: EventSupplier<[Article | NoArticle]>): this {\n    return this.by(onSupplied(source).thru_(article => this.cast(article)));\n  }\n\n  cast(article: Article | NoArticle): CurrentArticle {\n    return article.slug\n        ? {\n          ...article,\n          update: updated => this.set(updated),\n        }\n        : noArticle;\n  }\n\n}\n"],"names":["noArticle","CurrentArticle","SingleContextUpKey","byDefault","CurrentArticleTracker","ValueTracker","[object Object]","this","trackValue","on","_it","EventSupply__symbol","eventSupplyOf","it","value","article","cast","source","by","onSupplied","thru_","slug","update","updated","set"],"mappings":"wIAwBaA,EAAuB,GACvBC,MACSC,EACd,kBACA,CACEC,UAAW,IAAMH,UAKdI,UAA8BC,EAA3CC,kCAEmBC,SAAMC,EAA2BR,GAElDS,SACE,OAAOF,KAAKG,IAAID,GAGlBE,IAAKA,KACH,OAAOC,EAAcL,KAAKG,KAG5BG,SACE,OAAON,KAAKG,IAAIG,GAGlBA,OAAOC,GACLP,KAAKG,IAAIG,GAAKC,EAGhBR,IAAIS,GACFR,KAAKM,GAAKN,KAAKS,KAAKD,GAGtBT,WAAWW,GACT,OAAOV,KAAKW,GAAGC,EAAWF,GAAQG,MAAML,GAAWR,KAAKS,KAAKD,KAG/DT,KAAKS,GACH,OAAOA,EAAQM,oCAENN,IACHO,OAAQC,GAAWhB,KAAKiB,IAAID,KAE5BvB"}