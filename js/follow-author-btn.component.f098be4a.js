import{S as e}from"./lib/context-values.10677615.js";import{c as t,f as s}from"./lib/fun-events.f47c7338.js";import{S as o,R as r,C as n}from"./wesib/wesib.4cfe016a.js";import{_ as a}from"./helpers.920c7f83.js";import{a as i}from"./wesib/generic.b8309e8a.js";import{C as u}from"./core.f6946162.js";import{U as c,a as l}from"./core/users.e19bf353.js";import{e as f}from"./core/util.4298e8ae.js";const h={},m=new e("current-user-profile",{byDefault:()=>h});function p(e){const o=t(s(e).keepThru_(e=>{if(null==e.username)return e;const t=e=>{o.it=Object.assign(Object.assign({},e),{update:t})};return Object.assign(Object.assign({},e),{update:t})}));return o}let b=class{constructor(e){this._context=e,this.author=h;const t=e.get(i),s=e.get(c);e.whenOn(e=>{t.get(m).tillOff(e).to(e=>{this.author=e})}),e.on("click").to(()=>{const{author:e}=this;if(e.username){const t=!e.following;e.update(Object.assign(Object.assign({},e),{following:t})),s.followUser(e.username,t).to(t=>{this.author.username&&(t.ok?this.author.update(t.body):(this.author.update(e),console.error(`Failed to follow user ${e.username}`,t.errors)))})}})}render(){const{contentRoot:e}=this._context;return()=>{this.author.username?(e.className=this.author.following?"btn-secondary":"btn-outline-secondary",e.innerHTML=`<i class="ion-plus-round"></i> Follow ${f(this.author.username)}`):e.innerHTML=""}}};a([o()],b.prototype,"author",void 0),a([r()],b.prototype,"render",null),b=a([n(["follow-author-btn",u],{feature:{needs:l}})],b);export{m as C,b as F,p as c,h as n};//# sourceMappingURL=follow-author-btn.component.f098be4a.js.map
