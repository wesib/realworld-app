{"version":3,"file":"call-thru.104a1934.js","sources":["../../../../../proc7ts/call-thru/src/next-call.ts","../../../../../proc7ts/call-thru/src/passes/arg.ts","../../../../../proc7ts/call-thru/src/passes/args.ts","../../../../../proc7ts/call-thru/src/passes/each.ts","../../../../../proc7ts/call-thru/src/passes/skip.ts"],"sourcesContent":["/**\n * @packageDocumentation\n * @module @proc7ts/call-thru\n */\nimport { CallChain } from './call-chain';\n\n/**\n * A key of a {@link NextCall} method responsible for calling the next pass in chain.\n */\nexport const NextCall__symbol = (/*#__PURE__*/ Symbol('next-call'));\n\n/**\n * A call of the next pass in chain.\n *\n * This is basically a function with additional method, which is treated specially by call chaining functions.\n * When previous pass in chain returns a {@link NextCall} instance, it will be used to call the next pass in chain.\n * Otherwise the next pass will be called with value returned as its {@link CallChain.pass single argument}.\n *\n * A {@link NextCall} is a function returning itself. So it can be chained like any other pass.\n *\n * A {@link nextCall} function can be used to construct a next call.\n *\n * @typeParam TChain  A type of supported call chain.\n * @typeParam TNextArgs  A type of arguments tuple of the next pass.\n * @typeParam TNextArg  A type of single argument or arguments tuple of the next pass.\n * The same as `TNextArgs` by default.\n */\nexport interface NextCall<TChain extends CallChain, TNextArgs extends any[], TNextArg = TNextArgs> {\n\n  readonly $?: TNextArg; // Silence the TypeScript compiler, as `NextArg` is never read.\n\n  /**\n   * Calls the given pass of the call chain.\n   *\n   * @param chain  Target call chain.\n   * @param pass  A pass in call chain to call.\n   */\n  [NextCall__symbol](\n      chain: TChain,\n      pass: (this: void, ...args: TNextArgs) => void,\n  ): void;\n\n  /**\n   * Returns itself.\n   *\n   * Makes this call a valid no-arg pass of a call chain.\n   */\n  (): this;\n\n}\n\n/**\n * Constructs a call of the next pass in chain.\n *\n * @typeParam TChain  A type of supported call chain.\n * @typeParam TNextArgs  A type of argument tuple of the next pass.\n * @typeParam TNextArg  A type of single argument or arguments tuple of the next pass.\n * The same as `TNextArgs` by default.\n * @param callNext  A next pass caller function.\n *\n * @returns Next pass call performed by the given function.\n */\nexport function nextCall<TChain extends CallChain, TNextArgs extends any[], TNextArg>(\n    callNext: (\n        this: void,\n        chain: TChain,\n        fn: (this: void, ...args: TNextArgs) => void,\n    ) => void,\n): NextCall<TChain, TNextArgs, TNextArg> {\n\n  const result = (() => result) as NextCall<TChain, TNextArgs, TNextArg>;\n\n  result[NextCall__symbol] = (chain, fn) => callNext(chain, fn);\n\n  return result;\n}\n\n/**\n * Checks whether the `target` value is a {@link NextCall next call}.\n *\n * @typeParam TChain  A type of supported call chain.\n * @typeParam TNextArgs  A type of arguments tuple of the next pass.\n * @typeParam TNextArg  A type of single argument or arguments tuple of the next pass.\n * @param target  A value to check.\n *\n * @returns `true` if the `target` value is a function with {@link NextCall__symbol} property, or `false` otherwise.\n */\nexport function isNextCall<TChain extends CallChain, TNextArgs extends any[], TNextArg>(\n    target: unknown,\n): target is NextCall<TChain, TNextArgs, TNextArg> {\n  return typeof target === 'function' && NextCall__symbol in target;\n}\n","/**\n * @packageDocumentation\n * @module @proc7ts/call-thru\n */\nimport { CallChain } from '../call-chain';\nimport { nextCall, NextCall } from '../next-call';\n\n/**\n * Provides a single argument for the next call chain pass.\n *\n * The returned {@link NextCall} implementation does the same as if the `arg` returned from the call chain pass.\n *\n * @typeParam TNextArg  A type of argument for the next pass.\n * @param arg  Argument for the next pass.\n *\n * @return A call of the next pass with the given argument.\n */\nexport function nextArg<TNextArg>(arg: TNextArg): NextCall<CallChain, [TNextArg], TNextArg> {\n  return nextCall((chain, pass) => chain.pass(pass, arg));\n}\n","/**\n * @packageDocumentation\n * @module @proc7ts/call-thru\n */\nimport { CallChain } from '../call-chain';\nimport { nextCall, NextCall } from '../next-call';\n\n/**\n * Provides arguments for the next call chain pass.\n *\n * @typeParam TNextArgs  A type of arguments tuple for the next pass.\n * @param args  Arguments for the next pass.\n *\n * @return A call of the next pass with the given arguments.\n */\nexport function nextArgs<TNextArgs extends any[]>(\n    ...args: TNextArgs\n): NextCall<CallChain, TNextArgs, TNextArgs> {\n  return nextCall((chain, fn) => chain.call(fn, args));\n}\n","/**\n * @packageDocumentation\n * @module @proc7ts/call-thru\n */\nimport { CallChain } from '../call-chain';\nimport { nextCall, NextCall } from '../next-call';\n\n/**\n * Builds a next chained call that passes each provided element to the next pass.\n *\n * Note that default {@link CallChain} supported by {@link callThru} would return only the last element.\n *\n * @typeParam T  A type of element to pass down the chain.\n * @param elements  An iterable of elements to pass down the chain.\n *\n * @returns A multi-call of the next pass with each element.\n */\nexport function nextEach<T>(elements: Iterable<T>): NextCall<CallChain, [T], T> {\n  return nextCall((chain, pass) => {\n    for (const element of elements) {\n      chain.pass(pass, element);\n    }\n  });\n}\n","/**\n * @packageDocumentation\n * @module @proc7ts/call-thru\n */\nimport { CallChain } from '../call-chain';\nimport { nextCall, NextCall } from '../next-call';\n\n/**\n * A special {@link NextCall} indicating the rest of the steps are skipped.\n *\n * @typeParam TResult  Call chain result type.\n */\nexport type NextSkip<TResult = undefined> = NextCall<CallChain, never, TResult>;\n\n/**\n * Builds a next call that skips the rest of the chain.\n *\n * This has the same effect as {@link nextReturn `nextReturn(undefined)`}.\n */\nexport const nextSkip: NextSkip = (/*#__PURE__*/ nextCall(chain => chain.skip()));\n"],"names":["NextCall__symbol","Symbol","nextCall","callNext","result","chain","fn","isNextCall","target","nextArg","arg","pass","nextArgs","args","call","nextEach","elements","element","nextSkip","skip"],"mappings":"MASaA,EAAkCC,OAAO,sBAqDtCC,EACZC,GAOF,MAAMC,MAAgBA,EAItB,OAFAA,EAAOJ,GAAoB,CAACK,EAAOC,IAAOH,EAASE,EAAOC,GAEnDF,WAaOG,EACZC,GAEF,MAAyB,mBAAXA,GAAyBR,KAAoBQ,WCzE7CC,EAAkBC,GAChC,OAAOR,GAAS,CAACG,EAAOM,IAASN,EAAMM,KAAKA,EAAMD,cCHpCE,KACTC,GAEL,OAAOX,GAAS,CAACG,EAAOC,IAAOD,EAAMS,KAAKR,EAAIO,cCDhCE,EAAYC,GAC1B,OAAOd,GAAS,CAACG,EAAOM,KACtB,IAAK,MAAMM,KAAWD,EACpBX,EAAMM,KAAKA,EAAMM,YCDVC,EAAoChB,GAASG,GAASA,EAAMc"}