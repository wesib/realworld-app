import{S as t}from"./proc7ts/context-values.c9a10e7b.js";import{c as e,f as s}from"./proc7ts/fun-events.52028069.js";import{S as o,R as r,C as a}from"./wesib/wesib.5a50f1b5.js";import{_ as n}from"./helpers.e1623395.js";import{a as i}from"./wesib/generic.e2a57dd1.js";import{C as u}from"./core.c852ba8c.js";import{U as c,a as l}from"./core/users.39010b51.js";import{e as h}from"./core/util.5786d348.js";const m={},p=new t("current-user-profile",{byDefault:()=>m});function f(t){const o=e(s(t).keepThru_(t=>{if(null==t.username)return t;const e=t=>{o.it=Object.assign(Object.assign({},t),{update:e})};return Object.assign(Object.assign({},t),{update:e})}));return o}let b=(()=>{let t=class{constructor(t){this._context=t,this.author=m;const e=t.get(i),s=t.get(c);e.get(p).to(t=>{this.author=t}),t.on("click").to(()=>{const{author:t}=this;if(t.username){const e=!t.following;t.update(Object.assign(Object.assign({},t),{following:e})),s.followUser(t.username,e).to(e=>{this.author.username&&(e.ok?this.author.update(e.body):(this.author.update(t),console.error("Failed to follow user "+t.username,e.errors)))})}})}render(){const{contentRoot:t}=this._context;return()=>{this.author.username?(t.className=this.author.following?"btn-secondary":"btn-outline-secondary",t.innerHTML='<i class="ion-plus-round"></i> Follow '+h(this.author.username)):t.innerHTML=""}}};return n([o()],t.prototype,"author",void 0),n([r()],t.prototype,"render",null),t=n([a(["follow-author-btn",u],{feature:{needs:l}})],t),t})();export{p as C,b as F,f as c,m as n};//# sourceMappingURL=follow-author-btn.component.94a45df3.js.map
