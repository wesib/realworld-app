import{e}from"../_lib_/call-thru.7c5feeee.js";import{A as t,j as s}from"../_lib_/a-iterable.f330c6da.js";import{F as r}from"../_lib_/context-values.49ce4d52.js";import{e as a,n as o,d as n}from"../_lib_/fun-events.d1b80992.js";import{b as c,B as i,R as p,C as u,q as l,t as m,F as d}from"../_wesib/wesib.6bf655a7.js";import{_ as f}from"../helpers.920c7f83.js";import{c as h,e as _,C as b,f as g,g as j,D as k,F as v,U as x}from"../_wesib/generic.69e1c9fe.js";import{e as w,f as C,g as F,h as O,j as y,k as E,l as A,m as D,n as R,o as U,p as $,a as q}from"../_lib_/input-aspects.cc17fcb1.js";import{C as B}from"./index.e13c2fd6.js";const L=new r("api-error-generator",{byDefault:c(e=>{const r=e.get(i).document;return e=>{let a;return t.from(s(e)).forEach(([e,t])=>{a||(a=r.createElement("ul"),a.classList.add("error-messages"));const s=a;t.forEach(t=>{const a=r.createElement("li");a.innerText=`${e} ${t}`,s.appendChild(a)})}),a}})});function M({mark:t="is-invalid",when:s}={}){return r=>{const n=r.aspect(w);return a({status:r.aspect(C),validity:r.aspect(F)}).keep.thru(({status:[{touched:r,hasFocus:a}],validity:[c]})=>{const i=c.has("incomplete")||c.has("missing");return!r||a&&i?e():o(n.specs(O({mark:t,when:s})))})}}const S={};let T=class{constructor(t){this._context=t,this._errors=S,t.get(h).get(_).thru_(({control:t})=>t?o(t.aspect(F).read.keep.thru_(e=>e.messages("api").reduce((e,t)=>Object.assign(Object.assign({},e),t.api),S))):e(S))(e=>this.errors=e)}get errors(){return this._errors}set errors(e){const t=this._errors;t!==e&&(this._errors=e,this._context.updateState("errors",e,t))}render(){const{contentRoot:e}=this._context;let t;return()=>{t&&(t.remove(),t=void 0),t=this._context.get(L)(this.errors),t&&e.append(t)}}};f([p()],T.prototype,"render",null),T=f([u(["api-errors",B])],T);let z=class{};z=f([u(["in-error",B],l("code"),b(({control:{control:e},aspects:t,context:s})=>m(s,"code").read.keep.thru_(e=>e?e.trim().split(/\s+/):[]).keep.thru(r=>e.convert(y.to(s.element),t).setup(w,e=>{e.add(E()),e.add(M({when:r}))}))))],z);let G=class{};function H({emptyModel:e={},form:t={makeForm({node:t,aspects:s}){const r=D(e).setup(w,e=>e.add(E())).setup(R,e=>e.derive(U())),a=$(t.element,{form:r,aspects:s}).setup(w,e=>e.add(r.aspect(w)));return[r,a]}},button:s}={}){return u(v(t),function({select:e="button",pick:t={deep:!0,all:!0}}={}){return u({feature:{needs:g},define(s){s.whenComponent(s=>{const r=s.get(j),o=s.get(h);s.whenOn(n=>{a({form:o.get(_),button:r.select(e,t).first,aspects:s.get(k)}).tillOff(n).consume(({form:[{control:e}],button:[t],aspects:[s]})=>e&&t&&A(t.element,{form:e,aspects:s}))})})}})}(s))}function I(t){return x(Object.assign(Object.assign({},t),{makeControl:s=>s.context.get(h).get(_).keep.thru_(({form:r})=>{const a=t.makeControl(s);return a?a instanceof q?c(a):o(n(a).keep.thru_((t,s)=>t?(c(t),s?e(t,s):e(t)):e())):e();function c(e){r&&e.aspect(R).derive(r.aspect(R));const t=e.aspect(w);return t.add(E()),t.add(M()),e}})}))}G=f([d({needs:[T,z]})],G);export{L as A,G as C,H as F,I as U};//# sourceMappingURL=input.8e7d6929.js.map
