import{g as t,a as e,d as s,e as a}from"../_lib_/call-thru.7c5feeee.js";import{e as r,t as o}from"../_lib_/a-iterable.f330c6da.js";import{S as i}from"../_lib_/context-values.49ce4d52.js";import{o as n,s as c,d as p}from"../_lib_/fun-events.d1b80992.js";import{F as l}from"../_wesib/wesib.6bf655a7.js";import{_ as d}from"../helpers.920c7f83.js";import{A as h}from"./api.44da948d.js";import{m as f}from"../_lib_/marked.40edb69c.js";function m(t){return new Promise((e,s)=>{f(t.body,(t,a)=>{null!=t?s(t):e(a)})})}const u=["feed","tag","author","favorited","limit","offset"];function _(t,e){return u.every(s=>t[s]===e[s])}function b(e){const s=new URLSearchParams;return r(o(u,e=>"feed"!==e?e:t,s=>{const a=e[s];return a?[s,String(a)]:t}),([t,e])=>s.set(t,e)),s}const g=new i("feed-service"),j={"/personal-feed":{path:"articles/feed",auth:!0},"/global-feed":{path:"articles"}};class A{constructor(t){this._apiFetch=t.get(h)}articles(t){const{path:s,auth:a}=j[t.feed||"/global-feed"],r={path:`${s}?${b(t)}`,init:{method:"GET",headers:{Accept:"application/json"}},auth:a,respondAs:e};return this._apiFetch(r)}article(t){const e={path:`articles/${encodeURIComponent(t)}`,init:{method:"GET",headers:{Accept:"application/json"}},respondAs:"article"};return this._apiFetch(e)}tags(){if(this._tags)return this._tags;let e;return this._tags=n(r=>{if(!e){const r={path:"tags",init:{method:"GET",headers:{Accept:"application/json"}},respondAs:"tags",auth:!1},o=this._apiFetch(r).thru_(e=>e.ok?s(e.body):!1===e.ok?(console.log("Failed to load tags",e.errors),s([])):t),i=c(p(o,()=>[]));e=i.read.thru_(e=>e?a(...e):t)}e(r)})}}let F=class{};F=d([l({setup(t){t.provide({a:g,as:A})}})],F);export{g as F,m as a,_ as b,F as c,b as f};//# sourceMappingURL=articles.d75dce24.js.map
