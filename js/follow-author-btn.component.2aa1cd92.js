import{_ as r}from"./helpers.e1623395.js";import{e as t}from"./frontmeans/httongue.6b868a5b.js";import{S as o,R as e,C as s}from"./wesib/wesib.c496f508.js";import{C as n}from"./core.10059585.js";import{U as a,a as u}from"./core/users.39a49fc0.js";import{e as i,m as c}from"./proc7ts/fun-events.3257bf57.js";import{C as l}from"./proc7ts/context-values.24d38e04.js";import{l as h,d as m}from"./wesib/generic.daf122de.js";const f={};function p(r){const t=i(r.do(c((r=>{if(null==r.username)return r;const o=r=>{t.it={...r,update:o}};return{...r,update:o}}))));return t}var d;class w extends h{constructor(){super("current-user-profile")}static get[(d=m,l)](){return this[m][l]}static userFor(r){return this[m].userFor(r)}userFor(r){return this.valueFor(r).do(c(((r,t)=>r||f)))}}w[d]=new w;let b=class{constructor(r){this._context=r,this.author=f;const t=r.get(a);w.userFor(r)((r=>{this.author=r})),r.on("click")((()=>{const{author:r}=this;if(r.username){const o=!r.following;r.update({...r,following:o}),t.followUser(r.username,o)((t=>{this.author.username&&(t.ok?this.author.update(t.body):(this.author.update(r),console.error(`Failed to follow user ${r.username}`,t.errors)))}))}}))}render(){const{contentRoot:r,element:o}=this._context;return()=>{this.author.username?(o.className=this.author.following?"btn-secondary":"btn-outline-secondary",r.innerHTML=`<i class="ion-plus-round"></i> Follow ${t(this.author.username)}`):r.innerHTML=""}}};r([o()],b.prototype,"author",void 0),r([e()],b.prototype,"render",null),b=r([s(["follow-author-btn",n],{feature:{needs:u}})],b);export{w as C,b as F,p as c,f as n};//# sourceMappingURL=follow-author-btn.component.2aa1cd92.js.map
