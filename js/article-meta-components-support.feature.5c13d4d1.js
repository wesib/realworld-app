import{d as t}from"./lib/context-values.956fc686.js";import{p as e,R as o,C as n,B as s,F as r}from"./wesib/wesib.cad21c89.js";import{_ as a}from"./helpers.920c7f83.js";import{P as i,c,a as l,d,b as m,N as p}from"./wesib/generic.8e8f15be.js";import{C as u}from"./core.f6946162.js";import{f}from"./core/feed.e229f29c.js";const h=new t("current-article",{byDefault:()=>({})});const g=new class extends i{create(t,e){const o=this.byDefault(t);return o.put(e),o}byDefault(t){return{get(){const{searchParams:e,pathname:o}=t.get(c),n=o.indexOf("/",1),s=decodeURIComponent(n<0?o.substring(1):o.substring(1,n));let r,a;return n>0&&"favorite"===o.substring(n+1)?a=s:r=s,{tag:e.get("tag")||void 0,author:r,favorited:a,limit:parseInt(e.get("limit")||"",10)||void 0,offset:parseInt(e.get("offset")||"",10)||void 0}},put(e){const{favorited:o,author:n=""}=e,s=new URL(t.get(c).href);s.pathname=o?`/${encodeURIComponent(o)}/favorite`:`/${encodeURIComponent(n)}`;const r=f(Object.assign(Object.assign({},e),{favorited:void 0,author:void 0})).toString();s.search=r?"?"+r:"",t.put(c,s)}}}};let v=class{constructor(t){this._context=t,this.article={};const e=t.get(m);t.whenOn(t=>{e.get(h).tillOff(t)(t=>this.article=t)})}render(){const t=this._context.get(p),{document:e}=this._context.get(s),{contentRoot:o}=this._context,n=e.createDocumentFragment(),r=n.appendChild(e.createElement("a")),a=n.appendChild(e.createElement("div"));a.className="info";const i=a.appendChild(e.createElement("a"));i.className="author";const c=a.appendChild(e.createElement("time"));return c.className="date",o.appendChild(n),()=>{var e,o;const n=this.article;let s="",a="",l="",d="",m="";if(n.slug){const{author:r}=n;s=(null===(o=null===(e=t.with(g,{author:r.username}).pretend("profile/"))||void 0===e?void 0:e.url)||void 0===o?void 0:o.href)||"",a=r.image?`<img src="${encodeURI(r.image)}"/>`:"",l=r.username,d=n.createdAt,p=new Date(n.createdAt),m=((new Date).getFullYear()===p.getFullYear()?b:_).format(p)}var p;r.href=s,r.innerHTML=a,i.href=s,i.innerText=l,c.innerText=m,d?c.setAttribute("datetime",d):c.removeAttribute("datetime")}}};a([e()],v.prototype,"article",void 0),a([o()],v.prototype,"render",null),v=a([n(["article-author",u],{feature:{needs:d}},l())],v);const b=new Intl.DateTimeFormat("en-US",{month:"long",day:"numeric"}),_=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"numeric"});let C=class{constructor(t){this._context=t;const e=t.get(m);t.whenOn(t=>{e.get(h).tillOff(t)(t=>{this._post=t.slug?{favorited:t.favorited,favoritesCount:t.favoritesCount}:void 0})})}render(){const{contentRoot:t}=this._context,{document:e}=this._context.get(s),o=e.createElement("i");t.insertBefore(o,t.childNodes[0]);const n=t.appendChild(e.createElement("span"));return n.className="counter",()=>{o.className=this._post&&this._post.favorited?"ion-heart":"ion-ios-heart-outline",n.innerText=this._post&&this._post.favoritesCount?String(this._post.favoritesCount):"",t.className=this._post&&this._post.favorited?"btn-secondary":"btn-outline-secondary"}}};a([e()],C.prototype,"_post",void 0),a([o()],C.prototype,"render",null),C=a([n(["favorite-post",u])],C);let x=class{};x=a([r({needs:[v,C]})],x);export{x as A,h as C,g as P};//# sourceMappingURL=article-meta-components-support.feature.5c13d4d1.js.map
