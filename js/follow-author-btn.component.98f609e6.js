import{S as o}from"./proc7ts/context-values.1da2f733.js";import{c as e,f as t}from"./proc7ts/fun-events.fad06cca.js";import{S as r,R as s,C as a}from"./wesib/wesib.5f0eb508.js";import{_ as n}from"./helpers.e1623395.js";import{a as u}from"./wesib/generic.be8d84ee.js";import{C as i}from"./core.714cbb7b.js";import{U as c,a as l}from"./core/users.7bbac2cb.js";import{e as f}from"./core/util.fb30940c.js";const m={},h=new o("current-user-profile",{byDefault:()=>m});function p(o){const r=e(t(o).keepThru_((o=>{if(null==o.username)return o;const e=o=>{r.it={...o,update:e}};return{...o,update:e}})));return r}let b=class{constructor(o){this._context=o,this.author=m;const e=o.get(u),t=o.get(c);e.get(h).to((o=>{this.author=o})),o.on("click").to((()=>{const{author:o}=this;if(o.username){const e=!o.following;o.update({...o,following:e}),t.followUser(o.username,e).to((e=>{this.author.username&&(e.ok?this.author.update(e.body):(this.author.update(o),console.error("Failed to follow user "+o.username,e.errors)))}))}}))}render(){const{contentRoot:o,element:e}=this._context;return()=>{this.author.username?(e.className=this.author.following?"btn-secondary":"btn-outline-secondary",o.innerHTML='<i class="ion-plus-round"></i> Follow '+f(this.author.username)):o.innerHTML=""}}};n([r()],b.prototype,"author",void 0),n([s()],b.prototype,"render",null),b=n([a(["follow-author-btn",i],{feature:{needs:l}})],b);export{h as C,b as F,p as c,m as n};//# sourceMappingURL=follow-author-btn.component.98f609e6.js.map
