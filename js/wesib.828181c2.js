import{C as e,a as t,S as n,i as r,t as s,F as o,n as i,A as a,v as u,b as c,c as l,d as h,e as p,f as d,g as f,h as g,j as m,m as w,k as y,l as b,o as _,p as v,q as x,M as k,r as O,V as D,E as S,s as C,D as E,u as R,w as P,x as j,y as A,z as U,B as T,G as L,H as N,I as q,N as M,J as K,K as B,L as I,O as z,P as $,Q as V,R as F,T as H,U as Q,W,X as G,Y as J,Z as X,_ as Y,$ as Z,a0 as ee,a1 as te,a2 as ne,a3 as re,a4 as se,a5 as oe}from"./lib.722ff502.js";const ie=new n("bootstrap-context");class ae extends e{static get[t](){return ie}}function ue(e){return(t,n)=>{const r=t.get(ae);return t===r?e(r,n):r.get(n)}}const ce=new n("component-factory");class le{static get[t](){return ce}connectTo(e){const t=this.mountTo(e);return t.connected=!0,t}}const he=new n("window",{byDefault:()=>window}),pe=new n("bootstrap-root",{byDefault:e=>e.get(he).document.body}),de=new n("default-namespace-aliaser"),fe=new o("default-render-scheduler",{byDefault:ue(e=>(t={})=>i(Object.assign(Object.assign({},t),{window:t.window||e.get(he)})))});function ge(e){return Array.isArray(e)}class me extends a{constructor(e){super(),this.items=null==e?new Set:ge(e)?new Set(e):new Set([e])}get value(){switch(this.items.size){case 0:return;case 1:return this.items[Symbol.iterator]().next().value;default:return[...this.items]}}[Symbol.iterator](){return this.items[Symbol.iterator]()}add(...e){return e.forEach(e=>this.items.add(e)),this}get size(){return this.items.size}merge(e){return null==e?this:ge(e)?this.add(...e):this.add(e)}}function we(e,t=(()=>!0)){const n=Object.getPrototypeOf(e.prototype);if(null==n)return;const r=n.constructor;return t(r)?r:we(r,t)}function ye(e,t,n,r){const s=!n,o=r(n?function(e){if(function(e){return void 0===e.value&&void 0===e.writable}(e))return e;const t=Symbol("value"),n=e.value,r=Object.assign(Object.assign({},e),{writable:void 0,value:void 0,get(){return t in this?this[t]:n}});return e.writable&&(r.set=function(e){this[t]=e}),delete r.writable,delete r.value,r}(n):function(e,t){const n=Symbol(`${String(t)}:value`),r=e[t];return{configurable:!0,enumerable:!0,get(){return n in this?this[n]:r},set(e){this[n]=e}}}(e,t));if(!s||!o)return o;Object.defineProperty(e,t,o)}function be(e,t,n=((e,t)=>t)){return e?t?function(...r){return n(e.apply(this,r),t.apply(this,r))}:e:t}function _e(e){return e.nodeType===Node.ELEMENT_NODE}class ve{constructor(e){this.symbol=e}own(e){return e.hasOwnProperty(this.symbol)?e[this.symbol]:void 0}of(e){const t=this.own(e),n=we(e),r=n&&this.of(n);return t?r?this.merge([r,t]):t:r}define(e,t){const n=this.own(e),r=w(t,t=>this.meta(t,e)),s=this.merge(n?L([[n],r]):r);return Object.defineProperty(e,this.symbol,{configurable:!0,value:s}),e}}class xe{constructor(){this.promise=new Promise((e,t)=>{this._resolve=e,this._reject=t})}resolve(e){this._resolve(e)}reject(e){this._reject(e)}}const ke=Symbol("feature-def");class Oe extends ve{constructor(){super(ke)}merge(e){return r(e,(e,t)=>({needs:new me(e.needs).merge(t.needs).value,has:new me(e.has).merge(t.has).value,setup:be(e.setup,t.setup),init:be(e.init,t.init)}),{})}meta(e,t){const n=e[ke];return null==n?e:this.meta("function"==typeof n?e[ke](t):n,t)}}const De=new Oe,Se={[ke]:()=>({})},Ce={of:e=>De.of(e)||{},for:(e,t)=>De.meta(t,e),merge:(...e)=>De.merge(e),all:(...e)=>r(e,(e,t)=>({[ke]:n=>Ce.merge(Ce.for(n,e),Ce.for(n,t))}),Se),define:(e,...t)=>De.define(e,t)};function Ee(...e){return t=>Ce.define(t,...e)}const Re=new n("feature-context");class Pe extends ae{static get[t](){return Re}whenDefined(e){return this.get(ae).whenDefined(e)}load(e){return this.get(ae).load(e)}}class je extends Error{constructor(e){super("Circular feature needs: "+e.reduce((e,[t,n,r])=>(e||t.name)+` ${n} ${r.name}`,"")),this.needs=e}}const Ae=Symbol("component-def");class Ue extends ve{constructor(){super(Ae)}merge(e){return r(e,(e,t)=>Object.assign(Object.assign(Object.assign({},e),t),{setup:be(e.setup,t.setup),define:be(e.define,t.define),feature:e.feature?t.feature?Ce.merge(e.feature,t.feature):e.feature:t.feature}),{})}meta(e,t){const n=e[Ae];return null!=n?this.meta("function"==typeof n?e[Ae](t):n,t):null!=e[ke]?{feature:Ce.for(t,e)}:q(e)?{name:e}:e}}const Te=new Ue,Le={[Ae]:()=>({})},Ne={of:e=>Te.of(e)||{},for:(e,t)=>Te.meta(t,e),merge:(...e)=>Te.merge(e),all:(...e)=>r(e,(e,t)=>({[Ae]:n=>Ne.merge(Ne.for(n,e),Ne.for(n,t))}),Le),define:(e,...t)=>Te.define(e,t)};function qe(...e){const t=t=>Ne.define(t,...e);return t[Ae]=()=>Ne.all(...e),t}const Me=new n("component-context"),Ke=new n("component-event-dispatcher",{byDefault(e){const t=e.get(Me),n=new E(t.element);return R(n).needs(t),{dispatch:e=>n.dispatch(e),on:e=>n.on(e)}}}),Be=new n("content-root",{byDefault:e=>e.get(Me).element}),Ie=new o("state-updater",{byDefault:u(C)}),ze=Symbol("component-context");class $e extends e{constructor(){super(...arguments),this.updateState=Ve.bind(this)}static get[t](){return Me}static of(e){const t=e[ze];if(!t)throw TypeError(`No component context found in ${e}`);return t}get contentRoot(){return this.get(Be)}on(e){return this.get(Ke).on(e)}dispatchEvent(e){this.get(Ke).dispatch(e)}}function Ve(e,t,n){this.get(Ie)(e,t,n)}class Fe extends Event{get context(){return $e.of(this.target)}}const He=Symbol("anonymous-component-property");function Qe(e){const t=({get:t,set:n},r=He,s)=>qe({[Ae](o){const i=e({type:o,key:r,readable:!0,writable:s,enumerable:!1,configurable:!1,get:e=>t(e,r),set:(e,t)=>n(e,t,r)});return i&&i.componentDef||{}}}),n=(e,n)=>t({get:(t,n)=>e(t,n)},n,!1),r=(t,n,r)=>ye(t,n,r,r=>{const{get:s,set:o}=r,i=t.constructor,{get:a,set:u,configurable:c,enumerable:l,componentDef:h={}}=e({type:i,key:n,readable:!!r.get,writable:!!r.set,enumerable:!!r.enumerable,configurable:!!r.configurable,get:s?e=>s.call(e):()=>{throw new TypeError(`"${String(n)}" is not readable`)},set:o?(e,t)=>o.call(e,t):()=>{throw new TypeError(`"${String(n)}" is read-only`)}})||{};Ne.define(i,h);const p=Object.assign(Object.assign({},r),{configurable:null!=c?c:r.configurable,enumerable:null!=l?l:r.enumerable});return(a||u)&&(p.get=a&&function(){return a(this,n)},p.set=u&&function(e){u(this,e,n)}),p});return r.With=(e,n)=>t(e,n,!0),r.By=n,r.As=(e,t)=>n(u(e),t),r}class We extends l{constructor(){super("element-adapter"),this.upKey=this.createUpKey(e=>e.seed.keep.thru((...t)=>{const n=t.reduce((e,t)=>n=>e(n)||t(n),Ge),r=()=>p(Ge);return n!==Ge?n:g(e.byDefault(r)||r())}))}grow(e){let t;return e.context.get(this.upKey,"or"in e?{or:null!=e.or?p(e.or):e.or}:void 0)(e=>t=e),e=>t(e)}}function Ge(e){return e[ze]}const Je=new We,Xe=new o("element-observer",{byDefault:ue(e=>{const t=e.get(Je);class n extends MutationObserver{constructor(e){super(n=>{n.forEach(e=>{A(U(e.removedNodes),e=>{var t;return null===(t=function(e){var t;return null===(t=e[ze])||void 0===t?void 0:t.mount}(e))||void 0===t?void 0:t.checkConnected()}),A(b(U(e.addedNodes),_e),e=>{var n,r;return null===(r=null===(n=t(e))||void 0===n?void 0:n.mount)||void 0===r?void 0:r.checkConnected()})}),e(n,this)})}observe(e,t){super.observe(e,Object.assign(Object.assign({},t),{childList:!0}))}}return e=>new n(e)})});const Ye=Symbol("component-factory");function Ze(e){const t=e[Ye];if(!t)throw new TypeError(`Component is not defined: ${e}`);return t}const et=new n("custom-elements",{byDefault:function(e){const t=e.get(he).customElements,n=e.get(de);return new class extends tt{define(e,r){if(q(e))return void t.define(K.name(e,n),r);const s=Ze(e),{name:o,extend:i}=s.elementDef;o?i&&i.name?t.define(K.name(o,n),r,{extends:i.name}):t.define(K.name(o,n),r):rt(e).resolve(void 0)}whenDefined(e){if(q(e))return t.whenDefined(K.name(e,n));const r=Ze(e),{name:s}=r.elementDef;return s?t.whenDefined(K.name(s,n)):rt(e).promise}}}});class tt{static get[t](){return et}}const nt=Symbol("component-resolver");function rt(e){return e[nt]||(e[nt]=new xe)}const st=new n("definition-context"),ot=new n("element-def",{byDefault(e){const t=e.get(st).componentType,{name:n,extend:r}=Ne.of(t),s={get type(){return r&&r.type||e.get(he).HTMLElement},get name(){return r&&r.name}};return{get name(){return n},get extend(){return s}}}});class it extends e{static get[t](){return st}get elementDef(){return this.get(ot)}}const at=new n("bootstrap-context-registry");class ut extends c{constructor(){super(),this.provide({a:ut,is:this}),this.values=this.newValues()}static get[t](){return at}static create(){return new ut}}const ct=new n("component-context-registry",{byDefault:ue(()=>new lt)});class lt extends c{static get[t](){return ct}}const ht=new n("definition-context-registry",{byDefault:ue(e=>new pt(e))});class pt extends c{static get[t](){return ht}}const dt=Symbol("post-def-setup");function ft(e){if(e.hasOwnProperty(dt))return e[dt];const t=s(),n=new P,r=t.read.thru(e=>e?f(e):y()),o=j(r,n),i=we(e,e=>Ae in e);if(i){const e=ft(i);o(t=>e.send(t))}const a={on:o,send(e){n.send(e)},setup(e){t.it=e}};return Object.defineProperty(e,dt,{value:a}),a}class gt{constructor(){const e=s(0),t=new P;this.onCreated=v(n=>{const r=e.it+1;t.on({supply:n.supply,receive:(e,t,s)=>{s<r&&n.receive({onRecurrent(t){e.onRecurrent(e=>t(e))}},t)}}),++e.it}),this.readNotifier=e.read.keep.thru_(e=>(n,r)=>(t.send(n,r),e))}}const mt=new n("element-builder",{byDefault:ue((function(e){const t=e.get(pt),n=e.get(lt),r=new P,o=new P;return{definitions:r,components:o,buildElement(e){var o;const a=Ne.of(e),c=new gt;let l;const h=s(!1),p=h.read.thru(e=>e?f():y());let d;function g(){return n.append(l)}const m=new class extends le{get componentType(){return d.componentType}get elementType(){return d.elementType}get elementDef(){return d.elementDef}mountTo(e){if(e[ze])throw new Error(`Element ${e} already bound to component`);const t=i({definitionContext:d,whenComponent:c,registry:g(),element:e,elementSuper:t=>e[t],createMount:t=>new class extends class{get component(){return this.context.component}get element(){return this.context.element}}{get context(){return t}get connected(){return 3===yt(e).it}set connected(t){yt(e).it=t?3:2}checkConnected(){const t=e,n=t.ownerDocument;return this.connected=null!=n&&n.contains(t)}}}).mount;return t.checkConnected(),bt(t.context),t}};d=new class extends it{constructor(){var n;super();const r=this;this.whenReady=p.thru_(u(this)).once;const s=new pt(t.seedIn(this));s.provide({a:it,is:this}),s.provide({a:le,is:m}),this.get=s.newValues().get,l=new lt(s.seedIn(this));const o={get componentType(){return e},get whenReady(){return r.whenReady},get whenComponent(){return r.whenComponent},perDefinition:e=>s.provide(e),perComponent:e=>l.provide(e)};null===(n=a.setup)||void 0===n||n.call(a,o),ft(e).setup(o)}get componentType(){return e}get whenComponent(){return c.onCreated}get elementType(){throw new Error("Custom element class is not constructed yet. Consider to use a `whenReady()` callback")}perComponent(e){return l.provide(e)}},null===(o=a.define)||void 0===o||o.call(a,d),r.send(d);const w=function(e,t,n){const r=e.get(ot);class s extends r.extend.type{constructor(){super(),bt(i({definitionContext:e,whenComponent:t,registry:n(),element:this,createMount:C,elementSuper:e=>super[e]}))}connectedCallback(){yt(this).it=3}disconnectedCallback(){yt(this).it=2}}return s}(d,c,g);return Object.defineProperty(d,"elementType",{configurable:!0,enumerable:!0,value:w}),h.it=!0,m}};function i({definitionContext:e,whenComponent:t,registry:n,element:r,createMount:i,elementSuper:a}){const u=s(0),c=s();u.on(C).whenOff(e=>c.it=[e]);const l=c.read.thru(e=>e?f(e[0]):y()).once,h=u.read.thru_(e=>2===e?f():y()),p=u.read.thru_(e=>{if(3!==e)return y();const t=O();return h.once(()=>t.off()),f(t)});let d;const g=n.newValues();const m=new class extends $e{constructor(){super(),this.get=g.get,this.elementSuper=a;const e=u.read.thru(e=>e?f(this):y());this.whenReady=e.once}get componentType(){return e.componentType}get element(){return r}get component(){throw new Error("The component is not constructed yet. Consider to use a `whenReady()` callback")}get mount(){return d||(d=i(this))}get connected(){return 3===u.it}get[S](){return R(u)}get whenOn(){return p}get whenOff(){return h}get whenDestroyed(){return l}destroy(e){u.done(e)}};let w=0;m.whenDestroyed(()=>function(e){const{element:t,mount:n}=e;n&&(n.connected=!1);const r=t.parentElement;r&&r.removeChild(t)}(m)),n.provide({a:$e,is:m}),Object.defineProperty(r,ze,{value:m}),Object.defineProperty(r,wt,{writable:!0,value:u}),t.readNotifier.once(e=>w=e(m,w)),m.whenOn(e=>{t.readNotifier({supply:e,receive(e,t){w=t(m,w)}})}),o.send(m);const b=function(e,t){const n=e.prototype,r=n[ze];n[ze]=t;try{const s=new e(t);return Object.defineProperty(s,ze,{value:t}),s}finally{n[ze]=r}}(e.componentType,m);return Object.defineProperty(m,"component",{configurable:!0,enumerable:!0,value:b}),u.it=1,m}}))}),wt=Symbol("component-status");function yt(e){return e[wt]}function bt(e){e.whenOn.once(()=>e.dispatchEvent(new Fe("wesib:component",{bubbles:!0})))}const _t=u(C);class vt{constructor(e){this._context=e,this._definitionQueue=[],e.whenReady(()=>{this._definitionQueue.forEach(e=>e()),delete this._definitionQueue})}get customElements(){return this._context.get(tt)}define(e){this._definitionQueue.push(()=>{const t=this._context.get(mt).buildElement(e);e[Ye]=t,this.customElements.define(e,t.elementType)})}}const xt=Symbol("feature-key");class kt extends l{static of(e){return e.hasOwnProperty(xt)?e[xt]:e[xt]=new kt(e)}get upKey(){return this}constructor(e){super(`feature:${e.name}`)}grow(e){return t=e.context.get(ae),n=e.seed.keep.thru(Ot),h(e=>{let r,s=p(),o=Promise.resolve("idle");return d({clause:n,deps:Dt(t,n)}).keep.thru_(({clause:[e],deps:n})=>{if(!e)return f();const[i,,a]=e;if(i.feature===r)return g(s);if(r=i.feature,a!==r)return g(s=t.get(kt.of(r)).keep.thru_(e=>(e.to(o),o=e.stage,e)));const u=new Ct(t,i,n).to(o),c=p(u);return g(s=h(e=>c(e).whenOff(()=>{o=u.unload()})).share())})(e)}).keep.thru(function(){let e=null;return t=>e===t?y():(e=t,t?f(t):f())}());var t,n}}function Ot(...e){let t,n=!1;for(const r of e)switch(r[1]){case"is":n=!0,t||(t=r);break;case"has":t=r;break;case"needs":n=!0}return n?t:void 0}function Dt(e,t){return t.keep.thru_(t=>{if(!t)return f();const[{def:n}]=t,r=new me(n.needs);return r.size?g(m(...w(r,t=>e.get(kt.of(t)))).keep.thru_(St)):f()})}function St(...e){return f(...b(w(e,e=>e[0]),_))}class Ct{constructor(e,t,n){this.bsContext=e,this.request=t,this.deps=n,this.state=s(!1),this.down=new Promise(e=>this._down=e),this._stage=Promise.resolve(new Rt(this))}get stage(){return this._stage.then(e=>e.after)}get ready(){return this.state.it}to(e){const t=this._stage;return this._stage=e.then(e=>t.then(t=>t[e]())),this}async setup(){await(this._stage=this._stage.then(e=>e.setup()))}async init(){await(this._stage=this._stage.then(e=>e.init()))}async unload(){const e=this._stage;delete this._stage;const t=await e,n=await t.stop();return this._down(),n}}class Et{constructor(e,t=(()=>Promise.resolve())){this.loader=e,this._stop=t}idle(){return Promise.resolve(this)}stop(){return this._stop().then(()=>this.after)}perDep(e){const{deps:t}=this.loader;return Promise.all(t.map(t=>e(t)))}}class Rt extends Et{get after(){return"idle"}async setup(){var e;await this.perDep(e=>e.setup());const{bsContext:t,request:{def:n}}=this.loader,[r,o]=function(e,t){const n=function(){const e=[];let t=t=>{const n=t();return e.push(n),n};return{supply:O(()=>{t=_t,A(U(e).reverse(),e=>e()),e.length=0}),add:e=>t(e)}}();let r;const o=e.get(pt),i=e.get(lt),a=new c(e),u=e.get(mt),l=u.definitions.on.tillOff(n.supply),h=u.components.on.tillOff(n.supply);return[new class extends Pe{constructor(){super(),this.get=a.newValues().get;const n=d({st:t.state,bs:s().by(e.whenReady)}).thru(({st:[e],bs:[t]})=>t&&e?f(this):y());this.whenReady=n.once,a.provide({a:Pe,is:this}),r=new vt(this)}get feature(){return t.request.feature}get onDefinition(){return l}get onComponent(){return h}provide(t){return n.add(()=>e.get(ut).provide(t))}perDefinition(e){return n.add(()=>o.provide(e))}perComponent(e){return n.add(()=>i.provide(e))}setupDefinition(e){return function(e,t){const{on:n}=ft(e);return v(e=>{n({supply:e.supply.needs(t.supply),receive(n,r){const s=r.whenReady.tillOff(t.supply),o=r.whenComponent.tillOff(t.supply);e.receive(n,{get componentType(){return r.componentType},get whenReady(){return s},get whenComponent(){return o},perDefinition:e=>t.add(()=>r.perDefinition(e)),perComponent:e=>t.add(()=>r.perComponent(e))})}})})}(e,n)}define(e){r.define(e)}},n.supply]}(t,this.loader);return null===(e=n.setup)||void 0===e||e.call(n,r),new Pt(this.loader,r,()=>Promise.resolve(o.off()))}init(){return this.setup().then(e=>e.init())}}class Pt extends Et{constructor(e,t,n){super(e,n),this._context=t}get after(){return"setup"}setup(){return Promise.resolve(this)}async init(){var e;await this.perDep(e=>e.init());const{request:{def:t}}=this.loader;return null===(e=t.init)||void 0===e||e.call(t,this._context),new jt(this)}}class jt extends Et{get after(){return"init"}constructor(e){super(e.loader,()=>e.stop()),e.loader.state.it=!0}setup(){return Promise.resolve(this)}init(){return Promise.resolve(this)}}class At{constructor(e,t,n){this._requester=e,this.feature=t,this._revoke=n,this._uses=0,this.def=function(e){let t=Ce.of(e);if(Ae in e){t=Ce.merge(t,{init(t){t.define(e)}});const{feature:n}=Ne.of(e);n&&(t=Ce.merge(t,n))}return t}(t)}request(e){const t=this._requester,{registry:n}=t,r=[this,"is",this.feature];return this._revokeBy(n.provide({a:kt.of(this.feature),is:r})),new me(this.def.has).forEach(r=>{const s=[this,"has",r];this._revokeBy(n.provide({a:kt.of(r),is:s}));const o=t.request(r,[...e,s]);this._revokeBy(()=>o.unuse())}),new me(this.def.needs).forEach(r=>{const s=[this,"needs",r],o=t.request(r,[...e,s]);this._revokeBy(()=>o.unuse()),this._revokeBy(n.provide({a:kt.of(r),is:s}))}),this._uses=1,this}reuse(e){if(!this._uses)throw new je(e.map(([{feature:e},t,n])=>[e,t,n]));return++this._uses,this}unuse(){--this._uses||this._revoke()}_revokeBy(e){this._revoke=be(e,this._revoke)}}const Ut=new n("feature-requester",{byDefault:ue(e=>new Tt(e))});class Tt{constructor(e){this._map=new Map,this.registry=e.get(ut)}static get[t](){return Ut}request(e,t=[]){const n=this._map.get(e);if(n)return n.reuse(t);const r=new At(this,e,()=>this._map.delete(e));return this._map.set(e,r),r.request(t)}}function Lt(...e){const t=ut.create(),{bootstrapContext:n,complete:r}=function(e){const t=s(0),n=e.values;const r=new class extends ae{constructor(){super(),this.get=n.get;const r=t.read.thru(e=>e?f(this):y());this.whenReady=r.once,e.provide({a:de,by:x}),e.provide({a:ae,is:this})}async whenDefined(e){return await new Promise(this.whenReady),await this.get(tt).whenDefined(e),Ze(e)}load(e){const t=h(t=>{const n=r.get(Tt).request(e),o=s({status:{feature:e,ready:!1}});this.get(kt.of(e))({supply:t.supply,receive(e,t){const n=t;o.it={status:{feature:n.request.feature,ready:n.ready},down:n.down},n.ready||n.init().then(()=>{o.it={status:{feature:n.request.feature,ready:!0},down:n.down}})}}).whenOff(()=>{n.unuse()}),o.read(t)}).share();let n;const o=t(({down:e})=>{n=e}),i=t.keep.thru(e=>e.status).tillOff(o);return new class extends class{get[N](){return this.read}}{get read(){return i}get down(){return n}dismiss(e){return o.off(e),n}}}};return{bootstrapContext:r,complete(){t.it=1}}}(t),o=1===e.length?e[0]:(i=e,Ce.define(class{},{needs:i}));var i;return n.get(Tt).request(o),n.get(kt.of(o))(e=>{e.init().then(r)}),n}const Nt=new k("attribute-descriptor"),qt=Symbol("attribute");function Mt(e){return[qt,e]}function Kt(e,t=!0){if(!1===t)return C;if(!0===t||"function"==typeof t){const n=Mt(e),r=!0===t?Bt:t;return(e,t,s)=>r(e,n,t,s)}return(e,n,r)=>Bt(e,t,n,r)}function Bt(e,t,n,r){$e.of(e).updateState(t,n,r)}const It=new n("attribute-registry");class zt{constructor(e){this._context=e}static get[t](){return It}get attrs(){if(this._attrs)return this._attrs;const e=new Map;return this._context.get(Nt).forEach(t=>{const{name:n,change:r}=t;e.set(n,be(e.get(n),r))}),this._attrs=e}define(e){const t=this.attrs,n=Array.from(t.keys());n.length&&(Object.defineProperty(e,"observedAttributes",{configurable:!0,enumerable:!0,value:n}),Object.defineProperty(e.prototype,"attributeChangedCallback",{configurable:!0,enumerable:!0,value:function(e,n,r){t.get(e)($e.of(this).component,r,n)}}))}mount(e){const t=e.element,n=this.attrs,r=Array.from(n.keys());r.length&&new(0,this._context.get(he).MutationObserver)(e=>e.forEach(e=>{const r=e.attributeName;return n.get(r)($e.of(t).component,t.getAttribute(r),e.oldValue)})).observe(t,{attributes:!0,attributeFilter:r,attributeOldValue:!0})}}const $t={setup(e){e.perDefinition({as:zt}),e.onDefinition(e=>{e.whenReady(({elementType:t})=>e.get(zt).define(t))}),e.onComponent(e=>{const t=e.mount;t&&e.get(zt).mount(t)})}};class Vt{static get[ke](){return $t}}function Ft(e){return Qe(({type:t,key:n})=>{const r=function(e,t,n){let r,s;if("string"==typeof n)r=n,s=Kt(r);else{if(n&&n.name)r=n.name;else{if("string"!=typeof t)throw new TypeError("Attribute name is required as property key is not a string: "+`${e.constructor.name}.prototype.${String(t)}`);r=t}s=Kt(r,n&&n.updateState)}return{name:r,change:s}}(t.prototype,n,e),{name:s}=r;return{componentDef:{feature:{needs:Vt},setup(e){e.perDefinition({a:Nt,is:r})}},get:e=>$e.of(e).element.getAttribute(s),set(e,t){$e.of(e).element.setAttribute(s,t)}}})}function Ht(e){return qe({feature:{needs:Vt},setup(t){const n=e=>{"string"==typeof e?t.perDefinition({a:Nt,is:{name:e,change:Kt(e)}}):Object.keys(e).forEach(n=>{t.perDefinition({a:Nt,is:{name:n,change:Kt(n,e[n])}})})};ge(e)?e.forEach(n):n(e)}})}const Qt=new n("component-state");class Wt extends T{static get[t](){return Qt}}const Gt={setup(e){e.perComponent({a:Wt,by(e){const t=new Wt;return e.whenDestroyed(e=>t.done(e)),t}}),e.perComponent({a:Ie,by:e=>e.update,with:[Wt]})}};class Jt{static get[ke](){return Gt}}function Xt(e,t,n=Mt(t)){const{element:r}=e,s=e.get(Wt).track(n),o=O(),i=s.onUpdate.thru((e,t,n)=>f(t,n)).tillOff(o);return new class extends D{get on(){return i}get[S](){return o}get it(){return r.getAttribute(t)}set it(e){o.isOff||(null==e?r.removeAttribute(t):r.setAttribute(t,e))}}}const Yt=new k("dom-property-descriptor"),Zt=new n("dom-property-registry");class en{constructor(e){this._context=e}static get[t](){return Zt}get props(){return this._props?this._props:this._props=new Map(this._context.get(Yt).map(({key:e,descriptor:t})=>[e,t]))}define(e){const t=e.prototype;this.props.forEach((e,n)=>{Object.defineProperty(t,n,e)})}mount(e){const t=e.element;this.props.forEach((e,n)=>{Object.defineProperty(t,n,e)})}}const tn={setup(e){e.perDefinition({as:en}),e.onDefinition(e=>{e.whenReady(({elementType:t})=>e.get(en).define(t))}),e.onComponent(e=>{const t=e.mount;t&&e.get(en).mount(t)})}};class nn{static get[ke](){return tn}}const rn=Symbol("dom-property");function sn(e){return[rn,e]}function on(e,t,n,r){$e.of(e).updateState(t,n,r)}function an(e={}){return Qe(t=>{const{key:n,get:r}=t;let{set:s}=t;const o=function(e,{propertyKey:t=e.key,configurable:n=e.configurable,enumerable:r=e.enumerable,writable:s=e.writable}){const o=e.key;return{key:t,descriptor:{configurable:n,enumerable:r,get:function(){return $e.of(this).component[o]},set:s?function(e){$e.of(this).component[o]=e}:void 0}}}(t,e);if(!1!==e.updateState){const t=function(e,t=!0){if(!0===t||"function"==typeof t){const n=sn(e),r=!0===t?on:t;return(e,t,s)=>r(e,n,t,s)}return(e,n,r)=>$e.of(e).updateState(t,n,r)}(n,e.updateState),o=s;s=(e,n)=>{const s=r(e);o(e,n),t(e,n,s)}}return{componentDef:{feature:{needs:nn},setup(e){e.perDefinition({a:Yt,is:o})}},get:r,set:s}})}const un={render(e,t,n={}){const{offline:r,path:s=[]}=n,o=e.get(Wt).track(s),i=e.get(fe)();let a=0;const u=o.onUpdate(()=>{r||e.connected?c():a=0});function c(){a=1,i(h)}function l(){return 1===a&&(i(C),a=-1,!0)}function h(){if(!(a<0))for(a=2;;){const e=t();if(e===t||"function"!=typeof e)break;t=e}}r?c():e.whenOn(e=>{e.whenOff(l),a<=0&&c()}).whenOff(e=>{l(),u.off(e)})}};function cn(e){return Qe(({get:t})=>({componentDef:{feature:{needs:Jt},define(n){n.whenComponent(n=>{n.whenReady(()=>{const{component:r}=n;un.render(n,t(r).bind(r),e)})})}}}))}const ln=new M("https://wesib.github.io/ns","b","wesib");class hn extends l{constructor(e){super(e),this.upKey=this.createUpKey(e=>e.seed.keep.thru((...t)=>{if(t.length)return X(function(e){return(t,n)=>{const r=(n,s)=>{const o=e[n];return o?Y(o((e=s)=>r(n+1,e),s)):t(s)};return r(0,n)}}(t));const n=()=>p(pn);return g(e.byDefault(n)||n())}))}grow(e){let t;return e.context.get(this.upKey,"or"in e?{or:null!=e.or?p(e.or):e.or}:void 0)(e=>t=e),(e,n)=>t(e,n)}}function pn(e,t){return e(t)}const dn=new hn("http-fetch-agent"),fn={};const gn=new o("http-fetch",{byDefault:ue((function(e){const t=e.get(he),n=e.get(dn);return(e,t)=>n(r,new Request(e,t));function r(e){return v(n=>{const r=new P;let s;if("AbortController"in t){const o=new t.AbortController,{signal:i}=o;s=O(e=>{e===fn&&o.abort()}),n.supply.whenOff(()=>s.off(fn)).needs(s),r.on({supply:s,receive(e,t){n.receive(e,t)}});const a=e.signal;a&&(new E(a).on("abort").once(()=>o.abort()),a.aborted&&o.abort()),e=new Request(e,{signal:i})}else s=r.on(n);t.fetch(e).then(e=>{r.send(e),s.off()}).catch(e=>s.off(e))})}}))});const mn=new n("hierarchy-root",{byDefault:e=>{const t=e.get(pe);return new E(t).on("wesib:component")(({context:e})=>e.get(yn).issue()),s()}}),wn=new n("hierarchy-updates",{byDefault:e=>new yn(e.get($e))});class yn{constructor(e){const t=new P,n=e.get(ae).get(mn);this.on=t.on,this.send=()=>t.send(e),this.issue=()=>{const t=bn(e);t?t[0].get(yn).send():n.it=e}}static get[t](){return wn}}function bn(e){const t=e.get(ae).get(pe);let n=e.element,r=!0;if(n!==t)for(;;){const e=n.parentNode;if(!e)return;const s=e[ze];if(s)return[s,r];if(e===t)return;r=!1,n=e}}const _n=new n("hierarchy-context",{byDefault:e=>function(e){const t=e.get(ae).get(mn),n=h(n=>{const r=s(),o=O().needs(n.supply),i=O().needs(n.supply),a=()=>{const t=bn(e);if(t){const[e,n]=t;r.it=e.get(vn),o.off(),n&&i.off()}else r.it=void 0};t.read({supply:o,receive:()=>e.connected&&a()}),r.read.consume(e=>e&&e.context.get(yn).on(a)).needs(i),r.read(n),e.whenOn({supply:n.supply,receive:(t,n)=>{a(),n.whenOff(()=>{Promise.resolve().then(()=>e.connected||(r.it=void 0))})}})}).share(),r=function(e){return new c(t=>e.keep.thru(e=>e?g(e.get(t)):f()))}(n),o=r.newValues();return new class extends vn{constructor(){super(...arguments),this.get=o.get}get context(){return e}get up(){return n}provide(e){return r.provide(e)}}}(e.get($e))});class vn extends e{static get[t](){return _n}}const xn=new n("component-node");class kn extends a{get[z](){return this.onUpdate}get[N](){return this.read}}const On={subtree:!0};function Dn(e,t,n,r,{deep:s,all:o}){const i=new P,u=s?On:void 0;let c,l,p=new Set;"string"==typeof n?l=n:e.whenDefined(n).then(({elementDef:{name:t}})=>{if(c=void 0,t&&(l=K.name(t,e.get(de)),i.size)){const e=S();if(e.size){const t=Array.from(b(w(e,e=>r(e)),_));t.length&&i.send(t,[])}}});const d=e.get(Xe)((function(e){const t=[],n=[];e.forEach(e=>{A(b(w(U(e.removedNodes),E),_),e=>n.push(e)),A(b(w(U(e.addedNodes),C),_),e=>t.push(e))}),(t.length||n.length)&&i.send(t,n)}));let g;const m=v(e=>{const n=!i.size,r=i.on(e);return n&&(S(),d.observe(t,u)),O(e=>{r.off(e),i.size||d.disconnect()}).needs(r)}),y=h(m.thru(()=>g),()=>[g]),x=m.thru((e,t)=>f(a.of(e),a.of(t))),k=h(e=>{const t=new P;t.on(e),t.send(g,a.of([])),x(e)}),D=B(y).keep.thru(e=>X(J(e)));o||t.addEventListener("wesib:component",e=>{const t=e.target;if(p.has(t)){const e=r(t);i.send([e],[])}});return g=new class extends kn{get onUpdate(){return m}get read(){return y}get track(){return k}get first(){return D}[Symbol.iterator](){return $(c||(c=b(w(i.size?p:S(),e=>r(e)),_)))}};function S(){return c=void 0,p=function(){const e=l;if(!e)return new Set;if(s)return new Set(U(t.querySelectorAll(e)));return new Set(b(U(t.children),t=>t.matches(e)))}()}function C(e){if(_e(e))return l&&e.matches(l)&&!p.has(e)?(p.add(e),r(e)):void 0}function E(e){if(_e(e)&&p.delete(e))return r(e,!0)}}class Sn{constructor(e,t){this._bs=e,this.element=t,this._emitters=new Map}get observer(){if(this._observer)return this._observer;const e=this._bs.get(he).MutationObserver;return this._observer=new e(e=>this._update(e))}observe(e,t){const n=this,r=this.observer,s=this._emitter(e),o=V(t),i=s.on({supply:O(()=>{this._emitters.delete(e),r.disconnect(),this._emitters.size?a():this._observer=void 0}).needs(o.supply),receive:(e,t,n)=>o.receive(e,t,n)});return r.disconnect(),a(),i;function a(){n._update(r.takeRecords()),r.observe(n.element,{attributes:!0,attributeOldValue:!0,attributeFilter:Array.from(n._emitters.keys())})}}_update(e){e.forEach(e=>{const t=e.attributeName,n=this._emitters.get(t);n&&n.send(this.element.getAttribute(t),e.oldValue)})}_emitter(e){const t=new P;return this._emitters.set(e,t),t}}class Cn extends D{constructor(e,t){super(),this._observer=e,this._name=t,this._updates=new P;let n=Z();this.on=v(e=>{this._updates.size||(n=this._observer.observe(t,(e,t)=>this._updates.send(e,t))),e.supply.needs(n),this._updates.on(e).whenOff(e=>{this._updates.size||n.off(e)})})}get[S](){return R(this._updates)}get it(){return this._observer.element.getAttribute(this._name)}set it(e){this._observer.element.setAttribute(this._name,e)}}class En{constructor(e,t){this._attrs=new Map,this._observer=new Sn(e,t)}get(e){const t=this._attrs.get(e);if(t)return t;const n=new Cn(this._observer,e);return this._attrs.set(e,n),n}}class Rn extends D{constructor(e,t){super(),this._element=e,this._key=t,this._updates=new P,this._supply=O()}get on(){return this._updates.on}get[S](){return this._supply}get it(){return this._element[this._key]}set it(e){this._element[this._key]=e}done(e){return this._supply.off(e),this}bind(e){const t=R(this),n=e.get(Wt).track(sn(this._key));t.needs(n.onUpdate({supply:O().whenOff(e=>this._updates.done(e)),receive:(e,t,n,r)=>this._updates.send(n,r)}).needs(t))}}class Pn{constructor(e){this._element=e,this._props=new Map}bind(e){this._context=e,this._props.forEach(t=>t.bind(e))}get(e){const t=this._props.get(e);if(t)return t;const n=new Rn(this._element,e);return this._context&&n.bind(this._context),this._props.set(e,n),n}}const jn=Symbol("element-node");class An{constructor(e,t){this._bs=e,this.element=t,this._attrs=new En(e,t),this._props=new Pn(t),t[jn]=this;const n=t[ze];n?this._bind(n):t.addEventListener("wesib:component",e=>this._bind(e.context))}get context(){return this.element[ze]}get parent(){const e=this.element.parentNode;return e&&Un(this._bs,e)}select(e,t){return function(e,t,n,r={}){if(r.all)return Dn(e,t,n,(t,n)=>Un(e,t,n),r);const s=e.get(Je);return Dn(e,t,n,(t,n)=>s(t)&&Un(e,t,n),r)}(this._bs,this.element,e,t)}attribute(e){return this._attrs.get(e)}property(e){return this._props.get(e)}_bind(e){this._props.bind(e)}}function Un(e,t,n){const r=t[jn];return r||n?r:new An(e,t)}const Tn={needs:Jt,setup(e){e.perComponent({a:xn,by:e=>Un(e.get(ae),e.element)})}};class Ln{static get[ke](){return Tn}}const Nn=new n("navigation");class qn{static get[t](){return Nn}get[z](){return this.on}get[N](){return this.read}back(){this.go(-1)}forward(){this.go(1)}reload(){this.go()}}const Mn=Symbol("page-param");class Kn{get[Mn](){return this}byDefault(e,t){}}class Bn extends e{}const In=new n("nav-history",{byDefault:ue(e=>new $n(e))});function zn(e){return null==e||"object"!=typeof e?{data:e}:e["wesib:navigation:data"]}class $n{constructor(e){this._context=e,this._entries=new Map,this._lastId=0;const t=e.get(he);this._document=t.document,this._location=t.location,this._history=t.history,this._uid=btoa(String(Math.random()))}static get[t](){return In}init(){const{data:e}=zn(this._history.state),t=this.newEntry({url:new URL(this._location.href),data:e,title:this._document.title});return this._entries.set(t.id,t),t.schedule(()=>{t.enter("init"),this._history.replaceState(this._historyState(t),"")}),t}newEntry(e){return new Vn(this._context,++this._lastId,e)}open(e,t){const{page:{title:n="",url:r}}=e;this._history.pushState(this._historyState(e),n,r.href),this._enter("open",e,t)}_enter(e,t,n){const r=n.it;this._entries.set(t.id,t);try{for(let e=r.next;e;e=e.next)this._forget(e)}finally{t.prev=r,r.next=t,t.schedule(()=>{try{r.leave()}finally{t.enter(e)}}),n.it=t}}replace(e,t){const n=t.it,{page:{title:r="",url:s}}=e;this._history.replaceState(this._historyState(e),r,s.href),this._entries.set(e.id,e);const o=n.prev;o&&(e.prev=o,o.next=e),e.schedule(()=>{try{n.leave()}finally{try{this._forget(n)}finally{e.enter("replace")}}}),t.it=e}popState(e,t){const{state:n}=e;if(null==n)return null==this._history.state?this._changeHash(t):void 0;const r=t.it,{uid:s,data:o,id:i}=zn(n);let a;const u=s===this._uid&&null!=i?this._entries.get(i):void 0;return u?a=u:(a=this.newEntry({url:new URL(this._location.href),data:o,title:this._document.title}),r.transfer(a,"return"),this._entries.set(a.id,a),this._history.replaceState(this._historyState(a),"")),a.schedule(()=>{try{r.leave()}finally{a.enter("return")}}),t.it=a,a}hashChange(e){if(null==this._history.state)return this._changeHash(e)}update(e,t){const n=e.it,r=new Vn(this._context,++this._lastId,Object.assign(Object.assign({},n.page),{url:t}),n);return this._entries.set(r.id,r),this._history.replaceState(this._historyState(r),"",t.href),this._entries.delete(n.id),e.it=r}_changeHash(e){const t=e.it,n=this.newEntry({url:new URL(this._location.href),data:null,title:this._document.title});try{t.transfer(n,"enter")}finally{this._history.replaceState(this._historyState(n),""),this._enter("enter",n,e)}return n}_forget(e){this._entries.delete(e.id),e.forget()}_historyState({id:e,page:{data:t}}){return{"wesib:navigation:data":{uid:this._uid,id:e,data:t}}}}class Vn{constructor(e,t,n,r){this._bsContext=e,this.id=t,this._status=0,this._update=C,this._params=r?r._params:new Map;const s=this;this.page={get url(){return n.url},get title(){return n.title},get data(){return n.data},get visited(){return!!s._status},get current(){return 2===s._status},get:e=>s.get(e),put(e,t){s.put(e,t)}}}get(e){const t=e[Mn],n=this._params.get(t);if(n)return n.get();const r=t.byDefault(this.page,this._newContext());return r&&this._init(t,r)}put(e,t){const n=e[Mn],r=this._params.get(n);return r?(r.put(t),r.get()):this._init(n,n.create(this.page,t,this._newContext()))}_newContext(){const e=new c(this._bsContext);return new class extends Bn{constructor(){super(...arguments),this.get=e.newValues().get}}}_init(e,t){return this._params.set(e,t),this.page.current&&t.enter&&t.enter(this.page,"init"),t.get()}transfer(e,t){A(this._params.entries(),([n,r])=>{if(r.transfer){const s=r.transfer(e.page,t);s&&e._params.set(n,s)}})}stay(e){A(this._params.values(),t=>t.stay&&t.stay(e))}enter(e){this._status=2,A(this._params.values(),t=>t.enter&&t.enter(this.page,e))}leave(){this._status=1,A(this._params.values(),e=>e.leave&&e.leave())}forget(){A(this._params.values(),e=>e.forget&&e.forget()),this._params.clear()}schedule(e){this._update=e}apply(){const e=this._update;this._update=C,e()}}class Fn extends l{constructor(e){super(e),this.upKey=this.createUpKey(e=>{const{document:t}=e.context.get(he);return e.seed.keep.thru((...n)=>{if(n.length)return X((function(e,r,s,o){return function o(i,a){const u=n[i];if(!u)return e(a);u(({url:e=a.url,title:n=a.title,data:r=a.data}=a)=>o(i+1,{url:new URL(String(e),t.baseURI),title:n,data:r,get visited(){return a.visited},get current(){return a.current},get:e=>a.get(e),put(e,t){a.put(e,t)}}),r,s,a)}(0,o)}));const r=()=>p(Hn);return g(e.byDefault(r)||r())})})}grow(e){let t;return e.context.get(this.upKey,"or"in e?{or:null!=e.or?p(e.or):e.or}:void 0)(e=>t=e),(e,n,r,s)=>t(e,n,r,s)}}function Hn(e,t,n,r){e(r)}const Qn=new Fn("navigation-agent");class Wn extends Event{constructor(e,t){super(e,Object.assign(Object.assign({},t),{cancelable:!1})),this.when=t.when,this.to=t.to}}class Gn extends Event{constructor(e,t){super(e,Object.assign(Object.assign({},t),{cancelable:!0})),this.when=t.when,this.from=t.from,this.to=t.to}}class Jn extends Event{constructor(e,t){super(e,Object.assign(Object.assign({},t),{cancelable:!0})),this.from=t.from,this.to=t.to,this.reason=t.reason}get when(){return"stay"}}function Xn(e){const t=e.get(he),{document:n,history:r}=t,o=new E(t),i=e.get($n),a=e.get(Qn),u=o.on("wesib:enterPage"),c=o.on("wesib:leavePage"),l=o.on("wesib:stayOnPage"),h=j(u,c,l),p=s(i.init());p.read(e=>e.apply());const d=p.read.keep.thru(e=>e.page);let f=Promise.resolve();o.on("popstate")(e=>{const t=i.popState(e,p);t&&o.dispatch(new Wn("wesib:enterPage",{when:null!=e.state?"return":"enter",to:t.page}))}),o.on("hashchange")(()=>{const e=i.hashChange(p);e&&o.dispatch(new Wn("wesib:enterPage",{when:"enter",to:e.page}))});return new class extends qn{get page(){return p.it.page}get length(){return r.length}get onEnter(){return u}get onLeave(){return c}get onStay(){return l}get on(){return h}get read(){return d}go(e){r.go(e)}open(e){return w("pre-open","open",e)}replace(e){return w("pre-replace","replace",e)}update(e){return i.update(p,g(e)).page}with(e,t){return function e(t){return{with:(n,r)=>e(be(t,e=>e.put(n,r))),open:e=>w("pre-open","open",e,t),replace:e=>w("pre-replace","replace",e,t),pretend(e,n=((e,t)=>t)){let r;"function"==typeof e?(n=e,r=void 0):r=e;const s=m(r),o=p.it,i=y("pretend",o,s,t);try{return b("pretend",o,s,i)?n(o.page,i.page):void 0}finally{i.stay(p.it.page)}}}}(n=>n.put(e,t))}};function g(e){return"string"==typeof e?new URL(e,n.baseURI):e||p.it.page.url}function m(e){return null==e||"string"==typeof e||e instanceof URL?{url:g(e)}:e.url instanceof URL?e:Object.assign(Object.assign({},e),{url:g(e.url)})}function w(e,t,n,r=C){const s=m(n),a=f=f.then(u,u);return a;function u(){let n=void 0;try{const u=function(){if(f!==a)return c();const t=p.it,n=y(e,t,s,r),i=new Gn("wesib:leavePage",{when:e,from:t.page,to:n.page});if(!o.dispatch(i)||f!==a||!b(e,t,s,n))return c(n);return n}();return u?(n=u,i[t](n,p),o.dispatch(new Wn("wesib:enterPage",{when:t,to:n.page})),n.page):u}catch(e){throw c(n,e),e}}function c(e,t){return e&&e.stay(p.it.page),o.dispatch(new Jn("wesib:stayOnPage",{from:p.it.page,to:s,reason:t})),null}}function y(e,t,n,r){const s=i.newEntry(n);try{t.transfer(s,e),r(s.page)}catch(e){throw s.stay(p.it.page),e}return s}function b(e,t,n,r){let s=!1;return a(({url:e,data:t,title:r})=>{s=!0,n.url=e,n.data=t,n.title=r},e,t.page,r.page),s}}const Yn={setup(e){e.provide({a:qn,by:Xn})}};class Zn{static get[ke](){return Yn}}const er={supply:C};function tr(e={}){const{select:t="a",pick:n={all:!0,deep:!0}}=e;return qe({feature:{needs:[Ln,Zn]},define(r){r.whenComponent(r=>{const s=function(e,t){const n=e.get(fe),{active:r=ar}=t,s=I.name(r,e.get(de)),o=t.activate?t.activate.bind(t):C;return e=>{const{element:t}=e.node,r=t[ir]||(t[ir]=n({node:t})),i=t=>{r(()=>((e,{node:t})=>{const n=t.element,{classList:r}=n;e?r.add(s):r.remove(s)})(t,e)),o(t,e)};let a;return i(!0),{node:e.node,supply(){const e=a=O(()=>{a===e&&i(!1)});return e}}}}(r,e),o=function(e){if(!e.weigh)return nr;return t=>{const n=e.weigh(t);if("number"==typeof n)return p(t.node,n);let r=B(n).keep.thru_(e=>f(t.node,e));return h(e=>{r({supply:O().needs(e.supply).whenOff(()=>{r=p(t.node,0),r(e)}),receive:e.receive.bind(e)})})}}(e),i=r.get(qn),a=r.get(xn);r.whenOn(e=>{let u=er;i.read.consume(e=>a.select(t,n).read.keep.thru_(t=>g(m(...t.map(t=>o({node:t,context:r,page:e}))))).consume((...t)=>{const n=function(e){let t,n=0;return e.forEach(([e,r])=>{r>n&&(n=r,t=e)}),t}(t);return n?n!==u.node&&(u=s({node:n,context:r,page:e})):u=er,u.supply()})).needs(e)})})}})}function nr({node:e,page:t}){const n=e.element,r=n.getAttribute("href");if(null==r)return p(e,-1);const s=new URL(r,n.ownerDocument.baseURI);return p(e,function e(t,n){if(t.origin!==n.origin)return-1;const r=rr(t),s=rr(n);if(t.hash)return r!==s?-1:or(t,n)<0||or(n,t)<0?-1:e(sr(t),sr(n));const o=or(t,n);if(o)return o<0?-1:r!==s?-1:o;if(!s.startsWith(r))return-1;return t.pathname.length}(s,t.url))}function rr(e){const t=e.pathname;return t.endsWith("/")?t:t+"/"}function sr(e){let{hash:t}=e;return t=t.substring(1),"/"!==t[0]&&(t="/"+t),new URL(t,e)}function or({searchParams:e},{searchParams:t}){let n=0;return e.forEach((r,s)=>{const o=new Set(t.getAll(s));n>=0&&(e.getAll(s).every(e=>o.has(e))?n+=1:n=-1)}),n}const ir=Symbol("nav-link-render-schedule"),ar=["active",ln];function ur(e={}){const t=e.handle?e.handle.bind(e):function(e){const t=e.href?e.href.bind(e):cr;return({event:e,page:n,navigation:r})=>{const s=t(e);if(null==s)return;const o=e.target,i=n.url,a=new URL(s,o.ownerDocument.baseURI);a.origin===i.origin&&(e.preventDefault(),i.href!==a.href&&r.open(s))}}(e),n=new me(e.event||"click");return qe({feature:{needs:Zn},define(e){e.whenComponent(e=>{e.whenOn(r=>{const s=e.get(qn);n.forEach(n=>{e.on(n)(n=>s.read.once(r=>t({event:n,page:r,context:e,navigation:s}))).needs(r)})})})}})}function cr(e){return e.target.getAttribute("href")}function lr(e,t){if(t.origin!==e.origin||t.username)return new URL("#"+t,e);const{pathname:n,search:r,hash:s}=t,o=new URL("",e);return o.hash=r||s||n.length>1?n+r+s:r+s,o}class hr extends Kn{create(e,t){let n;const r={get:()=>n,put(t){n="string"==typeof t?new URL(t,e.url.origin):t}};return r.put(t),r}}const pr=new hr;class dr extends Kn{create(e,t){const n={get(){return e.get(pr)||(t=e.url,new URL(t.hash.substring(1),t.origin));var t},put(t){e.put(pr,t)}};return n.put(t),n}byDefault(e){return this.create(e,null)}}const fr=new dr,gr={needs:Zn,setup(e){e.provide({a:Qn,is:wr})}};class mr{static get[ke](){return gr}}function wr(e,t,n,r){const s=r.get(pr);s?e({url:lr(r.url,s)}):e()}function yr(e,t,n,r=br){let s;"function"==typeof n?(r=n,s=null):s=n||null;const o=t.ownerDocument;if(_e(e)){const n=o.createElement(e.tagName.toLowerCase());return e.getAttributeNames().forEach(t=>n.setAttribute(t,e.getAttribute(t))),r(e,n),t.insertBefore(n,s),n}const i=o.importNode(e,!1);return t.insertBefore(i,s),i}function br(e,t){A(U(e.childNodes),e=>yr(e,t))}function _r(e){let t;return n=>{const r=function(e){return new URL("",e.url).href}(n);if(t){if(t.url===r)return t.on;t.sup.off()}let o;const i=O().whenOff(()=>{t=void 0,o=void 0}),a=v(t=>{if(!o){const t=e(n),r=s(),a=t(e=>{r.it=e}).whenOff(e=>{null!=e&&i.off(e)});i.whenOff(e=>{a.off(e),r.done(e)}),o={on:r.read.thru_(e=>e?f(e):y()),num:0}}const r=o;return++r.num,r.on(t).needs(i).whenOff(e=>{--r.num||Promise.resolve().then(()=>{r.num||r!==o||i.off(e)})})});return t={url:r,on:a,sup:i},a}}class vr extends Error{}const xr=new class extends Kn{create(e,t){return{get:()=>t,put:C}}};class kr{constructor(e,t){this._navigation=e,this._loader=t,this._map=new Map}get fragments(){const e=[];for(const t of this){if(!t.fragment)return[];e.push(t.fragment)}return e}[Symbol.iterator](){return $(L(this._map.values()))}handle(){const e=this,t=O();let n=Z();return{get(){},put(t){e._add(t)},transfer(t,n){if("pretend"===n)return;const r=e._transfer();return t.put(xr,r),r.handle()},enter(r,s){if("init"===s)return;n=O().needs(t);const o=v(t=>{const s=new P,o=s.on(t);return e._loader(r)(e=>s.send(e)).whenOff(e=>{void 0===e||e instanceof vr||s.send({ok:!1,page:r,error:e})}).needs(n),o}).share();A(e,({fragment:e,receiver:t})=>function(e,t){return t?e.thru_(e=>e.ok?Object.assign(Object.assign({},e),{fragment:(null!=t.tag?e.document.getElementsByTagName(t.tag)[0]:e.document.getElementById(t.id))||void 0}):e):e}(o,e)({supply:O().needs(t.supply),receive(e,n){t.receive(e,n)}}))},leave(){n.off(new vr("page left"))},stay(){t.off(new vr("navigation cancelled"))},forget(){t.off(new vr("page forgotten"))}}}_add(e){const t=Object.assign(Object.assign({},e),{receiver:V(e.receiver)}),{supply:n}=t.receiver,r=this._map.get(n);r?r.push(t):(this._map.set(n,[t]),n.whenOff(()=>this._map.delete(n)))}_transfer(){const e=new kr(this._navigation,this._loader);for(const[t,n]of this._map.entries())e._map.set(t,Array.from(n));return e}}const Or=new hn("page-load-agent"),Dr=new o("page-load-url",{byDefault:u(C)}),Sr=new n("page-loader",{byDefault:ue((function(e){const t=e.get(he),n=e.get(gn),s=e.get(Dr),o=e.get(Or),i=new t.DOMParser;return e=>{const t=new URL(e.url.href);s(t);const a=new Request(t.href,{mode:"same-origin",credentials:"same-origin",headers:new Headers({Accept:"text/html"})});return v(e=>o(u,a)(e));function u(s){return function(e,t){var n;const s=null===(n=e.get(xr))||void 0===n?void 0:n.fragments;s&&s.length&&t.headers.set("Accept-Fragment",r(s,(e,t)=>(e?e+", ":"")+(null!=t.tag?"tag="+W(t.tag):"id="+W(t.id)),""))}(e,s),v(r=>{const o=new F;o.on(r),o.send({page:e}),H(n(s).thru_(e=>Promise.all([e,e.text()]))).thru_((...e)=>Q(e),([n,r])=>{if(!n.ok)return{ok:!1,page:e,response:n,error:n.status};try{return{ok:!0,page:e,response:n,document:Cr(i,t,n,r)}}catch(t){return{ok:!1,page:e,response:n,error:t}}})(r)})}}}))});function Cr(e,t,n,r){const s=e.parseFromString(r,G(n.headers.get("Content-Type")||"text/html")[0].v);if(s.head){const e=s.head.querySelector("base");if(e)e.href=new URL(e.getAttribute("href"),t).href;else{const e=s.createElement("base");e.href=t.href,s.head.appendChild(e)}}return s}class Er extends Kn{create(e,t,n){const r=new kr(n.get(qn),_r(n.get(Sr))),s=r.handle();return e.put(xr,r),s.put(t),s}}const Rr=new Er,Pr=new n("page-cache-buster",{byDefault:ue(e=>new jr(e))});class jr{constructor(e){const t=Ar(e.get(he).document);if(t){const n=e.get(qn);this.urlModifier=p(e=>e.searchParams.set("__wesib_app_rev__",t)),this.agent=p((e,r)=>e(new Request(r.url,r)).thru_(e=>{if(e.ok){const r=Ar(e.document);if(r&&r!==t){const t=new URL(e.page.url.href);t.searchParams.set("__wesib_app_rev__",r),n.update(t),n.reload()}}return e}))}else this.urlModifier=p(),this.agent=p()}static get[t](){return Pr}}function Ar(e){var t;return null===(t=e.querySelector("meta[name=wesib-app-rev]"))||void 0===t?void 0:t.getAttribute("content")}function Ur(e){const t=e.get(he).document;return e=>e().thru_(e=>{if(e.ok){const n=new Set(w(Tr(t,U(t.scripts)),([e])=>e));A(b(Tr(e.document,U(e.document.querySelectorAll("script"))),([e])=>!n.has(e)),([e,r])=>{yr(r,t.head,(t,n)=>n.src=e),n.add(e)})}return e})}function Tr(e,t){return w(b(t,e=>!!e.src),t=>[new URL(t.src,e.baseURI).href,t])}function Lr(e){const t=e.get(he).document;return e=>e().thru_(e=>{if(!e.ok)return e;const n=e.document.querySelectorAll("link[rel=stylesheet]");if(!n.length)return e;let r=t.head,s=null;const o=t.querySelectorAll("link[rel=stylesheet]"),i=new Map,a=o.item(0);return a&&(r=a.parentNode,s=a,A(U(o),e=>i.set(new URL(e.href,t.baseURI).href,e))),A(U(n),e=>{const n=new URL(e.href,t.baseURI).href,o=i.get(n);o?(J(i.keys())===n?(r=o.parentNode,s=o.nextSibling):r.insertBefore(o,s),i.delete(n)):yr(e,r,s,(e,t)=>t.href=n)}),A(i.values(),e=>e.parentNode.removeChild(e)),e})}function Nr(e){const t=e.get(he).document;return e=>e().thru_(e=>{if(e.ok){const n=e.document.getElementsByTagName("title").item(0);n&&n.textContent&&(t.title=n.textContent)}return e})}const qr={needs:Zn,setup(e){e.provide({a:Dr,by:e=>e.urlModifier,with:[jr]}),e.provide({a:Or,by:e=>e.agent,with:[jr]}),e.provide({a:Or,by:Ur}),e.provide({a:Or,by:Lr}),e.provide({a:Or,by:Nr})}};class Mr{static get[ke](){return qr}}function Kr(e={}){const t=e.onResponse?e.onResponse.bind(e):C,n=e.contentKey?e.contentKey.bind(e):Br;return qe({feature:{needs:Mr},define(r){r.whenComponent(r=>{const s=r.get(he).document,o=r.get(fe)(),i=r.get(qn);let a=n(i.page);const u=()=>{const{fragment:t}=e;if(t)return t;const{element:{id:n,tagName:s}}=r;return n?{id:n}:{tag:s}};r.whenOn(e=>{const c=s.createRange();c.selectNodeContents(r.contentRoot),i.read.once(i=>{i.put(Rr,{fragment:u(),receiver:{supply:e,receive:(e,i)=>function(e){const i=n(e.page);if(i===a)return;if(!e.ok)return void o(()=>t({context:r,range:c,response:e}));a=i,o(()=>{c.deleteContents();const n=s.createDocumentFragment(),{fragment:o}=e;o&&(br(o,n),c.insertNode(n)),t({context:r,range:c,response:e})})}(i)}})})})})}})}function Br({url:e}){return new URL("",e).href}class Ir extends l{get upKey(){return this}constructor(){super("default-in-aspects")}grow(e){const n=e.context.get(de);return d({scheduler:e.context.get(fe[t].upKey),fns:e.seed}).keep.thru(({scheduler:[e],fns:t})=>re(...t,oe.to(e),se.to(n)))}}const zr=new Ir,$r=new te("input-from-control",{byDefault:()=>({})});function Vr(e,t){const n=e.get(vn).provide({a:$r,by:()=>({root:e,control:t})});return O(n).needs(t)}function Fr(e){return qe({define(t){t.whenComponent(t=>{const{up:n}=t.get(vn);d({parent:n.keep.thru_(e=>e?g(e.get($r)):X({})),aspects:t.get(zr)}).keep.thru_(({parent:[n],aspects:[r]})=>{if(n.control){const s=e({control:n,context:t,aspects:r});if(s)return s instanceof ee?f(s):g(s)}return f()}).consume((e,n)=>{if(!e)return;const r=Vr(t,e);return(n||R(e)).needs(r),r})})}})}const Hr=new te("input-to-form",{byDefault:()=>({})});function Qr(e){const{select:t="form",pick:n={deep:!0,all:!0}}=e;return qe({feature:{needs:Ln},define(r){r.whenComponent(r=>{const s=r.get(xn);r.whenOn(o=>{d({node:s.select(t,n).first,aspects:r.get(zr)}).keep.thru(({node:[t],aspects:[n]})=>{if(!t)return f();const s=e.makeForm({node:t,context:r,aspects:n});return s?Array.isArray(s)?f(...s):g(s):f()}).tillOff(o).consume((e,t,n)=>{if(!e)return;const s=function(e,t,n){const r=e.get(vn),s=r.provide({a:Hr,by:()=>({root:e,control:t,form:n})});return r.provide({a:$r,via:Hr}),O(s).needs(t).needs(n)}(r,e,t);return n?n.needs(s):(R(t).needs(s),R(e).needs(s)),s})})})}})}function Wr(e={}){const{cancel:t=!0}=e;return Qe(({get:e})=>({componentDef:{define(n){n.whenComponent(n=>{n.whenOn(r=>{const s=n.get(vn),{component:o}=n;s.get(Hr).consume(n=>{if(!n.control)return;const s=new E(n.form.element);R(s).needs(r);const i=s.on("submit");return(t?i.instead:i)(t=>e(o).call(o,n,t))})})})}}}))}function Gr(e){const t="string"==typeof e?u(p(e)):t=>{const n=e(t);return"string"==typeof n?p(n):n};return qe({define(e){e.whenComponent(e=>{const n=e.get(vn);d({group:n.up.keep.thru_(e=>e?g(e.get($r)):X({}),({control:e})=>e&&e.aspect(ne)),control:n.get($r),name:t(e)}).consume(({group:[e],control:[{control:t}],name:[n]})=>{if(null!=n&&e&&t&&e!==t)return e.controls.set(n,t)})})}})}function Jr(e){const{select:t="input",pick:n={deep:!0,all:!0}}=e;return qe({feature:{needs:Ln},define(r){r.whenComponent(r=>{const s=r.get(xn);r.whenOn(o=>{d({node:s.select(t,n).first,aspects:r.get(zr)}).keep.thru(({node:[t],aspects:[n]})=>{if(!t)return f();const s=e.makeControl({node:t,context:r,aspects:n});return s?s instanceof ee?f(s):g(s):f()}).tillOff(o).consume((e,t)=>{if(!e)return;const n=Vr(r,e);return(t||R(e)).needs(n),n})})})}})}export{Ft as A,he as B,qe as C,zr as D,Ee as F,gn as H,Hr as I,qn as N,Wr as O,Kn as P,cn as R,Gr as S,Jr as U,vn as a,ue as b,Fr as c,Ht as d,Ln as e,xn as f,Qr as g,Kr as h,tr as i,ur as j,de as k,Lt as l,fr as m,an as n,mr as o,Xt as t};//# sourceMappingURL=wesib.828181c2.js.map
