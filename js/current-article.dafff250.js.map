{"version":3,"file":"current-article.dafff250.js","sources":["../../src/pages/article/current-article.ts"],"sourcesContent":["import { SingleContextUpKey, SingleContextUpRef } from '@proc7ts/context-values/updatable';\nimport {\n  EventReceiver,\n  EventSupplier,\n  EventSupply,\n  EventSupply__symbol,\n  eventSupplyOf,\n  OnEvent,\n  onSupplied,\n  trackValue,\n  ValueTracker,\n} from '@proc7ts/fun-events';\nimport { Article } from '../../core/articles';\n\nexport interface UpdatableArticle extends Article {\n  update(article: Article): void;\n}\n\nexport interface NoArticle {\n  readonly slug?: undefined;\n}\n\nexport type CurrentArticle =\n    | UpdatableArticle\n    | NoArticle;\n\nexport const noArticle: NoArticle = {};\nexport const CurrentArticle: SingleContextUpRef<CurrentArticle> = (\n    /*#__PURE__*/ new SingleContextUpKey<CurrentArticle>(\n        'current-article',\n        {\n          byDefault: () => noArticle,\n        },\n    )\n);\n\nexport class CurrentArticleTracker extends ValueTracker<CurrentArticle> {\n\n  private readonly _it = trackValue<CurrentArticle>(noArticle);\n\n  get [EventSupply__symbol](): EventSupply {\n    return eventSupplyOf(this._it);\n  }\n\n  get it(): CurrentArticle {\n    return this._it.it;\n  }\n\n  set it(value: CurrentArticle) {\n    this._it.it = value;\n  }\n\n  on(): OnEvent<[CurrentArticle, CurrentArticle]>;\n  on(receiver: EventReceiver<[CurrentArticle, CurrentArticle]>): EventSupply;\n  on(\n      receiver?: EventReceiver<[CurrentArticle, CurrentArticle]>,\n  ): OnEvent<[CurrentArticle, CurrentArticle]> | EventSupply {\n    return (this.on = this._it.on().F)(receiver);\n  }\n\n  set(article: Article | NoArticle): void {\n    this.it = this.cast(article);\n  }\n\n  byArticles(source: EventSupplier<[Article | NoArticle]>): this {\n    return this.by(onSupplied(source).thru_(article => this.cast(article)));\n  }\n\n  cast(article: Article | NoArticle): CurrentArticle {\n    return article.slug\n        ? {\n          ...article,\n          update: updated => this.set(updated),\n        }\n        : noArticle;\n  }\n\n}\n"],"names":["noArticle","CurrentArticle","SingleContextUpKey","byDefault","CurrentArticleTracker","ValueTracker","[object Object]","this","trackValue","EventSupply__symbol","eventSupplyOf","_it","it","value","receiver","on","F","article","cast","source","by","onSupplied","thru_","slug","update","updated","set"],"mappings":"gJA0BaA,EAAuB,GACvBC,MACSC,EACd,kBACA,CACEC,UAAW,IAAMH,UAKdI,UAA8BC,EAA3CC,kCAEmBC,SAAMC,EAA2BR,GAElDS,IAAKA,KACH,OAAOC,EAAcH,KAAKI,KAG5BC,SACE,OAAOL,KAAKI,IAAIC,GAGlBA,OAAOC,GACLN,KAAKI,IAAIC,GAAKC,EAKhBP,GACIQ,GAEF,OAAQP,KAAKQ,GAAKR,KAAKI,IAAII,KAAKC,GAAGF,GAGrCR,IAAIW,GACFV,KAAKK,GAAKL,KAAKW,KAAKD,GAGtBX,WAAWa,GACT,OAAOZ,KAAKa,GAAGC,EAAWF,GAAQG,OAAML,GAAWV,KAAKW,KAAKD,MAG/DX,KAAKW,GACH,OAAOA,EAAQM,KACT,IACGN,EACHO,OAAQC,GAAWlB,KAAKmB,IAAID,IAE5BzB"}