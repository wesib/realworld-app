import{A as t,j as e,a as n}from"../lib/a-iterable.a3fddd20.js";import{F as s}from"../lib/context-values.eef19512.js";import{c as o}from"../lib/namespace-aliaser.535f16ce.js";import{n as i,R as a,C as r,B as l,b as d,l as u,d as c,o as p,p as h,q as m,r as f,k as v,c as g}from"../wesib/wesib.1043e62e.js";import{_ as b}from"../helpers.920c7f83.js";import{a as _}from"../wesib/generic.8eaae636.js";import{D as x}from"../lib/delta-set.6d49064b.js";import{A as y}from"../lib/input-aspects.bb07caa0.js";import{C as E}from"../core.f6946162.js";let C=class{constructor(t){this._context=t}render(){const{document:t}=this._context.get(l),e=t.createRange();return e.selectNodeContents(this._context.contentRoot),()=>{e.deleteContents(),null!=this.loadError&&e.insertNode(t.createTextNode(this.loadError))}}};b([i("load-error")],C.prototype,"loadError",void 0),b([a()],C.prototype,"render",null),C=b([r(["loader",E])],C);const S=new s("api-error-generator",{byDefault:d(n=>{const s=n.get(l).document;return n=>{let o;return t.from(e(n)).forEach(([t,e])=>{o||(o=s.createElement("ul"),o.classList.add("error-messages"));const n=o;e.forEach(e=>{const o=s.createElement("li");o.innerText=`${t} ${e}`,n.appendChild(o)})}),o}})}),A=new Intl.DateTimeFormat("en-US",{month:"long",day:"numeric"}),k=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"numeric"});function w(t){return((new Date).getFullYear()===t.getFullYear()?A:k).format(t)}function R(t={}){return u(({get:e,key:n})=>{const{comment:s=String(n),path:o,offline:i}=t;return{componentDef:a({path:o,offline:i}).As((function(){const t=c.of(this),{document:n}=t.get(l),{contentRoot:o}=t,i=o.appendChild(n.createComment(`[${s}[`)),a=o.appendChild(n.createComment(`]${s}]`)),r=n.createRange();return r.setStartAfter(i),r.setEndBefore(a),()=>{r.deleteContents();const t=e(this).call(this);if(t)if("string"==typeof t){const e=n.createElement("template");e.innerHTML=t,r.insertNode(e.content)}else r.insertNode(t)}}),n)}})}const D=Symbol("paging-info");function N(){return u(({get:t,set:e,key:n})=>{const s=[D,n];return{componentDef:p.all(R({path:s,comment:`PAGER(${String(n)})`}).As((function(){const e=c.of(this),{document:n}=e.get(l),s=t(this);if(!s.totalPages||s.totalPages<=1)return;const o=s,{totalPages:i,visiblePages:a=5,currentPage:r=0}=o,d=Math.max(1,a),u=Math.max(0,r),p=n.createElement("ul");p.className="pagination";let h=Math.max(0,u-(d>>1)),m=h+d;m>i&&(h=Math.max(0,h-(m-i)),m=i);p.appendChild(f("<<",0,u>0)),p.appendChild(f("<",u-1,u>0));for(let t=h;t<m;++t)p.appendChild(f(String(t+1),t,!0,u===t));return p.appendChild(f(">",u+1,u+1<i)),p.appendChild(f(">>",i-1,u+1<i)),p;function f(t,e,s,i=!1){const a=n.createElement("li");let r;return a.className="page-item",s&&!i?(r=n.createElement("a"),r.setAttribute("href",o.pageHref(e))):(a.classList.add(i?"active":"disabled"),r=n.createElement("span")),r.className="page-link",r.innerHTML=t,a.appendChild(r),a}}),n),_()),get:t,set(n,o){const i=t(n);e(n,o),c.of(n).updateState(s,o,i)}}})}class j extends CustomEvent{}const B=/\s$/;let M=class{constructor(t){this._context=t,this._values=new x}get input(){if(this._input)return this._input;const{element:t}=this._context;return this._input=t.querySelector("input"),this._input.onblur=this._input.onchange=this._handleBlur.bind(this),this._input.oninput=this._handleInput.bind(this),this._input.onkeydown=this._handleKeydown.bind(this),this._input}get datalist(){if(this._datalist)return this._datalist;const{element:t}=this._context;return this._datalist=t.querySelector("datalist"),this._datalist}get values(){return Array.from(this._values)}set values(t){this._values.clear(),this._values.delta(t||[])}get readonly(){return this.input.disabled||this.input.readOnly}setDisabled(t){null!=t?this.input.setAttribute("disabled",t):this.input.removeAttribute("disabled")}setReadonly(t){null!=t?this.input.setAttribute("readonly",t):this.input.removeAttribute("readonly")}render(){const{contentRoot:t,element:e}=this._context,{document:s}=this._context.get(l);t.innerHTML="<style>\n:host {\n  border: var(--multi-input-border, 1px solid #ddd);\n  display: block;\n  overflow: hidden;\n  padding: 5px;\n}\n/* NB use of pointer-events to only allow events from the \xd7 icon */\n::slotted(div.item) {\n  background-color: var(--multi-input-item-bg-color, #dedede);\n  border: var(--multi-input-item-border, 1px solid #ccc);\n  border-radius: 2px;\n  color: #222;\n  display: inline-block;\n  font-size: var(--multi-input-item-font-size, 14px);\n  margin: 5px;\n  padding: 2px 25px 2px 5px;\n  pointer-events: none;\n  position: relative;\n  top: -1px;\n}\n/* NB pointer-events: none above */\n::slotted(div.item:hover) {\n  background-color: #eee;\n  color: black;\n}\n::slotted(input) {\n  border: none;\n  font-size: var(--multi-input-input-font-size, 14px);\n  outline: none;\n  padding: 10px 10px 10px 5px;\n}\n</style>\n<slot></slot>",e.insertBefore(s.createComment("[ITEMS["),this.input);const o=e.insertBefore(s.createComment("]ITEMS]"),this.input),i=t=>{const e=t+" ";for(const t of n(this.datalist.options))if(t.value===e)return t},a=t=>{for(const s of n(e.querySelectorAll(".item")))if(s.textContent===t)return s};return()=>{this._values.redelta({add:t=>{var n;if(!a(t)){const n=s.createElement("div");n.className="item",n.textContent=t,n.onclick=()=>{this.readonly||this._delete(t)},e.insertBefore(n,o)}null===(n=i(t))||void 0===n||n.remove()},delete:t=>{var e;if(null===(e=a(t))||void 0===e||e.remove(),!i(t)){const e=s.createElement("option");e.value=t+" ",this.datalist.appendChild(e)}}}).undelta()}}_add(t,e=!1){(e||B.test(t))&&(t=t.trim())&&(this._values.add(t),this.input.value="",this._sendEvent())}_delete(t){this._values.delete(t),this._sendEvent()}_handleBlur(){const{value:t}=this.input;this.input.value="",this._add(t,!0)}_handleInput(){this._add(this.input.value)}_handleKeydown(t){if(this.input.value||"Backspace"!==t.key)this._add(this.input.value);else{const{values:t}=this;t.length&&this._delete(t[t.length-1])}}_sendEvent(){this._context.updateState(v("values"),this.values,this.values),this._context.dispatchEvent(new j("conduit:input",{bubbles:!0,detail:this.values}))}};b([h()],M.prototype,"values",null),b([m("disabled")],M.prototype,"setDisabled",null),b([m("readonly")],M.prototype,"setReadonly",null),b([a()],M.prototype,"render",null),M=b([r(["multi-input",E]),f()],M);class L extends y{constructor(t,{aspects:e}={}){super(t,{aspects:e,get:()=>t.values,set:e=>t.values=e})}listenForInput(t){this.events.on("conduit:input")(e=>{t({event:e,value:e.detail})})}}function T(t,{aspects:e}={}){return new L(t,{aspects:e})}const $=Symbol("load-status"),I=["loaded",E];function F(t={}){return u(({get:e,set:n,key:s})=>{const{path:i=[$,s],offline:r,loaded:l=I,comment:d=String(s)}=t;let u;return{componentDef:p.all({feature:{needs:C},define(t){u=o.name(l,t.get(g))}},a({path:i,offline:r}).As((function(){const{element:t}=c.of(this);return n=>{const s=e(this);s&&s.ok?n.postpone(()=>{t.classList.add(u)}):t.classList.remove(u)}}),s),R({path:i,offline:r,comment:`LOADER(${d})`}).As((function(){return e(this)?void 0:document.createElement("conduit-loader")}),s),R({path:i,offline:r,comment:`ERRORS(${d})`}).As((function(){const t=e(this);return t&&!t.ok?c.of(this).get(S)(t.errors):void 0}),s)),get:e,set(t,s){const o=e(t);n(t,s),c.of(t).updateState(i,s,o)}}})}export{C as L,M,R,F as a,N as b,w as f,T as i};//# sourceMappingURL=loader.ff943207.js.map
