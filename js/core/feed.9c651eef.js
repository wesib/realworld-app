import{a as t}from"../proc7ts/primitives.e0fbf82a.js";import{i as s,t as a}from"../proc7ts/push-iterator.38276a56.js";import{a as e}from"../proc7ts/context-values.1da2f733.js";import{a as r,b as o,n as i}from"../proc7ts/call-thru.3702f6af.js";import{e as c,c as p,f as n}from"../proc7ts/fun-events.fad06cca.js";import{F as f}from"../wesib/wesib.5f0eb508.js";import{_ as h}from"../helpers.e1623395.js";import{A as l}from"./api.4a1540c7.js";const d=["feed","tag","author","favorited","limit","offset"];function m(t,s){return d.every((a=>t[a]===s[a]))}function u(t){const e=new URLSearchParams;return s(a(d,(t=>"feed"!==t?t:r),(s=>{const a=t[s];return a?[s,String(a)]:r})),(([t,s])=>e.set(t,s))),e}const g={articles:[],articlesCount:0},j=new e("feed-service"),b={"/personal-feed":{path:"articles/feed",auth:!0},"/global-feed":{path:"articles"}};class v{constructor(t){this._apiFetch=t.get(l)}articles(s){const{path:a,auth:e}=b[s.feed||"/global-feed"],r={path:`${a}?${u(s)}`,init:{method:"GET",headers:{Accept:"application/json"}},auth:e,respondAs:t};return this._apiFetch(r)}tags(t){let s;return(this.tags=c((t=>{if(!s){const t={path:"tags",init:{method:"GET",headers:{Accept:"application/json"}},respondAs:"tags",auth:!1},a=this._apiFetch(t).thru_((t=>t.ok?o(t.body):(console.error("Failed to load tags",t.errors),o([])))),e=p(n(a,(()=>[])));s=e.read().thru_((t=>t?i(...t):r))}s.to(t)})).F)(t)}}let F=class{};F=h([f({setup(t){t.provide({a:j,as:v})}})],F);export{F,j as a,m as b,u as f,g as n};//# sourceMappingURL=feed.9c651eef.js.map
