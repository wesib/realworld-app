import{c as e}from"../frontmeans/namespace-aliaser.e08188c9.js";import{s as t}from"../proc7ts/fun-events.f7c44dc9.js";import{n as s,b as n,D as o}from"./auth.e0c9460a.js";import{C as r,B as a,S as c,R as i,l,F as d}from"../wesib/wesib.acbfb4f5.js";import{_ as m}from"../helpers.e1623395.js";import{e as u,A as p,d as h}from"../wesib/generic.5b4ac940.js";import{C as f}from"../core.c152f8fe.js";import{L as g}from"./loader.57d9ca02.js";let C=class{};C=m([r(["main",f],{feature:{needs:g}},u({onResponse({context:e,response:t,range:s}){if(!t.ok){s.deleteContents();const{document:n}=e.get(a),o=n.createElement("conduit-loader");null!=t.ok&&o.setAttribute("load-error",`Error. ${String(t.error)}`),s.insertNode(o)}}}))],C);let b=class{constructor(e){this._context=e,this.user=s;e.get(n).user.do(t(e))((e=>this.user=e)).whenOff((()=>this.user=s))}render(){const e=this._context.get(n),{document:t}=this._context.get(a),{element:s}=this._context,r=s.querySelector("ul"),c=t.createRange();return c.setStartAfter(r.appendChild(t.createComment("[USER-NAV["))),c.setEndBefore(r.appendChild(t.createComment("]USER-NAV]"))),()=>{c.deleteContents();const{username:t}=this.user;if(t){const s=i("","ion-log-out","");new o(s).on("click")((()=>{e.logout()})),c.insertNode(s),c.insertNode(i(t,"ion-person",`profile/#/${encodeURIComponent(t)}`))}};function i(e,s,n){const o=t.createElement("li");o.className="nav-item";const r=o.appendChild(t.createElement("a"));r.className="nav-link",r.setAttribute("href",n);return r.appendChild(t.createElement("i")).className=s,r.append(" ",e),o}}};m([c()],b.prototype,"user",void 0),m([i()],b.prototype,"render",null),b=m([r(["navbar",f],h(),p({active:"active"}))],b);const v=["authenticated",f],x=["not-authenticated",f];let j=class{constructor(e){this._context=e,this.auth={},e.get(n).authentication.do(t(e))((e=>this.auth=e))}render(){const t=this._context.get(l),s=e.name(v,t),n=e.name(x,t),{classList:o}=this._context.element;return()=>{this.auth.token?(o.remove(n),o.add(s)):(o.remove(s),o.add(n))}}};m([c()],j.prototype,"auth",void 0),m([i()],j.prototype,"render",null),j=m([r({name:["container",f],feature:{needs:[C,b]}})],j);let E=class{};E=m([r(["footer",f],h())],E);let N=class{};N=m([d({needs:[j,E]})],N);export{N as C};//# sourceMappingURL=layout.3dca3b65.js.map
