import{b as t,a as e,c as s,n as a}from"../proc7ts/call-thru.e7e5dff6.js";import{i as r,t as o}from"../proc7ts/a-iterable.fa56751f.js";import{a as i}from"../proc7ts/context-values.d3464e6e.js";import{e as c,c as n,f as p}from"../proc7ts/fun-events.f641f321.js";import{F as f}from"../wesib/wesib.3e2b94f7.js";import{_ as h}from"../helpers.e1623395.js";import{A as l}from"./api.92ef7c4d.js";const d=["feed","tag","author","favorited","limit","offset"];function u(t,e){return d.every(s=>t[s]===e[s])}function m(e){const s=new URLSearchParams;return r(o(d,e=>"feed"!==e?e:t,s=>{const a=e[s];return a?[s,String(a)]:t}),([t,e])=>s.set(t,e)),s}const g={articles:[],articlesCount:0},b=new i("feed-service"),j={"/personal-feed":{path:"articles/feed",auth:!0},"/global-feed":{path:"articles"}};class F{constructor(t){this._apiFetch=t.get(l)}articles(t){const{path:s,auth:a}=j[t.feed||"/global-feed"],r={path:`${s}?${m(t)}`,init:{method:"GET",headers:{Accept:"application/json"}},auth:a,respondAs:e};return this._apiFetch(r)}tags(e){let r;return(this.tags=c(e=>{if(!r){const e={path:"tags",init:{method:"GET",headers:{Accept:"application/json"}},respondAs:"tags",auth:!1},o=this._apiFetch(e).thru_(t=>t.ok?s(t.body):(console.error("Failed to load tags",t.errors),s([]))),i=n(p(o,()=>[]));r=i.read().thru_(e=>e?a(...e):t)}r.to(e)}).F)(e)}}let v=(()=>{let t=class{};return t=h([f({setup(t){t.provide({a:b,as:F})}})],t),t})();export{v as F,b as a,u as b,m as f,g as n};//# sourceMappingURL=feed.ff4126c4.js.map
