{"version":3,"file":"layout.0f815e59.js","sources":["../../../src/core/layout/main.component.ts","../../../src/core/layout/navbar.component.ts","../../../src/core/layout/container.component.ts","../../../src/core/layout/footer.component.ts","../../../src/core/layout/conduit-layout-support.feature.ts"],"sourcesContent":["import { IncludePage } from '@wesib/generic';\nimport { BootstrapWindow, Component } from '@wesib/wesib';\nimport { LoaderComponent } from '../loader';\nimport { Conduit__NS } from '../conduit.ns';\n\n@Component(\n    ['main', Conduit__NS],\n    {\n      feature: {\n        needs: LoaderComponent,\n      },\n    },\n    IncludePage({\n      onResponse({ context, response, range }) {\n        if (!response.ok) {\n          range.deleteContents();\n\n          const { document } = context.get(BootstrapWindow);\n          const loader = document.createElement('conduit-loader');\n\n          if (response.ok != null) {\n            loader.setAttribute('load-error', `Error. ${String(response.error)}`);\n          }\n\n          range.insertNode(loader);\n        }\n      },\n    }),\n)\nexport class MainComponent {}\n","import { ActivateNavLink, HandleNavLinks } from '@wesib/generic';\nimport { BootstrapWindow, Component, ComponentContext, ElementRenderer, Render, StateProperty } from '@wesib/wesib';\nimport { DomEventDispatcher } from 'fun-events/dom';\nimport { AuthService, AuthUser, notAuthenticated, NotAuthenticated } from '../auth';\nimport { Conduit__NS } from '../conduit.ns';\n\n@Component(\n    ['navbar', Conduit__NS],\n    HandleNavLinks(),\n    ActivateNavLink({ active: 'active' }),\n)\nexport class NavbarComponent {\n\n  @StateProperty()\n   user: AuthUser | NotAuthenticated = notAuthenticated;\n\n  constructor(private readonly _context: ComponentContext) {\n\n    const authService = _context.get(AuthService);\n\n    _context.whenOn(supply => {\n      authService.user\n          .tillOff(supply)(user => this.user = user)\n          .whenOff(() => this.user = notAuthenticated);\n    });\n  }\n\n  @Render()\n  render(): ElementRenderer {\n\n    const authService = this._context.get(AuthService);\n    const { document } = this._context.get(BootstrapWindow);\n    const { element }: { element: Element } = this._context;\n    const ul = element.querySelector('ul')!;\n    const range = document.createRange();\n\n    range.setStartAfter(ul.appendChild(document.createComment('[USER-NAV[')));\n    range.setEndBefore(ul.appendChild(document.createComment(']USER-NAV]')));\n\n    return () => {\n      range.deleteContents();\n\n      const { username } = this.user;\n\n      if (username) {\n\n        const logout = createItem('', 'ion-log-out', '');\n\n        new DomEventDispatcher(logout).on('click')(() => {\n          authService.logout();\n        });\n        range.insertNode(logout);\n        range.insertNode(createItem(username, 'ion-person', `profile/#/${encodeURIComponent(username)}`));\n      }\n    };\n\n    function createItem(label: string, icon: string, href: string): HTMLLIElement {\n\n      const item = document.createElement('li');\n\n      item.className = 'nav-item';\n\n      const a = item.appendChild(document.createElement('a'));\n\n      a.className = 'nav-link';\n      a.setAttribute('href', href);\n\n      const i = a.appendChild(document.createElement('i'));\n\n      i.className = icon;\n      a.append(' ', label);\n\n      return item;\n    }\n  }\n\n}\n","import {\n  Component,\n  ComponentContext,\n  DefaultNamespaceAliaser,\n  ElementRenderer,\n  Render,\n  StateProperty,\n} from '@wesib/wesib';\nimport { css__naming, QualifiedName } from 'namespace-aliaser';\nimport { Authentication, AuthService } from '../auth';\nimport { Conduit__NS } from '../conduit.ns';\nimport { MainComponent } from './main.component';\nimport { NavbarComponent } from './navbar.component';\n\nconst authenticatedClassQName: QualifiedName = ['authenticated', Conduit__NS];\nconst notAuthenticatedClassQName: QualifiedName = ['not-authenticated', Conduit__NS];\n\n@Component({\n  name: ['container', Conduit__NS],\n  feature: {\n    needs: [MainComponent, NavbarComponent],\n  },\n})\nexport class ContainerComponent {\n\n  @StateProperty()\n  auth: Authentication = {};\n\n  constructor(private readonly _context: ComponentContext) {\n    _context.whenOn(connectSupply => {\n      _context.get(AuthService).authentication.tillOff(connectSupply)(auth => {\n        this.auth = auth;\n      });\n    });\n  }\n\n  @Render()\n  render(): ElementRenderer {\n\n    const nsAlis = this._context.get(DefaultNamespaceAliaser);\n    const authenticatedClass = css__naming.name(authenticatedClassQName, nsAlis);\n    const notAuthenticatedClass = css__naming.name(notAuthenticatedClassQName, nsAlis);\n    const { classList }: Element = this._context.element;\n\n    return () => {\n      if (this.auth.token) {\n        classList.remove(notAuthenticatedClass);\n        classList.add(authenticatedClass);\n      } else {\n        classList.remove(authenticatedClass);\n        classList.add(notAuthenticatedClass);\n      }\n    };\n  }\n\n}\n","import { HandleNavLinks } from '@wesib/generic';\nimport { Component } from '@wesib/wesib';\nimport { Conduit__NS } from '../conduit.ns';\n\n@Component(\n    ['footer', Conduit__NS],\n    HandleNavLinks(),\n)\nexport class FooterComponent {\n}\n","import { Feature } from '@wesib/wesib';\nimport { ContainerComponent } from './container.component';\nimport { FooterComponent } from './footer.component';\n\n@Feature({\n  needs: [\n    ContainerComponent,\n    FooterComponent,\n  ],\n})\nexport class ConduitLayoutSupport {\n}\n"],"names":["MainComponent","Component","Conduit__NS","feature","needs","LoaderComponent","IncludePage","[object Object]","context","response","range","ok","deleteContents","document","get","BootstrapWindow","loader","createElement","setAttribute","String","error","insertNode","NavbarComponent","_context","this","notAuthenticated","authService","AuthService","whenOn","supply","user","tillOff","whenOff","element","ul","querySelector","createRange","setStartAfter","appendChild","createComment","setEndBefore","username","logout","createItem","DomEventDispatcher","on","encodeURIComponent","label","icon","href","item","className","a","append","__decorate","StateProperty","Render","HandleNavLinks","ActivateNavLink","active","authenticatedClassQName","notAuthenticatedClassQName","ContainerComponent","connectSupply","authentication","auth","nsAlis","DefaultNamespaceAliaser","authenticatedClass","css__naming","name","notAuthenticatedClass","classList","token","remove","add","FooterComponent","ConduitLayoutSupport","Feature"],"mappings":"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"}