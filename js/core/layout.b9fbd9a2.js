import{c as e}from"../frontmeans/namespace-aliaser.e08188c9.js";import{s as t}from"../proc7ts/fun-events.26e814e4.js";import{D as s}from"../frontmeans/dom-events.272f64a1.js";import{C as o,B as n,S as r,R as a,l as i,F as c}from"../wesib/wesib.a2d60763.js";import{_ as l}from"../helpers.e1623395.js";import{n as m,b as d}from"./auth.81df9cb2.js";import{e as p,A as u,d as f}from"../wesib/generic.fb9d31ab.js";import{C as h}from"../core.c152f8fe.js";import{L as g}from"./loader.d22f956e.js";let C=class{};C=l([o(["main",h],{feature:{needs:g}},p({onResponse({context:e,response:t,range:s}){if(!t.ok){s.deleteContents();const{document:o}=e.get(n),r=o.createElement("conduit-loader");null!=t.ok&&r.setAttribute("load-error",`Error. ${String(t.error)}`),s.insertNode(r)}}}))],C);let v=class{constructor(e){this._context=e,this.user=m;e.get(d).user.do(t(e))((e=>this.user=e)).whenOff((()=>this.user=m))}render(){const e=this._context.get(d),{document:t}=this._context.get(n),{element:o}=this._context,r=o.querySelector("ul"),a=t.createRange();return a.setStartAfter(r.appendChild(t.createComment("[USER-NAV["))),a.setEndBefore(r.appendChild(t.createComment("]USER-NAV]"))),()=>{a.deleteContents();const{username:t}=this.user;if(t){const o=i("","ion-log-out","");new s(o).on("click")((()=>{e.logout()})),a.insertNode(o),a.insertNode(i(t,"ion-person",`profile/#/${encodeURIComponent(t)}`))}};function i(e,s,o){const n=t.createElement("li");n.className="nav-item";const r=n.appendChild(t.createElement("a"));r.className="nav-link",r.setAttribute("href",o);return r.appendChild(t.createElement("i")).className=s,r.append(" ",e),n}}};l([r()],v.prototype,"user",void 0),l([a()],v.prototype,"render",null),v=l([o(["navbar",h],f(),u({active:"active"}))],v);const b=["authenticated",h],j=["not-authenticated",h];let x=class{constructor(e){this._context=e,this.auth={},e.get(d).authentication.do(t(e))((e=>this.auth=e))}render(){const t=this._context.get(i),s=e.name(b,t),o=e.name(j,t),{classList:n}=this._context.element;return()=>{this.auth.token?(n.remove(o),n.add(s)):(n.remove(s),n.add(o))}}};l([r()],x.prototype,"auth",void 0),l([a()],x.prototype,"render",null),x=l([o({name:["container",h],feature:{needs:[C,v]}})],x);let E=class{};E=l([o(["footer",h],f())],E);let N=class{};N=l([c({needs:[x,E]})],N);export{N as C};//# sourceMappingURL=layout.b9fbd9a2.js.map
