import{g as t}from"../wesib/generic.e05bd5a6.js";import{A as e,R as n,C as s,B as o,a as i,c as r,d as a,e as l,f as d,g as u,D as c,h as p,i as h,j as m,k as f}from"../wesib/wesib.289eabae.js";import"../proc7ts/workbench.31425b55.js";import{c as v}from"../frontmeans/namespace-aliaser.9467f14d.js";import{F as g}from"../proc7ts/context-values.cc32b8c5.js";import{o as _,a as b}from"../proc7ts/push-iterator.039597c5.js";import{C as x}from"../core.10059585.js";import{_ as y}from"../helpers.e1623395.js";import{A as E}from"../frontmeans/input-aspects.e72f213f.js";import{D as C}from"../proc7ts/delta-set.d5d9e832.js";let S=class{constructor(t){this._context=t}render(){const{document:t}=this._context.get(o),e=t.createRange();return e.selectNodeContents(this._context.contentRoot),()=>{e.deleteContents(),null!=this.loadError&&e.insertNode(t.createTextNode(this.loadError))}}};y([e("load-error")],S.prototype,"loadError",void 0),y([n()],S.prototype,"render",null),S=y([s(["loader",x])],S);const w=new g("api-error-generator",{byDefault:i((t=>{const e=t.get(o).document;return t=>{let n;for(const[s,o]of _(t)){n||(n=e.createElement("ul"),n.classList.add("error-messages"));const t=n;o.forEach((n=>{const o=e.createElement("li");o.innerText=`${s} ${n}`,t.appendChild(o)}))}return n}}))}),k=new Intl.DateTimeFormat("en-US",{month:"long",day:"numeric"}),A=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"numeric"});function R(t){return((new Date).getFullYear()===t.getFullYear()?k:A).format(t)}function D(t={}){return r((({get:e,key:s})=>{const{comment:i=String(s),render:r}=t;return{componentDef:n(r).As((function(){const t=a.of(this),{document:n}=t.get(o),{contentRoot:s}=t,r=s.appendChild(n.createComment(`[${i}[`)),l=s.appendChild(n.createComment(`]${i}]`)),d=n.createRange();return d.setStartAfter(r),d.setEndBefore(l),()=>{d.deleteContents();const t=e(this).call(this);if(t)if("string"==typeof t){const e=n.createElement("template");e.innerHTML=t,d.insertNode(e.content)}else d.insertNode(t)}}),s)}}))}const j=Symbol("paging-info");function N(e={}){const{render:n}=e;return r((({get:e,set:s,key:i})=>{const r=[u,j,i],c=l.fulfill({on:r},n);return{componentDef:d.all(D({render:c,comment:`PAGER(${String(i)})`}).As((function(){const t=a.of(this),{document:n}=t.get(o),s=e(this);if(!s.totalPages||s.totalPages<=1)return;const i=s,{totalPages:r,visiblePages:l=5,currentPage:d=0}=i,u=Math.max(1,l),c=Math.max(0,d),p=n.createElement("ul");p.className="pagination";let h=Math.max(0,c-(u>>1)),m=h+u;m>r&&(h=Math.max(0,h-(m-r)),m=r);p.appendChild(f("<<",0,c>0)),p.appendChild(f("<",c-1,c>0));for(let t=h;t<m;++t)p.appendChild(f(String(t+1),t,!0,c===t));return p.appendChild(f(">",c+1,c+1<r)),p.appendChild(f(">>",r-1,c+1<r)),p;function f(t,e,s,o=!1){const r=n.createElement("li");let a;return r.className="page-item",s&&!o?(a=n.createElement("a"),a.setAttribute("href",i.pageHref(e))):(r.classList.add(o?"active":"disabled"),a=n.createElement("span")),a.className="page-link",a.innerHTML=t,r.appendChild(a),r}}),i),t()),get:e,set(t,n){const o=e(t);s(t,n),a.of(t).updateState(r,n,o)}}}))}class B extends CustomEvent{}const M=/\s$/;let L=class{constructor(t){this._context=t,this._set=new C,this._list=null}get input(){if(this._input)return this._input;const{element:t}=this._context;return this._input=t.querySelector("input"),this._input.onblur=this._input.onchange=this._handleBlur.bind(this),this._input.oninput=this._handleInput.bind(this),this._input.onkeydown=this._handleKeydown.bind(this),this._input}get datalist(){if(this._datalist)return this._datalist;const{element:t}=this._context;return this._datalist=t.querySelector("datalist"),this._datalist}get values(){return this._list||(this._list=[...this._set])}set values(t){this._list=t,this._set.clear(),this._set.delta(t||[])}get readonly(){return this.input.disabled||this.input.readOnly}setDisabled(t){null!=t?this.input.setAttribute("disabled",t):this.input.removeAttribute("disabled")}setReadonly(t){null!=t?this.input.setAttribute("readonly",t):this.input.removeAttribute("readonly")}render(){const{contentRoot:t,element:e}=this._context,{document:n}=this._context.get(o);t.innerHTML="<style>\n:host {\n  border: var(--multi-input-border, 1px solid #ddd);\n  display: block;\n  overflow: hidden;\n  padding: 5px;\n}\n/* NB use of pointer-events to only allow events from the \xd7 icon */\n::slotted(div.item) {\n  background-color: var(--multi-input-item-bg-color, #dedede);\n  border: var(--multi-input-item-border, 1px solid #ccc);\n  border-radius: 2px;\n  color: #222;\n  display: inline-block;\n  font-size: var(--multi-input-item-font-size, 14px);\n  margin: 5px;\n  padding: 2px 25px 2px 5px;\n  pointer-events: none;\n  position: relative;\n  top: -1px;\n}\n/* NB pointer-events: none above */\n::slotted(div.item:hover) {\n  background-color: #eee;\n  color: black;\n}\n::slotted(input) {\n  border: none;\n  font-size: var(--multi-input-input-font-size, 14px);\n  outline: none;\n  padding: 10px 10px 10px 5px;\n}\n</style>\n<slot></slot>",e.insertBefore(n.createComment("[ITEMS["),this.input);const s=e.insertBefore(n.createComment("]ITEMS]"),this.input),i=t=>{const e=t+" ";for(const t of b(this.datalist.options))if(t.value===e)return t},r=t=>{for(const n of b(e.querySelectorAll(".item")))if(n.textContent===t)return n};return()=>{this._set.redelta({add:t=>{var o;if(!r(t)){const o=n.createElement("div");o.className="item",o.textContent=t,o.onclick=()=>{this.readonly||this._delete(t)},e.insertBefore(o,s)}null===(o=i(t))||void 0===o||o.remove()},delete:t=>{var e;if(null===(e=r(t))||void 0===e||e.remove(),!i(t)){const e=n.createElement("option");e.value=t+" ",this.datalist.appendChild(e)}}}).undelta()}}_add(t,e=!1){(e||M.test(t))&&(t=t.trim())&&(this._set.add(t),this._list=null,this.input.value="",this._sendEvent())}_delete(t){this._set.delete(t),this._list=null,this._sendEvent()}_handleBlur(){const{value:t}=this.input;this.input.value="",this._add(t,!0)}_handleInput(){this._add(this.input.value)}_handleKeydown(t){if(this.input.value||"Backspace"!==t.key)this._add(this.input.value);else{const{values:t}=this;t.length&&this._delete(t[t.length-1])}}_sendEvent(){this._context.updateState(m("values"),this.values,this.values),this._context.dispatchEvent(new B("conduit:input",{bubbles:!0,detail:this.values}))}};y([c()],L.prototype,"values",null),y([p("disabled")],L.prototype,"setDisabled",null),y([p("readonly")],L.prototype,"setReadonly",null),y([n()],L.prototype,"render",null),L=y([s(["multi-input",x]),h()],L);class T extends E{constructor(t,{aspects:e}={}){super(t,{aspects:e,get:()=>t.values,set:e=>{t.values=e}})}listenForInput(t){this.events.on("conduit:input")((e=>{t({event:e,value:e.detail})}))}}function $(t,{aspects:e}={}){return new T(t,{aspects:e})}const I=Symbol("load-status"),F=["loaded",x];function P(t={}){return r((({get:e,set:s,key:o})=>{const{render:i={},loaded:r=F,comment:c=String(o)}=t,p=[u,I,o];let h;const m=l.fulfill({on:p},i);return{componentDef:d.all({feature:{needs:S},define(t){h=v.name(r,t.get(f)),i.on&&t.whenComponent((t=>{l.trigger(t,i)((()=>t.updateState(p,"new","old")))}))}},n(m).As((function(){const{element:t}=a.of(this);return n=>{const s=e(this);s&&s.ok?n.postpone((()=>{t.classList.add(h)})):t.classList.remove(h)}}),o),D({render:m,comment:`LOADER(${c})`}).As((function(){return e(this)?void 0:document.createElement("conduit-loader")}),o),D({render:m,comment:`ERRORS(${c})`}).As((function(){const t=e(this);return t&&!t.ok?a.of(this).get(w)(t.errors):void 0}),o)),get:e,set(t,n){const o=e(t);s(t,n),a.of(t).updateState(p,n,o)}}}))}export{w as A,S as L,L as M,D as R,P as a,N as b,R as f,$ as i};//# sourceMappingURL=loader.6a8fc6bd.js.map
