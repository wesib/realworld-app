import{b as t,a as s,c as e,n as a}from"../proc7ts/call-thru.ea70618a.js";import{i as r,t as o}from"../proc7ts/a-iterable.4d42c117.js";import{a as c}from"../proc7ts/context-values.ec10addc.js";import{e as i,c as n,f as p}from"../proc7ts/fun-events.6f8cd792.js";import{F as f}from"../wesib/wesib.b26c9eb2.js";import{_ as h}from"../helpers.920c7f83.js";import{A as l}from"./api.a4379be1.js";const d=["feed","tag","author","favorited","limit","offset"];function u(t,s){return d.every(e=>t[e]===s[e])}function m(s){const e=new URLSearchParams;return r(o(d,s=>"feed"!==s?s:t,e=>{const a=s[e];return a?[e,String(a)]:t}),([t,s])=>e.set(t,s)),e}const b={articles:[],articlesCount:0},g=new c("feed-service"),j={"/personal-feed":{path:"articles/feed",auth:!0},"/global-feed":{path:"articles"}};class F{constructor(t){this._apiFetch=t.get(l)}articles(t){const{path:e,auth:a}=j[t.feed||"/global-feed"],r={path:`${e}?${m(t)}`,init:{method:"GET",headers:{Accept:"application/json"}},auth:a,respondAs:s};return this._apiFetch(r)}tags(s){let r;return(this.tags=i(s=>{if(!r){const s={path:"tags",init:{method:"GET",headers:{Accept:"application/json"}},respondAs:"tags",auth:!1},o=this._apiFetch(s).thru_(s=>s.ok?e(s.body):!1===s.ok?(console.log("Failed to load tags",s.errors),e([])):t),c=n(p(o,()=>[]));r=c.read().thru_(s=>s?a(...s):t)}r.to(s)}).F)(s)}}let v=class{};v=h([f({setup(t){t.provide({a:g,as:F})}})],v);export{v as F,g as a,u as b,m as f,b as n};//# sourceMappingURL=feed.00c91d3f.js.map
