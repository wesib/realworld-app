import{i as e,c as s,b as t,j as o,m as a,k as r,s as n,l as c,g as d,n as i}from"../proc7ts/fun-events.3d56e7e0.js";import"../proc7ts/workbench.76998d65.js";import{S as p,R as m,C as l,A as u,t as f,F as h}from"../wesib/wesib.4285371a.js";import{_ as g}from"../helpers.e1623395.js";import{a as b,I as j,C as v,b as k,c as w,D as C,F as x,U as y}from"../wesib/generic.1b7d8f8d.js";import{a as F,b as _,c as A,i as R,d as U,e as D,f as I,g as M,h as S,j as q,k as z,l as B}from"../frontmeans/input-aspects.a0d328af.js";import{C as E}from"../core.c152f8fe.js";import{A as G}from"./loader.109ed6d0.js";function H({mark:o="is-invalid",when:a}={}){return r=>{const n=r.aspect(F);return e({status:r.aspect(_),validity:r.aspect(A)}).do(s((({status:[{touched:e,hasFocus:s}],validity:[r]})=>{const c=r.has("incomplete")||r.has("missing");return!e||s&&c?t():n.specs(R({mark:o,when:a}))})))}}const J={};let K=class{constructor(e){this._context=e,this.errors=J,e.get(b).get(j).do(o((({control:e})=>e?e.aspect(A).read.do(a((e=>e.messages("api").reduce(((e,s)=>({...e,...s.api})),J)))):t(J))))((e=>this.errors=e))}render(){const{contentRoot:e}=this._context;let s;return()=>{s&&(s.remove(),s=void 0),s=this._context.get(G)(this.errors),s&&e.append(s)}}};g([p()],K.prototype,"errors",void 0),g([m()],K.prototype,"render",null),K=g([l(["api-errors",E])],K);let L=class{};L=g([l(["in-error",E],u("code"),v((({control:{control:e},aspects:s,context:t})=>f(t,"code").read.do(a((e=>e?e.trim().split(/\s+/):[]))).do(r((o=>e.convert(U.to(t.element),s).setup(F,(e=>{e.add(D()),e.add(H({when:o}))}))))))))],L);let N=class{};function O({emptyModel:s={},form:t={makeForm({node:e,aspects:t}){const o=M(s).setup(F,(e=>e.add(D()))).setup(S,(e=>e.derive(q()))),a=z(e.element,{form:o,aspects:t}).setup(F,(e=>e.add(o.aspect(F))));return[o,a]}},button:o}={}){return l(x(t),function({select:s="button",pick:t={deep:!0,all:!0}}={}){return l({define(o){o.whenComponent((o=>{const a=o.get(k),r=o.get(b);o.whenConnected((()=>{e({form:r.get(w),button:a.select(s,t).first,aspects:o.get(C)}).do(n(o),c((({form:[{control:e}],button:[s],aspects:[t]})=>e&&s&&I(s.element,{form:e,aspects:t}))))}))}))}})}(o))}function P(e){return y({...e,makeControl:s=>s.context.get(b).get(w).do(o((({form:o})=>{const a=e.makeControl(s);return a?a instanceof B?t(r(a)):d(a).do(i(((e,s,t)=>s?(r(s),t?e(s,t):e(s)):e()))):t();function r(e){o&&e.aspect(S).derive(o.aspect(S));const s=e.aspect(F);return s.add(D()),s.add(H()),e}})))})}N=g([h({needs:[K,L]})],N);export{N as C,O as F,P as U};//# sourceMappingURL=input.ec36130b.js.map
