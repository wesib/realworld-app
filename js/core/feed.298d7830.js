import{a as t}from"../proc7ts/primitives.3596c309.js";import{i as s,t as e}from"../proc7ts/push-iterator.b943ed6f.js";import{a}from"../proc7ts/context-values.91624d4c.js";import{l as r,a as o,e as i,j as c,n as p}from"../proc7ts/fun-events.26e814e4.js";import"../proc7ts/workbench.47577449.js";import{F as n}from"../wesib/wesib.a2d60763.js";import{_ as f}from"../helpers.e1623395.js";import{A as d}from"./api.a7ea7d29.js";import{n as h}from"../proc7ts/call-thru.f4f68410.js";const l=["feed","tag","author","favorited","limit","offset"];function m(t,s){return l.every((e=>t[e]===s[e]))}function u(t){const a=new URLSearchParams;return s(e(l,(t=>"feed"!==t?t:h),(s=>{const e=t[s];return e?[s,String(e)]:h})),(([t,s])=>a.set(t,s))),a}const j={articles:[],articlesCount:0},g=new a("feed-service"),b={"/personal-feed":{path:"articles/feed",auth:!0},"/global-feed":{path:"articles"}};class v{constructor(t){let s;this._apiFetch=t.get(d),this.tags=r((t=>{if(!s){const t={path:"tags",init:{method:"GET",headers:{Accept:"application/json"}},respondAs:"tags",auth:!1},e=this._apiFetch(t).do(o((t=>t.ok?t.body:(console.error("Failed to load tags",t.errors),[])))),a=i(c(e,(()=>[])));s=a.read.do(p(((t,s)=>s&&t(...s))))}s(t)}))}articles(s){const{path:e,auth:a}=b[s.feed||"/global-feed"],r={path:`${e}?${u(s)}`,init:{method:"GET",headers:{Accept:"application/json"}},auth:a,respondAs:t};return this._apiFetch(r)}}let F=class{};F=f([n({setup(t){t.provide({a:g,as:v})}})],F);export{F,g as a,m as b,u as f,j as n};//# sourceMappingURL=feed.298d7830.js.map
