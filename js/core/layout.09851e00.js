import{c as e}from"../frontmeans/namespace-aliaser.e08188c9.js";import{s as t}from"../proc7ts/fun-events.3d56e7e0.js";import{D as s}from"../frontmeans/dom-events.455a522c.js";import{C as o,B as n,S as r,R as a,l as i,F as c}from"../wesib/wesib.4285371a.js";import{_ as d}from"../helpers.e1623395.js";import{n as l,b as m}from"./auth.b3c0ad31.js";import{e as p,A as u,d as h}from"../wesib/generic.1b7d8f8d.js";import{C as f}from"../core.c152f8fe.js";import{L as g}from"./loader.109ed6d0.js";let C=class{};C=d([o(["main",f],{feature:{needs:g}},p({onResponse({context:e,response:t,range:s}){if(!t.ok){s.deleteContents();const{document:o}=e.get(n),r=o.createElement("conduit-loader");null!=t.ok&&r.setAttribute("load-error",`Error. ${String(t.error)}`),s.insertNode(r)}}}))],C);let v=class{constructor(e){this._context=e,this.user=l;e.get(m).user.do(t(e))((e=>this.user=e)).whenOff((()=>this.user=l))}render(){const e=this._context.get(m),{document:t}=this._context.get(n),{element:o}=this._context,r=o.querySelector("ul"),a=t.createRange();return a.setStartAfter(r.appendChild(t.createComment("[USER-NAV["))),a.setEndBefore(r.appendChild(t.createComment("]USER-NAV]"))),()=>{a.deleteContents();const{username:t}=this.user;if(t){const o=i("","ion-log-out","");new s(o).on("click")((()=>{e.logout()})),a.insertNode(o),a.insertNode(i(t,"ion-person",`profile/#/${encodeURIComponent(t)}`))}};function i(e,s,o){const n=t.createElement("li");n.className="nav-item";const r=n.appendChild(t.createElement("a"));r.className="nav-link",r.setAttribute("href",o);return r.appendChild(t.createElement("i")).className=s,r.append(" ",e),n}}};d([r()],v.prototype,"user",void 0),d([a()],v.prototype,"render",null),v=d([o(["navbar",f],h(),u({active:"active"}))],v);const b=["authenticated",f],j=["not-authenticated",f];let x=class{constructor(e){this._context=e,this.auth={},e.get(m).authentication.do(t(e))((e=>this.auth=e))}render(){const t=this._context.get(i),s=e.name(b,t),o=e.name(j,t),{classList:n}=this._context.element;return()=>{this.auth.token?(n.remove(o),n.add(s)):(n.remove(s),n.add(o))}}};d([r()],x.prototype,"auth",void 0),d([a()],x.prototype,"render",null),x=d([o({name:["container",f],feature:{needs:[C,v]}})],x);let E=class{};E=d([o(["footer",f],h())],E);let N=class{};N=d([c({needs:[x,E]})],N);export{N as C};//# sourceMappingURL=layout.09851e00.js.map
