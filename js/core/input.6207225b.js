import{j as s,f as e,b as t,k as o,m as a,l as r,s as n,n as c,h as i,p}from"../proc7ts/fun-events.f7c44dc9.js";import{S as d,R as m,C as f,A as l,t as u,F as h}from"../wesib/wesib.acbfb4f5.js";import{_ as b}from"../helpers.e1623395.js";import{a as g,I as v,C as j,b as k,c as w,D as C,F as x,U as y}from"../wesib/generic.5b4ac940.js";import{a as F,b as _,c as A,i as R,d as U,e as D,f as I,g as M,h as S,j as q,k as z,l as B}from"../frontmeans/input-aspects.a58ff15b.js";import{C as E}from"../core.c152f8fe.js";import{A as G}from"./loader.57d9ca02.js";function H({mark:o="is-invalid",when:a}={}){return r=>{const n=r.aspect(F);return s({status:r.aspect(_),validity:r.aspect(A)}).do(e((({status:[{touched:s,hasFocus:e}],validity:[r]})=>{const c=r.has("incomplete")||r.has("missing");return!s||e&&c?t():n.specs(R({mark:o,when:a}))})))}}const J={};let K=class{constructor(s){this._context=s,this.errors=J,s.get(g).get(v).do(o((({control:s})=>s?s.aspect(A).read.do(a((s=>s.messages("api").reduce(((s,e)=>({...s,...e.api})),J)))):t(J))))((s=>this.errors=s))}render(){const{contentRoot:s}=this._context;let e;return()=>{e&&(e.remove(),e=void 0),e=this._context.get(G)(this.errors),e&&s.append(e)}}};b([d()],K.prototype,"errors",void 0),b([m()],K.prototype,"render",null),K=b([f(["api-errors",E])],K);let L=class{};L=b([f(["in-error",E],l("code"),j((({control:{control:s},aspects:e,context:t})=>u(t,"code").read.do(a((s=>s?s.trim().split(/\s+/):[]))).do(r((o=>s.convert(U.to(t.element),e).setup(F,(s=>{s.add(D()),s.add(H({when:o}))}))))))))],L);let N=class{};function O({emptyModel:e={},form:t={makeForm({node:s,aspects:t}){const o=M(e).setup(F,(s=>s.add(D()))).setup(S,(s=>s.derive(q()))),a=z(s.element,{form:o,aspects:t}).setup(F,(s=>s.add(o.aspect(F))));return[o,a]}},button:o}={}){return f(x(t),function({select:e="button",pick:t={deep:!0,all:!0}}={}){return f({define(o){o.whenComponent((o=>{const a=o.get(k),r=o.get(g);o.whenConnected((()=>{s({form:r.get(w),button:a.select(e,t).first,aspects:o.get(C)}).do(n(o),c((({form:[{control:s}],button:[e],aspects:[t]})=>s&&e&&I(e.element,{form:s,aspects:t}))))}))}))}})}(o))}function P(s){return y({...s,makeControl:e=>e.context.get(g).get(w).do(o((({form:o})=>{const a=s.makeControl(e);return a?a instanceof B?t(r(a)):i(a).do(p(((s,e,t)=>e?(r(e),t?s(e,t):s(e)):s()))):t();function r(s){o&&s.aspect(S).derive(o.aspect(S));const e=s.aspect(F);return e.add(D()),e.add(H()),s}})))})}N=b([h({needs:[K,L]})],N);export{N as C,O as F,P as U};//# sourceMappingURL=input.6207225b.js.map
