import{a as t}from"../proc7ts/primitives.f8acf1f5.js";import{n as s,a,b as e}from"../proc7ts/call-thru.7f76a0d9.js";import{i as r,t as o}from"../proc7ts/a-iterable.3b78dc26.js";import{S as i}from"../proc7ts/context-values.7886ab40.js";import{o as c,t as n,a as p}from"../proc7ts/fun-events.c2220af5.js";import{F as f}from"../wesib/wesib.e7f21d38.js";import{_ as h}from"../helpers.e1623395.js";import{A as l}from"./api.ac725a89.js";const d=["feed","tag","author","favorited","limit","offset"];function m(t,s){return d.every(a=>t[a]===s[a])}function u(t){const a=new URLSearchParams;return r(o(d,t=>"feed"!==t?t:s,a=>{const e=t[a];return e?[a,String(e)]:s}),([t,s])=>a.set(t,s)),a}const b={articles:[],articlesCount:0},g=new i("feed-service"),j={"/personal-feed":{path:"articles/feed",auth:!0},"/global-feed":{path:"articles"}};class v{constructor(t){this._apiFetch=t.get(l)}articles(s){const{path:a,auth:e}=j[s.feed||"/global-feed"],r={path:`${a}?${u(s)}`,init:{method:"GET",headers:{Accept:"application/json"}},auth:e,respondAs:t};return this._apiFetch(r)}tags(t){let r;return(this.tags=c(t=>{if(!r){const t={path:"tags",init:{method:"GET",headers:{Accept:"application/json"}},respondAs:"tags",auth:!1},o=this._apiFetch(t).thru_(t=>t.ok?a(t.body):(console.error("Failed to load tags",t.errors),a([]))),i=n(p(o,()=>[]));r=i.read().thru_(t=>t?e(...t):s)}r.to(t)}).F)(t)}}let F=(()=>{let t=class{};return t=h([f({setup(t){t.provide({a:g,as:v})}})],t),t})();export{F,g as a,m as b,u as f,b as n};//# sourceMappingURL=feed.f393a146.js.map
