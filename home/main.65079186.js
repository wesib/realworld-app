import{d as e}from"../js/proc7ts/call-thru.86e41caf.js";import{g as t}from"../js/proc7ts/fun-events.6756e60e.js";import{S as s,R as o,C as r,B as n,k as a}from"../js/wesib/wesib.21207b5a.js";import{_ as c}from"../js/helpers.920c7f83.js";import{b as i}from"../js/core/auth.116b650f.js";import{f as d,N as h,A as l,h as p}from"../js/wesib/generic.83001515.js";import{C as f}from"../js/core.c852ba8c.js";import{L as m}from"../js/core/loader.4acbb68b.js";import"../js/core/input.777c40d3.js";import{P as g,R as u}from"../js/render-feed.decorator.05766dd7.js";import{c as j}from"../js/core/main.e5da8ebe.js";import{a as b,F as C}from"../js/core/feed.6c6341c0.js";let x=class{constructor(e){this._context=e,this.tags=[];const t=this._context.get(b),s=this._context.get(h);e.whenConnected(()=>{s.read().tillOff(e).to(e=>this.page=e),t.tags().tillOff(e).to((...e)=>this.tags=e)})}render(){const{document:e}=this._context.get(n),t=e.createRange(),{contentRoot:s}=this._context;return t.selectNodeContents(s),t.setStartAfter(s.childNodes[s.childNodes.length-1]),()=>{if(t.deleteContents(),!this.page)return;const s=this._context.get(h),o=e.createDocumentFragment(),r=this.page.get(g);this.tags.forEach(t=>{const n=s.with(g,Object.assign(Object.assign({},r),{tag:t,feed:void 0,offset:0})).pretend();if(n){const s=o.appendChild(e.createElement("a"));s.href=n.url.href,s.innerText=t}}),t.insertNode(o)}}};c([s()],x.prototype,"tags",void 0),c([s()],x.prototype,"page",void 0),c([o()],x.prototype,"render",null),x=c([r(["feed-tags",f],d())],x);let _=class{constructor(s){this._context=s,this.request={};const{document:o}=s.get(n),r=s.get(h),a=s.get(i);s.whenConnected(()=>{t({auth:a.authentication(),page:r}).tillOff(s).to(({auth:[{token:t}],page:[s]})=>{const{url:n}=s,a=new URL(o.baseURI);if(n.pathname!==a.pathname)return;const c=this.request=s.get(g),{feed:i}=c;"/personal-feed"===i&&(t||r.with(g,{}).replace().catch(e))})})}render(){const e=this._context.get(h),{document:t}=this._context.get(n),{element:s}=this._context,o=s.querySelector("ul"),r=t.createRange();return r.setStartAfter(o.appendChild(t.createComment("[TAG["))),r.setEndBefore(o.appendChild(t.createComment("]TAG]"))),()=>{r.deleteContents();const{tag:s}=this.request;if(!s)return;const o=e.with(g,{tag:s}).pretend();if(!o)return;const n=t.createElement("li");n.className="nav-item";const a=n.appendChild(t.createElement("a"));a.className="nav-link",a.innerText="#"+s,a.setAttribute("href",o.url.hash),r.insertNode(n)}}};c([s()],_.prototype,"request",void 0),c([o({path:a})],_.prototype,"render",null),_=c([r(["feed-toggle",f],l({active:"active"}),d())],_);let v=class{constructor(e){this.request={};const t=e.get(h);e.whenConnected(()=>{t.read().tillOff(e).to(e=>{this.request=e.get(g)})})}};c([u()],v.prototype,"request",void 0),v=c([r(["feed",f])],v);let w=class{};w=c([r(["home",f],{feature:{needs:[C,v,x,_,m,p]}})],w),j.load(w);//# sourceMappingURL=main.65079186.js.map
