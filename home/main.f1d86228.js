import{ab as e,f as t,w as s,t as a,a6 as n}from"../js/lib.e4c19b17.js";import{l as r,R as o,C as i,i as c,h as l,N as d,B as h}from"../js/wesib.23766358.js";import{e as p,C as u,A as f,h as m,s as g,F as v,f as _,a as b,c as $}from"../js/common.0752c4ca.js";let w=class{constructor(e){this._context=e}render(){if(!this.article)return;const e=this._context.contentRoot,{author:t}=this.article,s=`profile/#${encodeURIComponent(t.username)}`,a=t.image?`<img src="${encodeURI(t.image)}"/>`:"",n=p(t.username),r=new Date(this.article.createdAt).toDateString(),o=`article/#${encodeURIComponent(this.article.slug)}`;e.innerHTML=`\n<div class="post-meta">\n<a href="${s}">${a}</a>\n<div class="info">\n    <a href="${s}" class="author">${n}</a>\n    <span class="date">${r}</span>\n</div>\n<button class="btn btn-outline-primary btn-sm float-right">\n  <i class="ion-heart"></i> 32\n</button>\n</div>\n<a href="${o}" class="preview-link">\n<h1>${p(this.article.title)}</h1>\n<p>${this.article.body}</p>\n<span>Read more...</span>\n</a>\n`}};e([r({propertyKey:"feedArticle"})],w.prototype,"article",void 0),e([o()],w.prototype,"render",null),w=e([i(["article-preview",u])],w);let x=class{constructor(e){const a=e.get(d),n=e.get(f);e.whenOn(e=>{t({user:n.user,page:a}).tillOff(e)(({user:[e],page:[{url:t}]})=>{const n=m(t),r=n.pathname.substring(1);r&&("personal"===r&&e||(n.pathname="",a.replace(g(t,n)).catch(s)))})})}};x=e([i(["feed-toggle",u],l({active:"active"}),c())],x);let y=class{constructor(e){this._context=e,this._request=a([!1,{}]);const t=e.get(d),s=e.get(v);e.whenOn(e=>{t.read.tillOff(e)(({url:e})=>{const{pathname:t,searchParams:s}=m(e),a="/personal"===t,n={tag:s.get("tag")||void 0,author:s.get("author")||void 0,favorited:s.get("favorited")||void 0,limit:parseInt(s.get("limit")||"",10)||void 0,offset:parseInt(s.get("offset")||"",10)||void 0},[r,o]=this._request.it;r===a&&_(n,o)||(this._request.it=[a,n])}),this._request.read.tillOff(e).thru_(([e,t])=>(this.response=void 0,n(e?s.feed(t):s.articles(t))))(e=>this.response=e)})}get response(){return this._response}set response(e){const t=this._response;this._response=e,this._context.updateState("posts",e,t)}render(){const e=this._context.get(h).document,t=this._context.get(b),s=e.createRange();return s.selectNodeContents(this._context.contentRoot),()=>{const a=this.response;s.deleteContents(),a&&(a.ok?function(t){const a=e.createDocumentFragment();t.articles.forEach(t=>{a.appendChild(e.createElement("conduit-article-preview")).feedArticle=t}),s.insertNode(a)}(a.body):function(a){const n=t(a);n?s.insertNode(n):s.insertNode(e.createTextNode("Failed to load articles"))}(a.errors))}}};e([o()],y.prototype,"render",null),y=e([i(["feed",u],c())],y);let R=class{};R=e([i(["home",u],{feature:{needs:[w,y,x]}})],R),$.load(R);//# sourceMappingURL=main.f1d86228.js.map
