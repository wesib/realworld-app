{"version":3,"file":"main.ec3b8400.js","sources":["../../src/pages/home/page-feed-param.ts","../../src/pages/home/feed-tags.component.ts","../../src/pages/home/feed-toggle.component.ts","../../src/pages/home/article-preview.component.ts","../../src/pages/home/feed-article-list.ts","../../src/pages/home/article-list.component.ts","../../src/pages/home/feed-pager.component.ts","../../src/pages/home/feed.component.ts","../../src/pages/home/home.component.ts","../../src/pages/home/index.ts"],"sourcesContent":["import { Page, PageHashURLParam, PageParam } from '@wesib/generic';\nimport { FeedRequest, feedRequestSearchParams } from '../../common/articles/feed-request';\n\nclass PageFeedParam$ extends PageParam<FeedRequest, FeedRequest> {\n\n  create(page: Page, input: FeedRequest): PageParam.Handle<FeedRequest, FeedRequest> {\n\n    const handle = this.byDefault(page);\n\n    handle.put(input);\n\n    return handle;\n  }\n\n  byDefault(page: Page): PageParam.Handle<FeedRequest, FeedRequest> {\n    return {\n      get() {\n\n        const { searchParams: params, pathname } = page.get(PageHashURLParam);\n\n        return {\n          feed: pathname === '/personal-feed' ? pathname : undefined,\n          tag: params.get('tag') || undefined,\n          author: params.get('author') || undefined,\n          favorited: params.get('favorited') || undefined,\n          limit: parseInt(params.get('limit') || '', 10) || undefined,\n          offset: parseInt(params.get('offset') || '', 10) || undefined,\n        };\n      },\n      put(value) {\n\n        const { feed } = value;\n        const url = new URL(page.get(PageHashURLParam).href);\n\n        url.pathname = feed === '/personal-feed' ? feed : '';\n\n        const searchParams = feedRequestSearchParams(value).toString();\n\n        url.search = searchParams ? '?' + searchParams : '';\n\n        page.put(PageHashURLParam, url);\n      },\n    };\n  }\n\n}\n\nexport const PageFeedParam: PageParam.WithDefaults<FeedRequest, FeedRequest> = new PageFeedParam$();\n","import { HandleNavLinks, Navigation, Page } from '@wesib/generic';\nimport { BootstrapWindow, Component, ComponentContext, ElementRender, Render } from '@wesib/wesib';\nimport { Conduit__NS } from '../../common';\nimport { FeedService } from '../../common/articles';\nimport { PageFeedParam } from './page-feed-param';\n\n@Component(\n    ['feed-tags', Conduit__NS],\n    HandleNavLinks(),\n)\nexport class FeedTagsComponent {\n\n  private _tags: string[] = [];\n\n  constructor(private readonly _context: ComponentContext) {\n\n    const feedService = this._context.get(FeedService);\n\n    _context.whenOn(supply => {\n      feedService.tags().tillOff(supply)((...tags) => this.tags = tags);\n    });\n  }\n\n  get tags(): string[] {\n    return this._tags;\n  }\n\n  set tags(value: string[]) {\n\n    const prev = this._tags;\n\n    this._tags = value;\n    this._context.updateState('tags', value, prev);\n  }\n\n  @Render()\n  render(): ElementRender {\n\n    const { document } = this._context.get(BootstrapWindow);\n    const range = document.createRange();\n    const { contentRoot }: { contentRoot: Element } = this._context;\n\n    range.selectNodeContents(contentRoot);\n    range.setStartAfter(contentRoot.childNodes[contentRoot.childNodes.length - 1]);\n\n    const navigation = this._context.get(Navigation);\n    let page: Page;\n\n    navigation.read(p => {\n\n      const prev = page;\n\n      page = p;\n      this._context.updateState('page', page, prev);\n    });\n\n    return () => {\n      range.deleteContents();\n\n      const fragment = document.createDocumentFragment();\n      const request = page.get(PageFeedParam);\n\n      this.tags.forEach(tag => {\n\n        const target = navigation.with(PageFeedParam, { ...request, tag, offset: 0 }).pretend();\n\n        if (target) {\n\n          const a = fragment.appendChild(document.createElement('a'));\n\n          a.href = target.url.href;\n          a.innerText = tag;\n        }\n      });\n\n      range.insertNode(fragment);\n    };\n  }\n\n}\n","import { ActivateNavLink, HandleNavLinks, Navigation } from '@wesib/generic';\nimport { BootstrapWindow, Component, ComponentContext } from '@wesib/wesib';\nimport { noop } from 'call-thru';\nimport { afterAll } from 'fun-events';\nimport { Conduit__NS } from '../../common';\nimport { AuthService } from '../../common/auth';\nimport { PageFeedParam } from './page-feed-param';\n\n@Component(\n    ['feed-toggle', Conduit__NS],\n    ActivateNavLink({ active: 'active' }),\n    HandleNavLinks(),\n)\nexport class FeedToggleComponent {\n\n  constructor(context: ComponentContext) {\n\n    const { document } = context.get(BootstrapWindow);\n    const navigation = context.get(Navigation);\n    const authService = context.get(AuthService);\n\n    context.whenOn(supply => {\n      afterAll({\n        auth: authService.authentication,\n        page: navigation,\n      }).tillOff(supply)(\n          ({\n            auth: [{ token }],\n            page: [page],\n          }) => {\n\n            const { url } = page;\n            const baseURL = new URL(document.baseURI);\n\n            if (url.pathname !== baseURL.pathname) {\n              return; // Not a home page\n            }\n\n            const { feed } = page.get(PageFeedParam);\n\n            if (feed !== '/personal-feed') {\n              return; // Global feed\n            }\n            if (!token /* not authenticated */) {\n              // Redirect to global feed\n              navigation.with(PageFeedParam, {}).replace().catch(noop);\n            }\n          },\n      );\n    });\n  }\n\n}\n","import { HandleNavLinks } from '@wesib/generic';\nimport { Component, ComponentContext, DomProperty, ElementRender, Render } from '@wesib/wesib';\nimport { Conduit__NS } from '../../common';\nimport { Article, articleContent } from '../../common/articles';\nimport { escapeHtml } from '../../common/util';\n\n@Component(\n    ['article-preview', Conduit__NS],\n    HandleNavLinks({\n      href(event) {\n\n        let target = event.target as Element;\n\n        for (;;) {\n\n          const href = target.getAttribute('href');\n\n          if (href != null) {\n            return href;\n          }\n\n          const { parentNode } = target;\n\n          if (!parentNode) {\n            return;\n          }\n          target = parentNode as Element;\n        }\n      },\n    }),\n)\nexport class ArticlePreviewComponent {\n\n  constructor(private readonly _context: ComponentContext) {\n  }\n\n  @DomProperty({ propertyKey: 'feedArticle' })\n  article: Article | undefined;\n\n  @Render()\n  render(): ElementRender | void {\n    if (!this.article) {\n      return;\n    }\n\n    const { article } = this;\n    const content = this._context.contentRoot as Element;\n    const { author } = this.article;\n    const profileURL = `profile/#${encodeURIComponent(author.username)}`;\n    const profileImage = author.image ? `<img src=\"${encodeURI(author.image)}\"/>` : '';\n    const username = escapeHtml(author.username);\n    const postDate = new Date(this.article.createdAt).toDateString();\n    const postURL = `article/#${encodeURIComponent(this.article.slug)}`;\n    const favIconClass = this.article.favorited ? 'ion-heart' : 'ion-ios-heart-outline';\n\n    content.innerHTML = `\n<div class=\"post-meta\">\n<a href=\"${profileURL}\">${profileImage}</a>\n<div class=\"info\">\n    <a href=\"${profileURL}\" class=\"author\">${username}</a>\n    <span class=\"date\">${postDate}</span>\n</div>\n<button class=\"btn btn-outline-primary btn-sm float-right\">\n  <i class=\"${favIconClass}\"></i> ${this.article.favoritesCount}\n</button>\n</div>\n<a href=\"${postURL}\" class=\"preview-link\">\n<h1>${escapeHtml(this.article.title)}</h1>\n<p class=\"post-content\"></p>\n<span>Read more...</span>\n</a>\n`;\n\n    let postContent = '';\n\n    const setContent = (html: string): void => {\n\n      const prev = postContent;\n\n      postContent = html;\n      this._context.updateState('postContent', postContent, prev);\n    };\n\n    articleContent(article)\n        .then(setContent)\n        .catch(error => {\n          console.log(`Failed to display article ${article.slug}`);\n          setContent(`ERROR ${String(error)}`);\n        });\n\n    return () => {\n      content.querySelector('.post-content')!.innerHTML = postContent;\n    };\n  }\n\n}\n","import { SingleContextUpKey, SingleContextUpRef } from 'context-values/updatable';\nimport { ArticleList } from '../../common/articles';\n\nexport type FeedArticleList = ArticleList;\n\nexport const FeedArticleList: SingleContextUpRef<FeedArticleList> = (\n    new SingleContextUpKey<FeedArticleList>(\n        'feed-article-list',\n        {\n          byDefault: () => ({ articles: [], articlesCount: 0 }),\n        },\n    )\n);\n","import { HierarchyContext } from '@wesib/generic';\nimport { BootstrapWindow, Component, ComponentContext, ElementRender, Render } from '@wesib/wesib';\nimport { Conduit__NS } from '../../common';\nimport { ArticlePreviewComponent } from './article-preview.component';\nimport { FeedArticleList } from './feed-article-list';\n\n@Component(\n    ['article-list', Conduit__NS],\n    {\n      feature: {\n        needs: ArticlePreviewComponent,\n      },\n    },\n)\nexport class ArticleListComponent {\n\n  constructor(private readonly _context: ComponentContext) {\n  }\n\n  @Render()\n  render(): ElementRender {\n\n    const document = this._context.get(BootstrapWindow).document;\n    const hierarchy = this._context.get(HierarchyContext);\n    const range = document.createRange();\n\n    range.selectNodeContents(this._context.contentRoot);\n\n    let articles: FeedArticleList;\n\n    hierarchy.get(FeedArticleList)(list => {\n\n      const prev = articles;\n\n      articles = list;\n      this._context.updateState('articles', list, prev);\n    });\n\n    return () => {\n      range.deleteContents();\n      if (!articles.articlesCount) {\n        return;\n      }\n\n      const fragment = document.createDocumentFragment();\n\n      articles.articles.forEach(article => {\n\n        const element: any = fragment.appendChild(document.createElement('conduit-article-preview'));\n\n        element.feedArticle = article;\n      });\n\n      range.insertNode(fragment);\n    };\n  }\n\n}\n","import { HierarchyContext, Navigation } from '@wesib/generic';\nimport { Component, ComponentContext } from '@wesib/wesib';\nimport { afterAll } from 'fun-events';\nimport { Conduit__NS } from '../../common';\nimport { PagingInfo, RenderPager } from '../../generic/pager';\nimport { FeedArticleList } from './feed-article-list';\nimport { PageFeedParam } from './page-feed-param';\n\n@Component(['feed-pager', Conduit__NS])\nexport class FeedPagerComponent {\n\n  private _feedPaging: PagingInfo = {};\n\n  constructor(context: ComponentContext) {\n\n    const hierarchy = context.get(HierarchyContext);\n    const navigation = context.get(Navigation);\n\n    context.whenOn(supply => {\n      afterAll({\n        param: navigation.read.keep.thru_(page => page.get(PageFeedParam)),\n        list: hierarchy.get(FeedArticleList),\n      }).tillOff(supply)(\n          ({\n            param: [param],\n            list: [{ articlesCount }],\n          }) => {\n\n            const { limit = 20, offset = 0 } = param;\n\n            this.feedPaging = {\n              totalPages: Math.ceil(articlesCount / limit),\n              currentPage: Math.floor(offset / limit),\n              pageHref(page: number): string {\n                return navigation.with(\n                    PageFeedParam,\n                    { ...param, offset: limit * page },\n                ).pretend()?.url.href || '';\n              },\n            };\n          },\n      );\n    });\n  }\n\n  @RenderPager()\n  get feedPaging(): PagingInfo {\n    return this._feedPaging;\n  }\n\n  set feedPaging(value: PagingInfo) {\n    this._feedPaging = value;\n  }\n\n}\n","import { HierarchyContext, Navigation } from '@wesib/generic';\nimport { BootstrapWindow, Component, ComponentContext, ElementRender, Render } from '@wesib/wesib';\nimport { nextOnEvent, trackValue } from 'fun-events';\nimport { Conduit__NS } from '../../common';\nimport { ApiResponse } from '../../common/api';\nimport { ArticleList, FeedRequest, feedRequestsEqual, FeedService } from '../../common/articles';\nimport { ApiErrorGenerator } from '../../common/input/api-error-generator';\nimport { ArticleListComponent } from './article-list.component';\nimport { FeedArticleList } from './feed-article-list';\nimport { FeedPagerComponent } from './feed-pager.component';\nimport { PageFeedParam } from './page-feed-param';\n\n@Component(\n    ['feed', Conduit__NS],\n    {\n      feature: {\n        needs: [\n          ArticleListComponent,\n          FeedPagerComponent,\n        ],\n      },\n    },\n)\nexport class FeedComponent {\n\n  private readonly _request = trackValue<FeedRequest>({});\n  private _response = trackValue<ApiResponse<ArticleList>>();\n\n  constructor(private readonly _context: ComponentContext) {\n\n    const navigation = _context.get(Navigation);\n    const feedService = _context.get(FeedService);\n\n    this._response.on(\n        (newResponse, oldResponse) => _context.updateState('response', newResponse, oldResponse),\n    );\n    this._context.get(HierarchyContext).provide({\n      a: FeedArticleList,\n      is: this._response.read.keep.thru_(\n          response => response?.ok\n              ? response.body\n              : { articles: [], articlesCount: 0 },\n      ),\n    });\n    _context.whenOn(supply => {\n      navigation.read.tillOff(supply)(page => {\n\n        const request = page.get(PageFeedParam);\n        const prevRequest = this._request.it;\n\n        if (!feedRequestsEqual(request, prevRequest)) {\n          this._request.it = request;\n        }\n      });\n      this._request.read\n          .tillOff(supply)\n          .thru_(\n              request => {\n                this._response.it = undefined;\n                return nextOnEvent(feedService.articles(request));\n              },\n          )(response => this._response.it = response);\n    });\n  }\n\n  @Render()\n  render(): ElementRender {\n\n    const { contentRoot }: { contentRoot: Node } = this._context;\n    const document = this._context.get(BootstrapWindow).document;\n    const errorGen = this._context.get(ApiErrorGenerator);\n    const list = contentRoot.appendChild(document.createElement('conduit-article-list'));\n    const pager = contentRoot.appendChild(document.createElement('conduit-feed-pager'));\n    const range = document.createRange();\n\n    range.setStartAfter(list);\n    range.setEndBefore(pager);\n\n    return () => {\n      range.deleteContents();\n\n      const response = this._response.it;\n\n      if (!response) {\n        range.insertNode(displayProgress());\n      } else if (!response.ok) {\n        range.insertNode(displayError(response.errors));\n      }\n    };\n\n    function displayProgress(): Element {\n      return document.createElement('conduit-loader');\n    }\n\n    function displayError(errors: ApiResponse.Errors): Element {\n\n      const errorList = errorGen(errors);\n\n      if (errorList) {\n        return errorList;\n      }\n\n      const loader = document.createElement('conduit-loader');\n\n      loader.setAttribute('load-error', 'Failed to load articles');\n\n      return loader;\n    }\n\n  }\n\n}\n","import { PageHashURLSupport } from '@wesib/generic';\nimport { Component } from '@wesib/wesib';\nimport { Conduit__NS } from '../../common';\nimport { FeedSupport } from '../../common/articles';\nimport { LoaderComponent } from '../../generic/loader';\nimport { FeedTagsComponent } from './feed-tags.component';\nimport { FeedToggleComponent } from './feed-toggle.component';\nimport { FeedComponent } from './feed.component';\n\n@Component(\n    ['home', Conduit__NS],\n    {\n      feature: {\n        needs: [\n          FeedSupport,\n          FeedComponent,\n          FeedTagsComponent,\n          FeedToggleComponent,\n          LoaderComponent,\n          PageHashURLSupport,\n        ],\n      },\n    },\n)\nexport class HomeComponent {\n}\n","import { conduitContext } from '../../common/main';\nimport { HomeComponent } from './home.component';\n\nconduitContext.load(HomeComponent);\n"],"names":["PageFeedParam","PageParam","[object Object]","page","input","handle","this","byDefault","put","searchParams","params","pathname","get","PageHashURLParam","feed","undefined","tag","author","favorited","limit","parseInt","offset","value","url","URL","href","feedRequestSearchParams","toString","search","FeedTagsComponent","_context","feedService","FeedService","whenOn","supply","tags","tillOff","_tags","prev","updateState","document","BootstrapWindow","range","createRange","contentRoot","selectNodeContents","setStartAfter","childNodes","length","navigation","Navigation","read","p","deleteContents","fragment","createDocumentFragment","request","forEach","target","with","pretend","a","appendChild","createElement","innerText","insertNode","__decorate","Render","Component","Conduit__NS","HandleNavLinks","FeedToggleComponent","context","authService","AuthService","afterAll","auth","authentication","token","baseURL","baseURI","replace","catch","noop","ActivateNavLink","active","ArticlePreviewComponent","article","content","profileURL","encodeURIComponent","username","profileImage","image","encodeURI","escapeHtml","postDate","Date","createdAt","toDateString","postURL","slug","favIconClass","innerHTML","favoritesCount","title","postContent","setContent","html","articleContent","then","error","console","log","String","querySelector","DomProperty","propertyKey","event","getAttribute","parentNode","FeedArticleList","SingleContextUpKey","articles","articlesCount","ArticleListComponent","hierarchy","HierarchyContext","list","feedArticle","feature","needs","FeedPagerComponent","param","keep","thru_","feedPaging","totalPages","Math","ceil","currentPage","floor","_feedPaging","RenderPager","FeedComponent","trackValue","_response","on","newResponse","oldResponse","provide","is","response","ok","body","prevRequest","_request","it","feedRequestsEqual","nextOnEvent","errorGen","ApiErrorGenerator","pager","setEndBefore","errors","errorList","loader","setAttribute","displayError","HomeComponent","FeedSupport","LoaderComponent","PageHashURLSupport","conduitContext","load"],"mappings":"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"}