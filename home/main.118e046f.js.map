{"version":3,"file":"main.118e046f.js","sources":["../../src/pages/home/page-feed-param.ts","../../src/pages/home/feed-tags.component.ts","../../src/pages/home/feed-toggle.component.ts","../../src/pages/home/article-preview.component.ts","../../src/pages/home/feed-article-list.ts","../../src/pages/home/article-list.component.ts","../../src/pages/home/feed.component.ts","../../src/pages/home/home.component.ts","../../src/pages/home/index.ts"],"sourcesContent":["import { Page, PageHashURLParam, PageParam } from '@wesib/generic';\nimport { FeedRequest, feedRequestSearchParams } from '../../common/articles/feed-request';\n\nclass PageFeedParam$ extends PageParam<FeedRequest, FeedRequest> {\n\n  create(page: Page, input: FeedRequest): PageParam.Handle<FeedRequest, FeedRequest> {\n\n    const handle = this.byDefault(page);\n\n    handle.put(input);\n\n    return handle;\n  }\n\n  byDefault(page: Page): PageParam.Handle<FeedRequest, FeedRequest> {\n    return {\n      get() {\n\n        const { searchParams: params, pathname } = page.get(PageHashURLParam);\n\n        return {\n          feed: pathname === '/personal-feed' ? pathname : undefined,\n          tag: params.get('tag') || undefined,\n          author: params.get('author') || undefined,\n          favorited: params.get('favorited') || undefined,\n          limit: parseInt(params.get('limit') || '', 10) || undefined,\n          offset: parseInt(params.get('offset') || '', 10) || undefined,\n        };\n      },\n      put(value) {\n\n        const { feed } = value;\n        const url = new URL(page.get(PageHashURLParam).href);\n\n        url.pathname = feed === '/personal-feed' ? feed : '';\n\n        const searchParams = feedRequestSearchParams(value).toString();\n\n        url.search = searchParams ? '?' + searchParams : '';\n\n        page.put(PageHashURLParam, url);\n      },\n    };\n  }\n\n}\n\nexport const PageFeedParam: PageParam.WithDefaults<FeedRequest, FeedRequest> = new PageFeedParam$();\n","import { HandleNavLinks, Navigation, Page } from '@wesib/generic';\nimport { BootstrapWindow, Component, ComponentContext, ElementRender, Render } from '@wesib/wesib';\nimport { Conduit__NS, FeedService } from '../../common';\nimport { PageFeedParam } from './page-feed-param';\n\n@Component(\n    ['feed-tags', Conduit__NS],\n    HandleNavLinks(),\n)\nexport class FeedTagsComponent {\n\n  private _tags: string[] = [];\n\n  constructor(private readonly _context: ComponentContext) {\n\n    const feedService = this._context.get(FeedService);\n\n    _context.whenOn(supply => {\n      feedService.tags().tillOff(supply)((...tags) => this.tags = tags);\n    });\n  }\n\n  get tags(): string[] {\n    return this._tags;\n  }\n\n  set tags(value: string[]) {\n\n    const prev = this._tags;\n\n    this._tags = value;\n    this._context.updateState('tags', value, prev);\n  }\n\n  @Render()\n  render(): ElementRender {\n\n    const { document } = this._context.get(BootstrapWindow);\n    const range = document.createRange();\n    const { contentRoot }: { contentRoot: Element } = this._context;\n\n    range.selectNodeContents(contentRoot);\n    range.setStartAfter(contentRoot.childNodes[contentRoot.childNodes.length - 1]);\n\n    const navigation = this._context.get(Navigation);\n    let page: Page;\n\n    navigation.read(p => {\n\n      const prev = page;\n\n      page = p;\n      this._context.updateState('page', page, prev);\n    });\n\n    return () => {\n      range.deleteContents();\n\n      const fragment = document.createDocumentFragment();\n      const request = page.get(PageFeedParam);\n\n      this.tags.forEach(tag => {\n\n        const target = navigation.with(PageFeedParam, { ...request, tag, offset: 0 }).pretend();\n\n        if (target) {\n\n          const a = fragment.appendChild(document.createElement('a'));\n\n          a.href = target.url.href;\n          a.innerText = tag;\n        }\n      });\n\n      range.insertNode(fragment);\n    };\n  }\n\n}\n","import { ActivateNavLink, HandleNavLinks, Navigation } from '@wesib/generic';\nimport { BootstrapWindow, Component, ComponentContext } from '@wesib/wesib';\nimport { noop } from 'call-thru';\nimport { afterAll } from 'fun-events';\nimport { AuthService, Conduit__NS } from '../../common';\nimport { PageFeedParam } from './page-feed-param';\n\n@Component(\n    ['feed-toggle', Conduit__NS],\n    ActivateNavLink({ active: 'active' }),\n    HandleNavLinks(),\n)\nexport class FeedToggleComponent {\n\n  constructor(context: ComponentContext) {\n\n    const { document } = context.get(BootstrapWindow);\n    const navigation = context.get(Navigation);\n    const authService = context.get(AuthService);\n\n    context.whenOn(supply => {\n      afterAll({\n        auth: authService.authentication,\n        page: navigation,\n      }).tillOff(supply)(\n          ({\n            auth: [{ token }],\n            page: [page],\n          }) => {\n\n            const { url } = page;\n            const baseURL = new URL(document.baseURI);\n\n            if (url.pathname !== baseURL.pathname) {\n              return; // Not a home page\n            }\n\n            const { feed } = page.get(PageFeedParam);\n\n            if (feed !== '/personal-feed') {\n              return; // Global feed\n            }\n            if (!token /* not authenticated */) {\n              // Redirect to global feed\n              navigation.with(PageFeedParam, {}).replace().catch(noop);\n            }\n          },\n      );\n    });\n  }\n\n}\n","import { HandleNavLinks } from '@wesib/generic';\nimport { Component, ComponentContext, DomProperty, ElementRender, Render } from '@wesib/wesib';\nimport { Article, articleContent, Conduit__NS, escapeHtml } from '../../common';\n\n@Component(\n    ['article-preview', Conduit__NS],\n    HandleNavLinks({\n      href(event) {\n\n        let target = event.target as Element;\n\n        for (;;) {\n\n          const href = target.getAttribute('href');\n\n          if (href != null) {\n            return href;\n          }\n\n          const { parentNode } = target;\n\n          if (!parentNode) {\n            return;\n          }\n          target = parentNode as Element;\n        }\n      },\n    }),\n)\nexport class ArticlePreviewComponent {\n\n  constructor(private readonly _context: ComponentContext) {\n  }\n\n  @DomProperty({ propertyKey: 'feedArticle' })\n  article: Article | undefined;\n\n  @Render()\n  render(): ElementRender | void {\n    if (!this.article) {\n      return;\n    }\n\n    const { article } = this;\n    const content = this._context.contentRoot as Element;\n    const { author } = this.article;\n    const profileURL = `profile/#${encodeURIComponent(author.username)}`;\n    const profileImage = author.image ? `<img src=\"${encodeURI(author.image)}\"/>` : '';\n    const username = escapeHtml(author.username);\n    const postDate = new Date(this.article.createdAt).toDateString();\n    const postURL = `article/#${encodeURIComponent(this.article.slug)}`;\n    const favIconClass = this.article.favorited ? 'ion-heart' : 'ion-ios-heart-outline';\n\n    content.innerHTML = `\n<div class=\"post-meta\">\n<a href=\"${profileURL}\">${profileImage}</a>\n<div class=\"info\">\n    <a href=\"${profileURL}\" class=\"author\">${username}</a>\n    <span class=\"date\">${postDate}</span>\n</div>\n<button class=\"btn btn-outline-primary btn-sm float-right\">\n  <i class=\"${favIconClass}\"></i> ${this.article.favoritesCount}\n</button>\n</div>\n<a href=\"${postURL}\" class=\"preview-link\">\n<h1>${escapeHtml(this.article.title)}</h1>\n<p class=\"post-content\"></p>\n<span>Read more...</span>\n</a>\n`;\n\n    let postContent = '';\n\n    const setContent = (html: string): void => {\n\n      const prev = postContent;\n\n      postContent = html;\n      this._context.updateState('postContent', postContent, prev);\n    };\n\n    articleContent(article)\n        .then(setContent)\n        .catch(error => {\n          console.log(`Failed to display article ${article.slug}`);\n          setContent(`ERROR ${String(error)}`);\n        });\n\n    return () => {\n      content.querySelector('.post-content')!.innerHTML = postContent;\n    };\n  }\n\n}\n","import { SingleContextUpKey, SingleContextUpRef } from 'context-values/updatable';\nimport { ArticleList } from '../../common/articles';\n\nexport type FeedArticleList = ArticleList;\n\nexport const FeedArticleList: SingleContextUpRef<FeedArticleList> = (\n    new SingleContextUpKey<FeedArticleList>(\n        'feed-article-list',\n        {\n          byDefault: () => ({ articles: [], articlesCount: 0 }),\n        },\n    )\n);\n","import { HierarchyContext } from '@wesib/generic';\nimport { BootstrapWindow, Component, ComponentContext, ElementRender, Render } from '@wesib/wesib';\nimport { Conduit__NS } from '../../common';\nimport { ArticlePreviewComponent } from './article-preview.component';\nimport { FeedArticleList } from './feed-article-list';\n\n@Component(\n    ['article-list', Conduit__NS],\n    {\n      feature: {\n        needs: ArticlePreviewComponent,\n      },\n    },\n)\nexport class ArticleListComponent {\n\n  constructor(private readonly _context: ComponentContext) {\n  }\n\n  @Render()\n  render(): ElementRender {\n\n    const document = this._context.get(BootstrapWindow).document;\n    const hierarchy = this._context.get(HierarchyContext);\n    const range = document.createRange();\n\n    range.selectNodeContents(this._context.contentRoot);\n\n    let articles: FeedArticleList;\n\n    hierarchy.get(FeedArticleList)(list => {\n\n      const prev = articles;\n\n      articles = list;\n      this._context.updateState('articles', list, prev);\n    });\n\n    return () => {\n      range.deleteContents();\n      if (!articles.articlesCount) {\n        return;\n      }\n\n      const fragment = document.createDocumentFragment();\n\n      articles.articles.forEach(article => {\n\n        const element: any = fragment.appendChild(document.createElement('conduit-article-preview'));\n\n        element.feedArticle = article;\n      });\n\n      range.insertNode(fragment);\n    };\n  }\n\n}\n","import { HierarchyContext, Navigation } from '@wesib/generic';\nimport { BootstrapWindow, Component, ComponentContext, ElementRender, Render } from '@wesib/wesib';\nimport { nextOnEvent, trackValue } from 'fun-events';\nimport { DomEventDispatcher } from 'fun-events/dom';\nimport {\n  ApiErrorGenerator,\n  ApiResponse,\n  ArticleList,\n  Conduit__NS,\n  FeedRequest,\n  feedRequestsEqual,\n  FeedService,\n  PagerEvent,\n} from '../../common';\nimport { ArticleListComponent } from './article-list.component';\nimport { FeedArticleList } from './feed-article-list';\nimport { PageFeedParam } from './page-feed-param';\n\n@Component(\n    ['feed', Conduit__NS],\n    {\n      feature: {\n        needs: ArticleListComponent,\n      },\n    },\n)\nexport class FeedComponent {\n\n  private readonly _request = trackValue<FeedRequest>({});\n  private _response = trackValue<ApiResponse<ArticleList>>();\n\n  constructor(private readonly _context: ComponentContext) {\n\n    const navigation = _context.get(Navigation);\n    const feedService = _context.get(FeedService);\n\n    this._response.on(\n        (newResponse, oldResponse) => _context.updateState('response', newResponse, oldResponse),\n    );\n    this._context.get(HierarchyContext).provide({\n      a: FeedArticleList,\n      is: this._response.read.keep.thru_(\n          response => response?.ok\n              ? response.body\n              : { articles: [], articlesCount: 0 },\n      ),\n    });\n    _context.whenOn(supply => {\n      navigation.read.tillOff(supply)(page => {\n\n        const request = page.get(PageFeedParam);\n        const prevRequest = this._request.it;\n\n        if (!feedRequestsEqual(request, prevRequest)) {\n          this._request.it = request;\n        }\n      });\n      this._request.read\n          .tillOff(supply)\n          .thru_(\n              request => {\n                this._response.it = undefined;\n                return nextOnEvent(feedService.articles(request));\n              },\n          )(response => this._response.it = response);\n    });\n  }\n\n  @Render()\n  render(): ElementRender {\n\n    const component = this;\n    const { contentRoot }: { contentRoot: Node } = this._context;\n    const navigation = this._context.get(Navigation);\n    const document = this._context.get(BootstrapWindow).document;\n    const errorGen = this._context.get(ApiErrorGenerator);\n    const list = contentRoot.appendChild(document.createElement('conduit-article-list'));\n    const range = document.createRange();\n\n    range.selectNodeContents(contentRoot);\n    range.setStartAfter(list);\n\n    return () => {\n      range.deleteContents();\n\n      const response = this._response.it;\n\n      if (!response) {\n        range.insertNode(displayProgress());\n      } else if (response.ok) {\n        range.insertNode(displayPager(response.body));\n      } else {\n        range.insertNode(displayError(response.errors));\n      }\n    };\n\n    function displayProgress(): Element {\n      return document.createElement('conduit-loader');\n    }\n\n    function displayError(errors: ApiResponse.Errors): Element {\n\n      const errorList = errorGen(errors);\n\n      if (errorList) {\n        return errorList;\n      }\n\n      const loader = document.createElement('conduit-loader');\n\n      loader.setAttribute('load-error', 'Failed to load articles');\n\n      return loader;\n    }\n\n    function displayPager({ articlesCount }: ArticleList): Element {\n\n      const { limit = 20, offset = 0 } = component._request.it;\n      const totalPages = Math.ceil(articlesCount / limit);\n      const currentPage = Math.floor(offset / limit);\n      const pager = document.createElement('conduit-pager');\n\n      pager.setAttribute('total-pages', totalPages.toString(10));\n      pager.setAttribute('current-page', currentPage.toString(10));\n\n      new DomEventDispatcher(pager).on<PagerEvent>('conduit:pager').just(({ detail: page }) => {\n\n        const request = navigation.page.get(PageFeedParam);\n\n        navigation.with(PageFeedParam, { ...request, offset: page * limit }).open();\n      });\n\n      return pager;\n    }\n\n  }\n\n}\n","import { PageHashURLSupport } from '@wesib/generic';\nimport { Component } from '@wesib/wesib';\nimport { Conduit__NS } from '../../common';\nimport { FeedTagsComponent } from './feed-tags.component';\nimport { FeedToggleComponent } from './feed-toggle.component';\nimport { FeedComponent } from './feed.component';\n\n@Component(\n    ['home', Conduit__NS],\n    {\n      feature: {\n        needs: [\n          FeedComponent,\n          FeedTagsComponent,\n          FeedToggleComponent,\n          PageHashURLSupport,\n        ],\n      },\n    },\n)\nexport class HomeComponent {\n}\n","import { conduitContext } from '../../common';\nimport { HomeComponent } from './home.component';\n\nconduitContext.load(HomeComponent);\n"],"names":["PageFeedParam","PageParam","[object Object]","page","input","handle","this","byDefault","put","searchParams","params","pathname","get","PageHashURLParam","feed","undefined","tag","author","favorited","limit","parseInt","offset","value","url","URL","href","feedRequestSearchParams","toString","search","FeedTagsComponent","_context","feedService","FeedService","whenOn","supply","tags","tillOff","_tags","prev","updateState","document","BootstrapWindow","range","createRange","contentRoot","selectNodeContents","setStartAfter","childNodes","length","navigation","Navigation","read","p","deleteContents","fragment","createDocumentFragment","request","forEach","target","with","pretend","a","appendChild","createElement","innerText","insertNode","__decorate","Render","Component","Conduit__NS","HandleNavLinks","FeedToggleComponent","context","authService","AuthService","afterAll","auth","authentication","token","baseURL","baseURI","replace","catch","noop","ActivateNavLink","active","ArticlePreviewComponent","article","content","profileURL","encodeURIComponent","username","profileImage","image","encodeURI","escapeHtml","postDate","Date","createdAt","toDateString","postURL","slug","favIconClass","innerHTML","favoritesCount","title","postContent","setContent","html","articleContent","then","error","console","log","String","querySelector","DomProperty","propertyKey","event","getAttribute","parentNode","FeedArticleList","SingleContextUpKey","articles","articlesCount","ArticleListComponent","hierarchy","HierarchyContext","list","feedArticle","feature","needs","FeedComponent","trackValue","_response","on","newResponse","oldResponse","provide","is","keep","thru_","response","ok","body","prevRequest","_request","it","feedRequestsEqual","nextOnEvent","component","errorGen","ApiErrorGenerator","totalPages","Math","ceil","currentPage","floor","pager","setAttribute","DomEventDispatcher","just","detail","open","displayPager","errors","errorList","loader","displayError","HomeComponent","PageHashURLSupport","conduitContext","load"],"mappings":"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"}