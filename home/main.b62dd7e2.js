import{ab as e,f as t,w as s,t as n,a6 as a}from"../js/lib.e4c19b17.js";import{l as r,R as o,C as i,i as c,h as l,B as h,N as p}from"../js/wesib.026f685a.js";import{C as d,e as u,A as f,h as m,s as g,F as v,f as b,a as _,c as $}from"../js/common.673eb9a1.js";let R=class{constructor(e){this._context=e}render(){if(!this.article)return;const e=this._context.contentRoot,{author:t}=this.article,s=`profile/#${encodeURIComponent(t.username)}`,n=t.image?`<img src="${encodeURI(t.image)}"/>`:"",a=u(t.username),r=new Date(this.article.createdAt).toDateString(),o=`article/#${encodeURIComponent(this.article.slug)}`;e.innerHTML=`\n<div class="post-meta">\n<a href="${s}">${n}</a>\n<div class="info">\n    <a href="${s}" class="author">${a}</a>\n    <span class="date">${r}</span>\n</div>\n<button class="btn btn-outline-primary btn-sm float-right">\n  <i class="ion-heart"></i> 32\n</button>\n</div>\n<a href="${o}" class="preview-link">\n<h1>${u(this.article.title)}</h1>\n<p>${this.article.body}</p>\n<span>Read more...</span>\n</a>\n`}};e([r({propertyKey:"feedArticle"})],R.prototype,"article",void 0),e([o()],R.prototype,"render",null),R=e([i(["article-preview",d],c({href(e){let t=e.target;for(;;){const e=t.getAttribute("href");if(null!=e)return e;const{parentNode:s}=t;if(!s)return;t=s}}}))],R);let w=class{constructor(e){const{document:n}=e.get(h),a=e.get(p),r=e.get(f);e.whenOn(e=>{t({user:r.user,page:a}).tillOff(e)(({user:[e],page:[{url:t}]})=>{const r=new URL(n.baseURI);if(t.pathname!==r.pathname)return;const o=m(t),i=o.pathname.substring(1);i&&("personal"===i&&e||(o.pathname="",a.replace(g(t,o)).catch(s)))})})}};w=e([i(["feed-toggle",d],l({active:"active"}),c())],w);let x=class{constructor(e){this._context=e,this._request=n([!1,{}]);const t=e.get(p),s=e.get(v);e.whenOn(e=>{t.read.tillOff(e)(({url:e})=>{const{pathname:t,searchParams:s}=m(e),n="/personal"===t,a={tag:s.get("tag")||void 0,author:s.get("author")||void 0,favorited:s.get("favorited")||void 0,limit:parseInt(s.get("limit")||"",10)||void 0,offset:parseInt(s.get("offset")||"",10)||void 0},[r,o]=this._request.it;r===n&&b(a,o)||(this._request.it=[n,a])}),this._request.read.tillOff(e).thru_(([e,t])=>(this.response=void 0,a(e?s.feed(t):s.articles(t))))(e=>this.response=e)})}get response(){return this._response}set response(e){const t=this._response;this._response=e,this._context.updateState("posts",e,t)}render(){const e=this._context.get(h).document,t=this._context.get(_),s=e.createRange();return s.selectNodeContents(this._context.contentRoot),()=>{const n=this.response;s.deleteContents(),n&&(n.ok?function(t){const n=e.createDocumentFragment();t.articles.forEach(t=>{n.appendChild(e.createElement("conduit-article-preview")).feedArticle=t}),s.insertNode(n)}(n.body):function(n){const a=t(n);a?s.insertNode(a):s.insertNode(e.createTextNode("Failed to load articles"))}(n.errors))}}};e([o()],x.prototype,"render",null),x=e([i(["feed",d])],x);let y=class{};y=e([i(["home",d],{feature:{needs:[R,x,w]}})],y),$.load(y);//# sourceMappingURL=main.b62dd7e2.js.map
