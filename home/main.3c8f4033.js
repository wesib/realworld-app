import{d as e}from"../js/proc7ts/call-thru.7c911e58.js";import{g as t}from"../js/proc7ts/fun-events.52c596e5.js";import{S as s,R as r,C as o,B as n}from"../js/wesib/wesib.1dc70a8b.js";import{_ as a}from"../js/helpers.e1623395.js";import{b as c}from"../js/core/auth.696804aa.js";import{e as i,N as d,A as l,g as h}from"../js/wesib/generic.14416616.js";import{C as p}from"../js/core.c852ba8c.js";import{L as f}from"../js/core/loader.a09233bb.js";import"../js/core/input.4b28550f.js";import{P as m,R as u}from"../js/render-feed.decorator.869535a8.js";import{c as g}from"../js/core/main.377b5203.js";import{a as j,F as b}from"../js/core/feed.817da43a.js";let C=(()=>{let e=class{constructor(e){this._context=e,this.tags=[];const t=this._context.get(j),s=this._context.get(d);e.whenConnected(()=>{s.read().tillOff(e).to(e=>this.page=e),t.tags().tillOff(e).to((...e)=>this.tags=e)})}render(){const{document:e}=this._context.get(n),t=e.createRange(),{contentRoot:s}=this._context;return t.selectNodeContents(s),t.setStartAfter(s.childNodes[s.childNodes.length-1]),()=>{if(t.deleteContents(),!this.page)return;const s=this._context.get(d),r=e.createDocumentFragment(),o=this.page.get(m);this.tags.forEach(t=>{const n=s.with(m,Object.assign(Object.assign({},o),{tag:t,feed:void 0,offset:0})).pretend();if(n){const s=r.appendChild(e.createElement("a"));s.href=n.url.href,s.innerText=t}}),t.insertNode(r)}}};return a([s()],e.prototype,"tags",void 0),a([s()],e.prototype,"page",void 0),a([r()],e.prototype,"render",null),e=a([o(["feed-tags",p],i())],e),e})(),x=(()=>{let h=class{constructor(s){this._context=s,this.request={};const{document:r}=s.get(n),o=s.get(d),a=s.get(c);s.whenConnected(()=>{t({auth:a.authentication(),page:o}).tillOff(s).to(({auth:[{token:t}],page:[s]})=>{const{url:n}=s,a=new URL(r.baseURI);if(n.pathname!==a.pathname)return;const c=this.request=s.get(m),{feed:i}=c;"/personal-feed"===i&&(t||o.with(m,{}).replace().catch(e))})})}render(){const e=this._context.get(d),{document:t}=this._context.get(n),{element:s}=this._context,r=s.querySelector("ul"),o=t.createRange();return o.setStartAfter(r.appendChild(t.createComment("[TAG["))),o.setEndBefore(r.appendChild(t.createComment("]TAG]"))),()=>{o.deleteContents();const{tag:s}=this.request;if(!s)return;const r=e.with(m,{tag:s}).pretend();if(!r)return;const n=t.createElement("li");n.className="nav-item";const a=n.appendChild(t.createElement("a"));a.className="nav-link",a.innerText="#"+s,a.setAttribute("href",r.url.hash),o.insertNode(n)}}};return a([s()],h.prototype,"request",void 0),a([r()],h.prototype,"render",null),h=a([o(["feed-toggle",p],l({active:"active"}),i())],h),h})(),_=(()=>{let e=class{constructor(e){this.request={};const t=e.get(d);e.whenConnected(()=>{t.read().tillOff(e).to(e=>{this.request=e.get(m)})})}};return a([u()],e.prototype,"request",void 0),e=a([o(["feed",p])],e),e})(),v=(()=>{let e=class{};return e=a([o(["home",p],{feature:{needs:[b,_,C,x,f,h]}})],e),e})();g.load(v);//# sourceMappingURL=main.3c8f4033.js.map
