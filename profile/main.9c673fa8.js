import"../js/proc7ts/primitives.3596c309.js";import"../js/proc7ts/push-iterator.b943ed6f.js";import"../js/proc7ts/context-values.91624d4c.js";import"../js/frontmeans/namespace-aliaser.e08188c9.js";import{f as e,s,t,m as r,a as o,F as a,i}from"../js/proc7ts/fun-events.26e814e4.js";import"../js/proc7ts/workbench.47577449.js";import"../js/frontmeans/dom-events.272f64a1.js";import"../js/frontmeans/render-scheduler.78bb570f.js";import{C as n,S as p,R as c,B as m}from"../js/wesib/wesib.a2d60763.js";import{_ as d}from"../js/helpers.e1623395.js";import"../js/core/auth.81df9cb2.js";import{n as f}from"../js/core/api.a7ea7d29.js";import"../js/hatsy/http-header-value.0845e903.js";import{d as j,A as l,g as u,N as h,b,a as g}from"../js/wesib/generic.fb9d31ab.js";import"../js/proc7ts/delta-set.d5d9e832.js";import"../js/frontmeans/input-aspects.ed13f267.js";import{C as v}from"../js/core.c152f8fe.js";import{a as y}from"../js/core/loader.d22f956e.js";import"../js/core/layout.b9fbd9a2.js";import{c as w}from"../js/core/main.9ff13c21.js";import"../js/core/articles.34a938a1.js";import"../js/lib/dompurify.f5eadf9f.js";import"../js/lib/marked.5b76e7a8.js";import{n as k,C as _,F as C,c as x}from"../js/follow-author-btn.component.cb6bc7a7.js";import"../js/frontmeans/httongue.193345e9.js";import{U as q,a as B}from"../js/core/users.a3a98d5f.js";import"../js/proc7ts/call-thru.f4f68410.js";import"../js/core/feed.298d7830.js";import{P as E}from"../js/article-buttons-support.feature.c86529d0.js";import"../js/current-article.c9b2c40d.js";import{R as I}from"../js/render-feed.decorator.80bdd83d.js";import"../js/core/util.b814d7d9.js";const P=/#\/.+\/favorite$/;let A=class{constructor(t){const r=t.get(h);t.whenConnected((()=>{e({page:r,links:t.get(b).select("a",{all:!0,deep:!0})}).do(s(t))((({page:[e],links:[s]})=>{for(const t of s){const s=t.element,o=e.get(E),a=o.author||o.favorited;let i;i=P.test(s.href)?{favorited:a}:{author:a};const n=r.with(E,i).pretend();if(n){const e=n.url.href;if(s.href!==e){const t=s.cloneNode(!0);t.href=e,s.replaceWith(t)}}}}))}))}};A=d([n(["user-feed-toggle",v],{feature:{needs:u}},l({active:"active"}),j())],A);let F=class{constructor(e){this.request={};const t=e.get(h);e.whenConnected((()=>{t.read.do(s(e))((e=>{this.request=e.get(E)}))}))}};d([I({requestParam:E})],F.prototype,"request",void 0),F=d([n(["user-feed",v])],F);let N=class{constructor(e){this._context=e,this.profile=k;e.get(g).get(_)((e=>this.profile=e))}render(){const{document:e}=this._context.get(m);return()=>{var s;const{profile:t}=this;null===(s=e.getElementById("user:image"))||void 0===s||s.setAttribute("src",t.username&&t.image||"");const r=e.getElementById("user:username");r&&(r.innerText=t.username||"");const o=e.getElementById("user:bio");o&&(o.innerText=t.username&&t.bio||"")}}};d([p()],N.prototype,"profile",void 0),d([c()],N.prototype,"render",null),N=d([n(["user-info",v],{feature:{needs:C}})],N);let R=class{constructor(e){this._response=t();const s=e.get(q),n=e.get(h),p=e.get(g),c=x(this._response.read.do(r((e=>e&&e.ok?e.body:k))));p.provide({a:_,is:c}),e.whenConnected((()=>{n.read.do(o((e=>{const s=e.get(E);return s.author||s.favorited})),a(e),i((e=>{if(e){if(!this.response||!this.response.ok||this.response.body.username!==e)return s.userProfile(e)((e=>this.response=e))}else this.response={ok:!1,errors:f()}})))}))}get response(){return this._response.it}set response(e){this._response.it=e}};d([y()],R.prototype,"response",null),R=d([n(["profile",v],{feature:{needs:[F,A,N,B]}})],R),w.load(R);//# sourceMappingURL=main.9c673fa8.js.map
