{"version":3,"file":"main.a6c936a5.js","sources":["../../src/pages/article/follow-author.component.ts","../../src/pages/article/article.component.ts","../../src/pages/article/index.ts"],"sourcesContent":["import { HierarchyContext } from '@wesib/generic';\nimport { Component, ComponentContext, ElementRender, Render, StateProperty } from '@wesib/wesib';\nimport { Conduit__NS } from '../../common';\nimport { UserProfile } from '../../common/users';\nimport { escapeHtml } from '../../common/util';\nimport { CurrentArticle } from './current-article';\n\n@Component(['follow-author', Conduit__NS])\nexport class FollowAuthorComponent {\n\n  @StateProperty()\n  private author?: UserProfile;\n\n  constructor(private readonly _context: ComponentContext) {\n\n    const hierarchy = _context.get(HierarchyContext);\n\n    _context.whenOn(supply => {\n      hierarchy.get(CurrentArticle).tillOff(supply)(article => {\n        this.author = article.slug ? article.author : undefined;\n      });\n    });\n  }\n\n  @Render()\n  render(): ElementRender {\n\n    const { contentRoot }: { contentRoot: Element } = this._context;\n\n    return () => {\n      if (this.author) {\n        contentRoot.className = this.author.following ? 'btn-outline-primary' : 'btn-outline-secondary';\n        contentRoot.innerHTML = `<i class=\"ion-plus-round\"></i> Follow ${escapeHtml(this.author.username)}`;\n      } else {\n        contentRoot.innerHTML = '';\n      }\n\n    };\n  }\n\n}\n","import { HierarchyContext, Navigation, PageHashURLParam } from '@wesib/generic';\nimport { Component, ComponentContext, StateProperty } from '@wesib/wesib';\nimport { Conduit__NS } from '../../common';\nimport { ApiResponse } from '../../common/api';\nimport { Article, ArticleService, FeedSupport } from '../../common/articles';\nimport { LoaderComponent } from '../../generic/loader';\nimport { ArticleMetaSupport } from './article-meta-support.feature';\nimport { CurrentArticle } from './current-article';\nimport { FollowAuthorComponent } from './follow-author.component';\n\n@Component(\n    ['article', Conduit__NS],\n    {\n      feature: {\n        needs: [\n          ArticleMetaSupport,\n          FeedSupport,\n          FollowAuthorComponent,\n          LoaderComponent,\n        ],\n      },\n    },\n)\nexport class ArticleComponent {\n\n  private _response?: ApiResponse<Article>;\n\n  constructor(private readonly _context: ComponentContext) {\n\n    const articleService = _context.get(ArticleService);\n    const navigation = _context.get(Navigation);\n\n    _context.whenOn(supply => {\n      navigation.read.tillOff(supply).consume(page => {\n\n        const slug = page.get(PageHashURLParam).pathname.substring(0);\n\n        return articleService.article(slug)(response => this.response = response);\n      });\n    });\n  }\n\n  get response(): ApiResponse<Article> | undefined {\n    return this._response;\n  }\n\n  @StateProperty()\n  set response(value: ApiResponse<Article> | undefined) {\n    this._response = value;\n    this._context.get(HierarchyContext).provide({ a: CurrentArticle, is: value && value.ok ? value.body : {} });\n  }\n\n}\n","import { conduitContext } from '../../common/main';\nimport { ArticleComponent } from './article.component';\n\nconduitContext.load(ArticleComponent);\n"],"names":["FollowAuthorComponent","[object Object]","_context","this","hierarchy","get","HierarchyContext","whenOn","supply","CurrentArticle","tillOff","article","author","slug","undefined","contentRoot","className","following","innerHTML","escapeHtml","username","__decorate","StateProperty","Render","Component","Conduit__NS","ArticleComponent","articleService","ArticleService","navigation","Navigation","read","consume","page","PageHashURLParam","pathname","substring","response","_response","value","provide","a","is","ok","body","feature","needs","ArticleMetaSupport","FeedSupport","LoaderComponent","conduitContext","load"],"mappings":"6fAQA,IAAaA,EAAb,MAKEC,YAA6BC,GAAAC,cAAAD,EAE3B,MAAME,EAAYF,EAASG,IAAIC,GAE/BJ,EAASK,OAAOC,IACdJ,EAAUC,IAAII,GAAgBC,QAAQF,EAAtCJ,CAA8CO,IAC5CR,KAAKS,OAASD,EAAQE,KAAOF,EAAQC,YAASE,MAMpDb,SAEE,MAAMc,YAAEA,GAA0CZ,KAAKD,SAEvD,MAAO,KACDC,KAAKS,QACPG,EAAYC,UAAYb,KAAKS,OAAOK,UAAY,sBAAwB,wBACxEF,EAAYG,UAAY,yCAAyCC,EAAWhB,KAAKS,OAAOQ,aAExFL,EAAYG,UAAY,MAvB9BG,GADCC,kCAeDD,GADCE,gCAhBUvB,KADZwB,EAAU,CAAC,gBAAiBC,KAChBzB,GCeb,IAAa0B,EAAb,MAIEzB,YAA6BC,GAAAC,cAAAD,EAE3B,MAAMyB,EAAiBzB,EAASG,IAAIuB,GAC9BC,EAAa3B,EAASG,IAAIyB,GAEhC5B,EAASK,OAAOC,IACdqB,EAAWE,KAAKrB,QAAQF,GAAQwB,QAAQC,IAEtC,MAAMpB,EAAOoB,EAAK5B,IAAI6B,GAAkBC,SAASC,UAAU,GAE3D,OAAOT,EAAehB,QAAQE,EAAvBc,CAA6BU,GAAYlC,KAAKkC,SAAWA,OAKtEA,eACE,OAAOlC,KAAKmC,UAIdD,aAAaE,GACXpC,KAAKmC,UAAYC,EACjBpC,KAAKD,SAASG,IAAIC,GAAkBkC,QAAQ,CAAEC,EAAGhC,EAAgBiC,GAAIH,GAASA,EAAMI,GAAKJ,EAAMK,KAAO,OAFxGvB,GADCC,kCAvBUI,KAbZF,EACG,CAAC,UAAWC,GACZ,CACEoB,QAAS,CACPC,MAAO,CACLC,EACAC,EACAhD,EACAiD,OAKGvB,GCpBbwB,EAAeC,KAAKzB"}